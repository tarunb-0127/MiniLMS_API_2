Ÿ
HD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\WeatherForecast.cs
	namespace 	
Mini_LMS
 
{ 
public 

class 
WeatherForecast  
{ 
public 
DateOnly 
Date 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
TemperatureC 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
int		 
TemperatureF		 
=>		  "
$num		# %
+		& '
(		( )
int		) ,
)		, -
(		- .
TemperatureC		. :
/		; <
$num		= C
)		C D
;		D E
public 
string 
? 
Summary 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
} ¯É
ND:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Services\EmailService.cs
	namespace 	
Mini_LMS
 
. 
Services 
{		 
public

 

class

 
EmailService

 
{ 
private 
readonly 
IConfiguration '
_config( /
;/ 0
private 
readonly 
ILogger  
<  !
EmailService! -
>- .
_logger/ 6
;6 7
public 
EmailService 
( 
IConfiguration *
config+ 1
,1 2
ILogger3 :
<: ;
EmailService; G
>G H
loggerI O
)O P
{ 	
_config 
= 
config 
; 
_logger 
= 
logger 
; 
} 	
private 

SmtpClient 
CreateSmtpClient +
(+ ,
), -
{ 	
var 
username 
= 
_config "
[" #
$str# 3
]3 4
;4 5
var 
password 
= 
_config "
[" #
$str# 3
]3 4
;4 5
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
username* 2
)2 3
||4 6
string7 =
.= >
IsNullOrWhiteSpace> P
(P Q
passwordQ Y
)Y Z
)Z [
{ 
_logger 
. 
LogError  
(  !
$str! I
)I J
;J K
throw 
new %
InvalidOperationException 3
(3 4
$str4 V
)V W
;W X
} 
return   
new   

SmtpClient   !
(  ! "
$str  " 2
)  2 3
{!! 
Port"" 
="" 
$num"" 
,"" 
Credentials## 
=## 
new## !
NetworkCredential##" 3
(##3 4
username##4 <
,##< =
password##> F
)##F G
,##G H
	EnableSsl$$ 
=$$ 
true$$  
,$$  !
Timeout%% 
=%% 
$num%% 
}&& 
;&& 
}'' 	
private)) 
MailMessage)) 
CreateMessage)) )
())) *
string))* 0
toEmail))1 8
,))8 9
string)): @
subject))A H
,))H I
string))J P
body))Q U
)))U V
{** 	
var++ 
	fromEmail++ 
=++ 
_config++ #
[++# $
$str++$ 4
]++4 5
;++5 6
if-- 
(-- 
string-- 
.-- 
IsNullOrWhiteSpace-- )
(--) *
toEmail--* 1
)--1 2
)--2 3
{.. 
throw// 
new// 
ArgumentException// +
(//+ ,
$str//, J
)//J K
;//K L
}00 
var22 
message22 
=22 
new22 
MailMessage22 )
{33 
From44 
=44 
new44 
MailAddress44 &
(44& '
	fromEmail44' 0
,440 1
$str442 I
)44I J
,44J K
Subject55 
=55 
subject55 !
,55! "
Body66 
=66 
body66 
,66 

IsBodyHtml77 
=77 
false77 "
}88 
;88 
message:: 
.:: 
To:: 
.:: 
Add:: 
(:: 
toEmail:: "
)::" #
;::# $
return;; 
message;; 
;;; 
}<< 	
public>> 
async>> 
Task>> 
<>> 
bool>> 
>>> 
SendOtpEmailAsync>>  1
(>>1 2
string>>2 8
toEmail>>9 @
,>>@ A
string>>B H
otp>>I L
)>>L M
{?? 	
try@@ 
{AA 
varBB 
clientBB 
=BB 
CreateSmtpClientBB -
(BB- .
)BB. /
;BB/ 0
varCC 
messageCC 
=CC 
CreateMessageCC +
(CC+ ,
toEmailDD 
,DD 
$strEE )
,EE) *
$"FF 
$strFF #
{FF# $
otpFF$ '
}FF' (
$strFF( B
"FFB C
)GG 
;GG 
_loggerII 
.II 
LogInformationII &
(II& '
$strII' E
,IIE F
toEmailIIG N
)IIN O
;IIO P
awaitJJ 
clientJJ 
.JJ 
SendMailAsyncJJ *
(JJ* +
messageJJ+ 2
)JJ2 3
;JJ3 4
_loggerKK 
.KK 
LogInformationKK &
(KK& '
$strKK' B
,KKB C
toEmailKKD K
)KKK L
;KKL M
returnLL 
trueLL 
;LL 
}MM 
catchNN 
(NN 
	ExceptionNN 
exNN 
)NN  
{OO 
_loggerPP 
.PP 
LogErrorPP  
(PP  !
exPP! #
,PP# $
$strPP% J
,PPJ K
toEmailPPL S
)PPS T
;PPT U
returnQQ 
falseQQ 
;QQ 
}RR 
}SS 	
publicUU 
asyncUU 
TaskUU 
<UU 
boolUU 
>UU '
SendPasswordResetEmailAsyncUU  ;
(UU; <
stringUU< B
toEmailUUC J
,UUJ K
stringUUL R
	resetLinkUUS \
)UU\ ]
{VV 	
tryWW 
{XX 
varYY 
clientYY 
=YY 
CreateSmtpClientYY -
(YY- .
)YY. /
;YY/ 0
varZZ 
messageZZ 
=ZZ 
CreateMessageZZ +
(ZZ+ ,
toEmail[[ 
,[[ 
$str\\ /
,\\/ 0
$"]] 
$str]] N
{]]N O
	resetLink]]O X
}]]X Y
$str	]]Y Å
"
]]Å Ç
)^^ 
;^^ 
_logger`` 
.`` 
LogInformation`` &
(``& '
$str``' P
,``P Q
toEmail``R Y
)``Y Z
;``Z [
awaitaa 
clientaa 
.aa 
SendMailAsyncaa *
(aa* +
messageaa+ 2
)aa2 3
;aa3 4
_loggerbb 
.bb 
LogInformationbb &
(bb& '
$strbb' M
,bbM N
toEmailbbO V
)bbV W
;bbW X
returncc 
truecc 
;cc 
}dd 
catchee 
(ee 
	Exceptionee 
exee 
)ee  
{ff 
_loggergg 
.gg 
LogErrorgg  
(gg  !
exgg! #
,gg# $
$strgg% U
,ggU V
toEmailggW ^
)gg^ _
;gg_ `
returnhh 
falsehh 
;hh 
}ii 
}jj 	
publicmm 
asyncmm 
Taskmm 
<mm 
boolmm 
>mm (
SendCourseApprovalEmailAsyncmm  <
(mm< =
stringmm= C
trainerEmailmmD P
,mmP Q
stringmmR X

courseNamemmY c
)mmc d
{nn 	
tryoo 
{pp 
varqq 
clientqq 
=qq 
CreateSmtpClientqq -
(qq- .
)qq. /
;qq/ 0
varrr 
messagerr 
=rr 
CreateMessagerr +
(rr+ ,
trainerEmailss  
,ss  !
$strtt %
,tt% &
$"uu 
$struu #
{uu# $

courseNameuu$ .
}uu. /
$struu/ ]
"uu] ^
)vv 
;vv 
_loggerxx 
.xx 
LogInformationxx &
(xx& '
$strxx' Q
,xxQ R
trainerEmailxxS _
)xx_ `
;xx` a
awaityy 
clientyy 
.yy 
SendMailAsyncyy *
(yy* +
messageyy+ 2
)yy2 3
;yy3 4
_loggerzz 
.zz 
LogInformationzz &
(zz& '
$strzz' N
,zzN O
trainerEmailzzP \
)zz\ ]
;zz] ^
return{{ 
true{{ 
;{{ 
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
_logger 
. 
LogError  
(  !
ex! #
,# $
$str% V
,V W
trainerEmailX d
)d e
;e f
return
ÄÄ 
false
ÄÄ 
;
ÄÄ 
}
ÅÅ 
}
ÇÇ 	
public
ÑÑ 
async
ÑÑ 
Task
ÑÑ 
<
ÑÑ 
bool
ÑÑ 
>
ÑÑ (
SendCourseUpdateEmailAsync
ÑÑ  :
(
ÑÑ: ;
string
ÑÑ; A
trainerEmail
ÑÑB N
,
ÑÑN O
string
ÑÑP V

courseName
ÑÑW a
)
ÑÑa b
{
ÖÖ 	
try
ÜÜ 
{
áá 
var
àà 
client
àà 
=
àà 
CreateSmtpClient
àà -
(
àà- .
)
àà. /
;
àà/ 0
var
ââ 
message
ââ 
=
ââ 
CreateMessage
ââ +
(
ââ+ ,
trainerEmail
ää  
,
ää  !
$str
ãã $
,
ãã$ %
$"
åå 
$str
åå #
{
åå# $

courseName
åå$ .
}
åå. /
$str
åå/ O
"
ååO P
)
çç 
;
çç 
_logger
èè 
.
èè 
LogInformation
èè &
(
èè& '
$str
èè' O
,
èèO P
trainerEmail
èèQ ]
)
èè] ^
;
èè^ _
await
êê 
client
êê 
.
êê 
SendMailAsync
êê *
(
êê* +
message
êê+ 2
)
êê2 3
;
êê3 4
_logger
ëë 
.
ëë 
LogInformation
ëë &
(
ëë& '
$str
ëë' L
,
ëëL M
trainerEmail
ëëN Z
)
ëëZ [
;
ëë[ \
return
íí 
true
íí 
;
íí 
}
ìì 
catch
îî 
(
îî 
	Exception
îî 
ex
îî 
)
îî  
{
ïï 
_logger
ññ 
.
ññ 
LogError
ññ  
(
ññ  !
ex
ññ! #
,
ññ# $
$str
ññ% S
,
ññS T
trainerEmail
ññU a
)
ñña b
;
ññb c
return
óó 
false
óó 
;
óó 
}
òò 
}
ôô 	
public
õõ 
async
õõ 
Task
õõ 
<
õõ 
bool
õõ 
>
õõ +
SendTakedownRequestEmailAsync
õõ  =
(
õõ= >
string
õõ> D

adminEmail
õõE O
,
õõO P
string
õõQ W

courseName
õõX b
,
õõb c
string
õõd j
trainerEmail
õõk w
)
õõw x
{
úú 	
try
ùù 
{
ûû 
var
üü 
client
üü 
=
üü 
CreateSmtpClient
üü -
(
üü- .
)
üü. /
;
üü/ 0
var
†† 
message
†† 
=
†† 
CreateMessage
†† +
(
††+ ,

adminEmail
°° 
,
°° 
$str
¢¢ -
,
¢¢- .
$"
££ 
$str
££ 
{
££  
trainerEmail
££  ,
}
££, -
$str
££- S
{
££S T

courseName
££T ^
}
££^ _
$str
££_ a
"
££a b
)
§§ 
;
§§ 
_logger
¶¶ 
.
¶¶ 
LogInformation
¶¶ &
(
¶¶& '
$str
¶¶' X
,
¶¶X Y

adminEmail
¶¶Z d
)
¶¶d e
;
¶¶e f
await
ßß 
client
ßß 
.
ßß 
SendMailAsync
ßß *
(
ßß* +
message
ßß+ 2
)
ßß2 3
;
ßß3 4
_logger
®® 
.
®® 
LogInformation
®® &
(
®®& '
$str
®®' U
,
®®U V

adminEmail
®®W a
)
®®a b
;
®®b c
return
©© 
true
©© 
;
©© 
}
™™ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
¨¨ 
_logger
≠≠ 
.
≠≠ 
LogError
≠≠  
(
≠≠  !
ex
≠≠! #
,
≠≠# $
$str
≠≠% ]
,
≠≠] ^

adminEmail
≠≠_ i
)
≠≠i j
;
≠≠j k
return
ÆÆ 
false
ÆÆ 
;
ÆÆ 
}
ØØ 
}
∞∞ 	
public
≤≤ 
async
≤≤ 
Task
≤≤ 
<
≤≤ 
bool
≤≤ 
>
≤≤ 0
"SendFeedbackNotificationEmailAsync
≤≤  B
(
≤≤B C
string
≤≤C I
trainerEmail
≤≤J V
,
≤≤V W
string
≤≤X ^
learnerName
≤≤_ j
,
≤≤j k
string
≤≤l r

courseName
≤≤s }
)
≤≤} ~
{
≥≥ 	
try
¥¥ 
{
µµ 
var
∂∂ 
client
∂∂ 
=
∂∂ 
CreateSmtpClient
∂∂ -
(
∂∂- .
)
∂∂. /
;
∂∂/ 0
var
∑∑ 
message
∑∑ 
=
∑∑ 
CreateMessage
∑∑ +
(
∑∑+ ,
trainerEmail
∏∏  
,
∏∏  !
$str
ππ .
,
ππ. /
$"
∫∫ 
$str
∫∫ 
{
∫∫  
learnerName
∫∫  +
}
∫∫+ ,
$str
∫∫, V
{
∫∫V W

courseName
∫∫W a
}
∫∫a b
$str
∫∫b d
"
∫∫d e
)
ªª 
;
ªª 
_logger
ΩΩ 
.
ΩΩ 
LogInformation
ΩΩ &
(
ΩΩ& '
$str
ΩΩ' W
,
ΩΩW X
trainerEmail
ΩΩY e
)
ΩΩe f
;
ΩΩf g
await
ææ 
client
ææ 
.
ææ 
SendMailAsync
ææ *
(
ææ* +
message
ææ+ 2
)
ææ2 3
;
ææ3 4
_logger
øø 
.
øø 
LogInformation
øø &
(
øø& '
$str
øø' T
,
øøT U
trainerEmail
øøV b
)
øøb c
;
øøc d
return
¿¿ 
true
¿¿ 
;
¿¿ 
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
√√ 
_logger
ƒƒ 
.
ƒƒ 
LogError
ƒƒ  
(
ƒƒ  !
ex
ƒƒ! #
,
ƒƒ# $
$str
ƒƒ% V
,
ƒƒV W
trainerEmail
ƒƒX d
)
ƒƒd e
;
ƒƒe f
return
≈≈ 
false
≈≈ 
;
≈≈ 
}
∆∆ 
}
«« 	
public
…… 
async
…… 
Task
…… 
<
…… 
bool
…… 
>
…… .
 SendNewCourseAvailableEmailAsync
……  @
(
……@ A
string
……A G
learnerEmail
……H T
,
……T U
string
……V \

courseName
……] g
)
……g h
{
   	
try
ÀÀ 
{
ÃÃ 
var
ÕÕ 
client
ÕÕ 
=
ÕÕ 
CreateSmtpClient
ÕÕ -
(
ÕÕ- .
)
ÕÕ. /
;
ÕÕ/ 0
var
ŒŒ 
message
ŒŒ 
=
ŒŒ 
CreateMessage
ŒŒ +
(
ŒŒ+ ,
learnerEmail
œœ  
,
œœ  !
$str
–– *
,
––* +
$"
—— 
$str
—— .
{
——. /

courseName
——/ 9
}
——9 :
$str
——: j
"
——j k
)
““ 
;
““ 
_logger
‘‘ 
.
‘‘ 
LogInformation
‘‘ &
(
‘‘& '
$str
‘‘' L
,
‘‘L M
learnerEmail
‘‘N Z
)
‘‘Z [
;
‘‘[ \
await
’’ 
client
’’ 
.
’’ 
SendMailAsync
’’ *
(
’’* +
message
’’+ 2
)
’’2 3
;
’’3 4
_logger
÷÷ 
.
÷÷ 
LogInformation
÷÷ &
(
÷÷& '
$str
÷÷' I
,
÷÷I J
learnerEmail
÷÷K W
)
÷÷W X
;
÷÷X Y
return
◊◊ 
true
◊◊ 
;
◊◊ 
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
⁄⁄ 
_logger
€€ 
.
€€ 
LogError
€€  
(
€€  !
ex
€€! #
,
€€# $
$str
€€% Q
,
€€Q R
learnerEmail
€€S _
)
€€_ `
;
€€` a
return
‹‹ 
false
‹‹ 
;
‹‹ 
}
›› 
}
ﬁﬁ 	
}
‡‡ 
}·· ó 
MD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Services\BlobService.cs
public 
class 
BlobService 
{ 
private 
readonly 
BlobContainerClient (
_containerClient) 9
;9 :
public 

BlobService 
( 
IConfiguration %
config& ,
), -
{		 
var $
connectionStringTemplate $
=% &
config' -
[- .
$str. M
]M N
;N O
var 
key 
= 
config 
[ 
$str 2
]2 3
;3 4
var 
connectionString 
= $
connectionStringTemplate 7
.7 8
Replace8 ?
(? @
$str@ S
,S T
keyU X
)X Y
;Y Z
var 
containerName 
= 
config "
[" #
$str# ?
]? @
;@ A
_containerClient 
= 
new 
BlobContainerClient 2
(2 3
connectionString3 C
,C D
containerNameE R
)R S
;S T
_containerClient 
. 
CreateIfNotExists *
(* +
)+ ,
;, -
_containerClient 
. 
SetAccessPolicy (
(( )
PublicAccessType) 9
.9 :
Blob: >
)> ?
;? @
} 
public 

async 
Task 
< 
string 
> 
UploadAsync )
() *
	IFormFile* 3
file4 8
)8 9
{ 
var 
safeFileName 
= 
Path 
.  '
GetFileNameWithoutExtension  ;
(; <
file< @
.@ A
FileNameA I
)I J
. 
Replace 
( 
$str 
, 
$str 
) 
. 
Replace 
( 
$str 
, 
$str 
) 
.   
Replace   
(   
$str   
,   
$str   
)   
.!! 
Replace!! 
(!! 
$str!! 
,!! 
$str!! 
)!! 
+"" 
Path"" 
."" 
GetExtension"" 
(""  
file""  $
.""$ %
FileName""% -
)""- .
;"". /
var$$ 
blobName$$ 
=$$ 
Guid$$ 
.$$ 
NewGuid$$ #
($$# $
)$$$ %
.$$% &
ToString$$& .
($$. /
)$$/ 0
+$$1 2
$str$$3 6
+$$7 8
safeFileName$$9 E
;$$E F
var%% 

blobClient%% 
=%% 
_containerClient%% )
.%%) *
GetBlobClient%%* 7
(%%7 8
blobName%%8 @
)%%@ A
;%%A B
var'' 
headers'' 
='' 
new'' 
BlobHttpHeaders'' )
{(( 	
ContentType)) 
=)) 
file)) 
.)) 
ContentType)) *
}** 	
;**	 

using,, 
(,, 
var,, 
stream,, 
=,, 
file,,  
.,,  !
OpenReadStream,,! /
(,,/ 0
),,0 1
),,1 2
{-- 	
await.. 

blobClient.. 
... 
UploadAsync.. (
(..( )
stream..) /
,../ 0
new..1 4
BlobUploadOptions..5 F
{// 
HttpHeaders00 
=00 
headers00 %
}11 
)11 
;11 
}22 	
return44 

blobClient44 
.44 
Uri44 
.44 
ToString44 &
(44& '
)44' (
;44( )
}55 
}66 óX
@D:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
	AddScoped 
< 
	JwtHelper $
>$ %
(% &
)& '
;' (
builder 
. 
Services 
. 
	AddScoped 
< 
EmailService '
>' (
(( )
)) *
;* +
builder 
. 
Services 
. 
	AddScoped 
< 
BlobService &
>& '
(' (
)( )
;) *
builder 
. 
Services 
. 
AddDbContext 
< 
MiniLMSContext ,
>, -
(- .
opts. 2
=>3 5
opts 
. 	
UseMySql	 
( 
builder 
. 
Configuration 
. 
GetConnectionString 1
(1 2
$str2 ;
); <
,< =
ServerVersion 
. 

AutoDetect  
(  !
builder! (
.( )
Configuration) 6
.6 7
GetConnectionString7 J
(J K
$strK T
)T U
)U V
) 
) 
; 
builder 
. 
Services 
. 
AddControllers 
(  
)  !
. 
AddJsonOptions 
( 
opts 
=> 
{ 
opts 
. !
JsonSerializerOptions "
." #
ReferenceHandler# 3
=4 5
System   
.   
Text   
.   
Json   
.   
Serialization   *
.  * +
ReferenceHandler  + ;
.  ; <
IgnoreCycles  < H
;  H I
opts!! 
.!! !
JsonSerializerOptions!! "
.!!" #
WriteIndented!!# 0
=!!1 2
true!!3 7
;!!7 8
}"" 
)"" 
;"" 
builder%% 
.%% 
Services%% 
.%% #
AddEndpointsApiExplorer%% (
(%%( )
)%%) *
;%%* +
builder&& 
.&& 
Services&& 
.&& 
AddSwaggerGen&& 
(&& 
options&& &
=>&&' )
{'' 
options(( 
.(( 

SwaggerDoc(( 
((( 
$str(( 
,(( 
new((  
(((  !
)((! "
{((# $
Title((% *
=((+ ,
$str((- :
,((: ;
Version((< C
=((D E
$str((F J
}((K L
)((L M
;((M N
options** 
.** !
AddSecurityDefinition** !
(**! "
$str**" *
,*** +
new**, /!
OpenApiSecurityScheme**0 E
{++ 
Name,, 
=,, 
$str,, 
,,, 
Type-- 
=-- 
SecuritySchemeType-- !
.--! "
Http--" &
,--& '
Scheme.. 
=.. 
$str.. 
,.. 
BearerFormat// 
=// 
$str// 
,// 
In00 

=00 
ParameterLocation00 
.00 
Header00 %
,00% &
Description11 
=11 
$str11 F
}22 
)22 
;22 
options44 
.44 "
AddSecurityRequirement44 "
(44" #
new44# &&
OpenApiSecurityRequirement44' A
{55 
{66 	
new77 !
OpenApiSecurityScheme77 %
{77& '
	Reference88 
=88 
new88 
OpenApiReference88  0
{881 2
Type99 
=99 
ReferenceType99 (
.99( )
SecurityScheme99) 7
,997 8
Id:: 
=:: 
$str:: !
};; 
}<< 
,<< 
Array== 
.== 
Empty== 
<== 
string== 
>== 
(==  
)==  !
}>> 	
}?? 
)?? 
;?? 
}@@ 
)@@ 
;@@ 
varCC 
jwtKeyCC 

=CC 
builderCC 
.CC 
ConfigurationCC "
[CC" #
$strCC# ,
]CC, -
;CC- .
varDD 
	jwtIssuerDD 
=DD 
builderDD 
.DD 
ConfigurationDD %
[DD% &
$strDD& 2
]DD2 3
;DD3 4
varEE 
jwtAudEE 

=EE 
builderEE 
.EE 
ConfigurationEE "
[EE" #
$strEE# 1
]EE1 2
;EE2 3
builderGG 
.GG 
ServicesGG 
.GG 
AddAuthenticationGG "
(GG" #
JwtBearerDefaultsGG# 4
.GG4 5 
AuthenticationSchemeGG5 I
)GGI J
.HH 
AddJwtBearerHH 
(HH 
optionsHH 
=>HH 
{II 
varJJ 
keyJJ 
=JJ 
EncodingJJ 
.JJ 
UTF8JJ 
.JJ  
GetBytesJJ  (
(JJ( )
jwtKeyJJ) /
)JJ/ 0
;JJ0 1
optionsLL 
.LL %
TokenValidationParametersLL )
=LL* +
newLL, /%
TokenValidationParametersLL0 I
{MM 	
ValidateIssuerNN 
=NN 
trueNN !
,NN! "
ValidateAudienceOO 
=OO 
trueOO #
,OO# $
ValidateLifetimePP 
=PP 
truePP #
,PP# $$
ValidateIssuerSigningKeyQQ $
=QQ% &
trueQQ' +
,QQ+ ,
ValidIssuerRR 
=RR 
	jwtIssuerRR #
,RR# $
ValidAudienceSS 
=SS 
jwtAudSS "
,SS" #
IssuerSigningKeyTT 
=TT 
newTT " 
SymmetricSecurityKeyTT# 7
(TT7 8
keyTT8 ;
)TT; <
,TT< =
NameClaimTypeUU 
=UU 

ClaimTypesUU &
.UU& '
NameIdentifierUU' 5
,UU5 6
RoleClaimTypeVV 
=VV 

ClaimTypesVV &
.VV& '
RoleVV' +
,VV+ ,!
RequireExpirationTimeWW !
=WW" #
trueWW$ (
}XX 	
;XX	 

optionsZZ 
.ZZ 
EventsZZ 
=ZZ 
newZZ 
JwtBearerEventsZZ ,
{[[ 	"
OnAuthenticationFailed\\ "
=\\# $
ctx\\% (
=>\\) +
{]] 
Console^^ 
.^^ 
	WriteLine^^ !
(^^! "
$"^^" $
$str^^$ /
{^^/ 0
ctx^^0 3
.^^3 4
	Exception^^4 =
.^^= >
Message^^> E
}^^E F
"^^F G
)^^G H
;^^H I
return__ 
Task__ 
.__ 
CompletedTask__ )
;__) *
}`` 
}aa 	
;aa	 

}bb 
)bb 
;bb 
builderee 
.ee 
Servicesee 
.ee 
AddAuthorizationee !
(ee! "
optionsee" )
=>ee* ,
{ff 
optionsgg 
.gg 
	AddPolicygg 
(gg 
$strgg #
,gg# $
policygg% +
=>gg, .
policygg/ 5
.gg5 6
RequireRolegg6 A
(ggA B
$strggB K
)ggK L
)ggL M
;ggM N
}hh 
)hh 
;hh 
builderkk 
.kk 
Serviceskk 
.kk 
AddCorskk 
(kk 
optionskk  
=>kk! #
{ll 
optionsmm 
.mm 
	AddPolicymm 
(mm 
$strmm %
,mm% &
policymm' -
=>mm. 0
{nn 
policyoo 
.oo 
WithOriginsoo 
(oo 
$stroo 2
)oo2 3
.pp 
AllowAnyHeaderpp 
(pp 
)pp 
.qq 
AllowAnyMethodqq 
(qq 
)qq 
;qq  
}rr 
)rr 
;rr 
}ss 
)ss 
;ss 
varuu 
appuu 
=uu 	
builderuu
 
.uu 
Builduu 
(uu 
)uu 
;uu 
ifxx 
(xx 
appxx 
.xx 
Environmentxx 
.xx 
IsDevelopmentxx !
(xx! "
)xx" #
)xx# $
{yy 
appzz 
.zz 

UseSwaggerzz 
(zz 
)zz 
;zz 
app{{ 
.{{ 
UseSwaggerUI{{ 
({{ 
){{ 
;{{ 
}|| 
app~~ 
.~~ 
UseCors~~ 
(~~ 
$str~~ 
)~~ 
;~~ 
appÄÄ 
.
ÄÄ !
UseHttpsRedirection
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
appÇÇ 
.
ÇÇ 
UseAuthentication
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
appÉÉ 
.
ÉÉ 
UseAuthorization
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
varÜÜ 
uploadsPath
ÜÜ 
=
ÜÜ 
Path
ÜÜ 
.
ÜÜ 
Combine
ÜÜ 
(
ÜÜ 
app
ÜÜ "
.
ÜÜ" #
Environment
ÜÜ# .
.
ÜÜ. /
ContentRootPath
ÜÜ/ >
,
ÜÜ> ?
$str
ÜÜ@ I
)
ÜÜI J
;
ÜÜJ K
ifââ 
(
ââ 
!
ââ 
	Directory
ââ 
.
ââ 
Exists
ââ 
(
ââ 
uploadsPath
ââ !
)
ââ! "
)
ââ" #
	Directory
ää 
.
ää 
CreateDirectory
ää 
(
ää 
uploadsPath
ää )
)
ää) *
;
ää* +
appåå 
.
åå 
UseStaticFiles
åå 
(
åå 
new
åå 
StaticFileOptions
åå (
{çç 
FileProvider
éé 
=
éé 
new
éé "
PhysicalFileProvider
éé +
(
éé+ ,
uploadsPath
éé, 7
)
éé7 8
,
éé8 9
RequestPath
èè 
=
èè 
$str
èè 
,
èè #
ServeUnknownFileTypes
êê 
=
êê 
true
êê  
,
êê  ! 
DefaultContentType
ëë 
=
ëë 
$str
ëë 3
,
ëë3 4
}íí 
)
íí 
;
íí 
Consoleïï 
.
ïï 
	WriteLine
ïï 
(
ïï 
$str
ïï .
+
ïï/ 0
uploadsPath
ïï1 <
)
ïï< =
;
ïï= >
appòò 
.
òò 
MapControllers
òò 
(
òò 
)
òò 
;
òò 
appöö 
.
öö 
Run
öö 
(
öö 
)
öö 	
;
öö	 
Ø)
DD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\User.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
User 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

string

 
Email

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
=

& '
null

( ,
!

, -
;

- .
public 

string 
? 
Username 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
PasswordHash 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
null/ 3
!3 4
;4 5
public 

string 
Role 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
public 

bool 
? 
IsActive 
{ 
get 
;  
set! $
;$ %
}& '
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
	UpdatedAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

virtual 
ICollection 
< 
CourseApproval -
>- .
CourseApprovals/ >
{? @
getA D
;D E
setF I
;I J
}K L
=M N
newO R
ListS W
<W X
CourseApprovalX f
>f g
(g h
)h i
;i j
public 

virtual 
ICollection 
< !
CourseTakedownRequest 4
>4 5"
CourseTakedownRequests6 L
{M N
getO R
;R S
setT W
;W X
}Y Z
=[ \
new] `
Lista e
<e f!
CourseTakedownRequestf {
>{ |
(| }
)} ~
;~ 
public 

virtual 
ICollection 
< 
Course %
>% &
Courses' .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
== >
new? B
ListC G
<G H
CourseH N
>N O
(O P
)P Q
;Q R
public 

virtual 
ICollection 
< 

Enrollment )
>) *
Enrollments+ 6
{7 8
get9 <
;< =
set> A
;A B
}C D
=E F
newG J
ListK O
<O P

EnrollmentP Z
>Z [
([ \
)\ ]
;] ^
public   

virtual   
ICollection   
<   
Feedback   '
>  ' (
	Feedbacks  ) 2
{  3 4
get  5 8
;  8 9
set  : =
;  = >
}  ? @
=  A B
new  C F
List  G K
<  K L
Feedback  L T
>  T U
(  U V
)  V W
;  W X
public"" 

virtual"" 
ICollection"" 
<"" 
Moduleprogress"" -
>""- .
Moduleprogresses""/ ?
{""@ A
get""B E
;""E F
set""G J
;""J K
}""L M
=""N O
new""P S
List""T X
<""X Y
Moduleprogress""Y g
>""g h
(""h i
)""i j
;""j k
public$$ 

virtual$$ 
ICollection$$ 
<$$ 
Notification$$ +
>$$+ ,
Notifications$$- :
{$$; <
get$$= @
;$$@ A
set$$B E
;$$E F
}$$G H
=$$I J
new$$K N
List$$O S
<$$S T
Notification$$T `
>$$` a
($$a b
)$$b c
;$$c d
public&& 

virtual&& 
ICollection&& 
<&& 
Passwordreset&& ,
>&&, -
Passwordresets&&. <
{&&= >
get&&? B
;&&B C
set&&D G
;&&G H
}&&I J
=&&K L
new&&M P
List&&Q U
<&&U V
Passwordreset&&V c
>&&c d
(&&d e
)&&e f
;&&f g
public(( 

virtual(( 
ICollection(( 
<(( 
Passwordtoken(( ,
>((, -
Passwordtokens((. <
{((= >
get((? B
;((B C
set((D G
;((G H
}((I J
=((K L
new((M P
List((Q U
<((U V
Passwordtoken((V c
>((c d
(((d e
)((e f
;((f g
})) õ
MD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Passwordtoken.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
Passwordtoken "
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
UserId

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 

string 
Email 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

string 
Token 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

DateTime 

ExpiryTime 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
SentAt 
{ 
get  
;  !
set" %
;% &
}' (
public 

virtual 
User 
User 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
null- 1
!1 2
;2 3
} õ
MD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Passwordreset.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
Passwordreset "
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
UserId

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 

string 
Email 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

string 
Token 
{ 
get 
; 
set "
;" #
}$ %
=& '
null( ,
!, -
;- .
public 

DateTime 
SentAt 
{ 
get  
;  !
set" %
;% &
}' (
public 

DateTime 

ExpiryTime 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

virtual 
User 
User 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
null- 1
!1 2
;2 3
} û
LD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Notification.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
Notification !
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
UserId

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 

string 
Type 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
public 

string 
Message 
{ 
get 
;  
set! $
;$ %
}& '
=( )
null* .
!. /
;/ 0
public 

bool 
? 
IsRead 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

virtual 
User 
User 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
null- 1
!1 2
;2 3
public 

int 
? 
CourseId 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
public 

Course 
? 
Course 
{  
get! $
;$ %
set& )
;) *
}+ ,
} Á
ND:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Moduleprogress.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
Moduleprogress #
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
	LearnerId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

int 
ModuleId 
{ 
get 
; 
set "
;" #
}$ %
public 

int 
CourseId 
{ 
get 
; 
set "
;" #
}$ %
public 

decimal 
? 
ProgressPercentage &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 

bool 
? 
IsCompleted 
{ 
get "
;" #
set$ '
;' (
}) *
public 

DateTime 
? 
	UpdatedAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

virtual 
User 
Learner 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
public 

virtual 
Module 
Module  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
!5 6
;6 7
} ‡
FD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Module.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
Module 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
CourseId

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
public 

string 
? 

Difficulty 
{ 
get  #
;# $
set% (
;( )
}* +
public 

string 
? 
Description 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
FilePath 
{ 
get !
;! "
set# &
;& '
}( )
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
	UpdatedAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

virtual 
Course 
Course  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
!5 6
;6 7
public 

virtual 
ICollection 
< 
Feedback '
>' (
	Feedbacks) 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
=A B
newC F
ListG K
<K L
FeedbackL T
>T U
(U V
)V W
;W X
public 

virtual 
ICollection 
< 
Moduleprogress -
>- .
Moduleprogresses/ ?
{@ A
getB E
;E F
setG J
;J K
}L M
=N O
newP S
ListT X
<X Y
ModuleprogressY g
>g h
(h i
)i j
;j k
} Ë‚
ND:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\MiniLMSContext.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
MiniLMSContext #
:$ %
	DbContext& /
{		 
public

 

MiniLMSContext

 
(

 
)

 
{ 
} 
public 

MiniLMSContext 
( 
DbContextOptions *
<* +
MiniLMSContext+ 9
>9 :
options; B
)B C
: 	
base
 
( 
options 
) 
{ 
} 
public 

virtual 
DbSet 
< 
Course 
>  
Courses! (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 

virtual 
DbSet 
< 
CourseApproval '
>' (
CourseApprovals) 8
{9 :
get; >
;> ?
set@ C
;C D
}E F
public 

virtual 
DbSet 
< !
CourseTakedownRequest .
>. /"
CourseTakedownRequests0 F
{G H
getI L
;L M
setN Q
;Q R
}S T
public 

virtual 
DbSet 
< 
Emailotp !
>! "
	Emailotps# ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 

virtual 
DbSet 
< 

Enrollment #
># $
Enrollments% 0
{1 2
get3 6
;6 7
set8 ;
;; <
}= >
public 

virtual 
DbSet 
< 
Feedback !
>! "
	Feedbacks# ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public!! 

virtual!! 
DbSet!! 
<!! 
Module!! 
>!!  
Modules!!! (
{!!) *
get!!+ .
;!!. /
set!!0 3
;!!3 4
}!!5 6
public## 

virtual## 
DbSet## 
<## 
CourseProgress## '
>##' (
CourseProgresses##) 9
{##: ;
get##< ?
;##? @
set##A D
;##D E
}##F G
public&& 

virtual&& 
DbSet&& 
<&& 
Moduleprogress&& '
>&&' (
Moduleprogresses&&) 9
{&&: ;
get&&< ?
;&&? @
set&&A D
;&&D E
}&&F G
public(( 

virtual(( 
DbSet(( 
<(( 
Notification(( %
>((% &
Notifications((' 4
{((5 6
get((7 :
;((: ;
set((< ?
;((? @
}((A B
public** 

virtual** 
DbSet** 
<** 
Passwordreset** &
>**& '
Passwordresets**( 6
{**7 8
get**9 <
;**< =
set**> A
;**A B
}**C D
public,, 

virtual,, 
DbSet,, 
<,, 
Passwordtoken,, &
>,,& '
Passwordtokens,,( 6
{,,7 8
get,,9 <
;,,< =
set,,> A
;,,A B
},,C D
public.. 

virtual.. 
DbSet.. 
<.. 
User.. 
>.. 
Users.. $
{..% &
get..' *
;..* +
set.., /
;../ 0
}..1 2
	protected00 
override00 
void00 
OnConfiguring00 )
(00) *#
DbContextOptionsBuilder00* A
optionsBuilder00B P
)00P Q
=>22 

optionsBuilder22 
.22 
UseMySql22 "
(22" #
$str22# u
,22u v
	Microsoft	22w Ä
.
22Ä Å!
EntityFrameworkCore
22Å î
.
22î ï
ServerVersion
22ï ¢
.
22¢ £
Parse
22£ ®
(
22® ©
$str
22© ∑
)
22∑ ∏
)
22∏ π
;
22π ∫
	protected44 
override44 
void44 
OnModelCreating44 +
(44+ ,
ModelBuilder44, 8
modelBuilder449 E
)44E F
{55 
modelBuilder66 
.77 
UseCollation77 
(77 
$str77 .
)77. /
.88 

HasCharSet88 
(88 
$str88 !
)88! "
;88" #
modelBuilder:: 
.:: 
Entity:: 
<:: 
Course:: "
>::" #
(::# $
entity::$ *
=>::+ -
{;; 	
entity<< 
.<< 
HasKey<< 
(<< 
e<< 
=><< 
e<<  
.<<  !
Id<<! #
)<<# $
.<<$ %
HasName<<% ,
(<<, -
$str<<- 6
)<<6 7
;<<7 8
entity>> 
.>> 
ToTable>> 
(>> 
$str>> $
)>>$ %
;>>% &
entity@@ 
.@@ 
HasIndex@@ 
(@@ 
e@@ 
=>@@  
e@@! "
.@@" #
	TrainerId@@# ,
,@@, -
$str@@. 9
)@@9 :
;@@: ;
entityBB 
.BB 
PropertyBB 
(BB 
eBB 
=>BB  
eBB! "
.BB" #
	CreatedAtBB# ,
)BB, -
.BB- .
HasColumnTypeBB. ;
(BB; <
$strBB< F
)BBF G
;BBG H
entityCC 
.CC 
PropertyCC 
(CC 
eCC 
=>CC  
eCC! "
.CC" #

IsApprovedCC# -
)CC- .
.CC. /
HasDefaultValueSqlCC/ A
(CCA B
$strCCB G
)CCG H
;CCH I
entityDD 
.DD 
PropertyDD 
(DD 
eDD 
=>DD  
eDD! "
.DD" #
NameDD# '
)DD' (
.DD( )
HasMaxLengthDD) 5
(DD5 6
$numDD6 9
)DD9 :
;DD: ;
entityEE 
.EE 
PropertyEE 
(EE 
eEE 
=>EE  
eEE! "
.EE" #
TypeEE# '
)EE' (
.EE( )
HasMaxLengthEE) 5
(EE5 6
$numEE6 9
)EE9 :
;EE: ;
entityFF 
.FF 
PropertyFF 
(FF 
eFF 
=>FF  
eFF! "
.FF" #
	UpdatedAtFF# ,
)FF, -
.FF- .
HasColumnTypeFF. ;
(FF; <
$strFF< F
)FFF G
;FFG H
entityGG 
.GG 
PropertyGG 
(GG 
eGG 
=>GG  
eGG! "
.GG" #

VisibilityGG# -
)GG- .
.HH 
HasDefaultValueSqlHH #
(HH# $
$strHH$ .
)HH. /
.II 
HasColumnTypeII 
(II 
$strII 8
)II8 9
;II9 :
entityKK 
.KK 
HasOneKK 
(KK 
dKK 
=>KK 
dKK  
.KK  !
TrainerKK! (
)KK( )
.KK) *
WithManyKK* 2
(KK2 3
pKK3 4
=>KK5 7
pKK8 9
.KK9 :
CoursesKK: A
)KKA B
.LL 
HasForeignKeyLL 
(LL 
dLL  
=>LL! #
dLL$ %
.LL% &
	TrainerIdLL& /
)LL/ 0
.MM 
OnDeleteMM 
(MM 
DeleteBehaviorMM (
.MM( )
ClientSetNullMM) 6
)MM6 7
.NN 
HasConstraintNameNN "
(NN" #
$strNN# 3
)NN3 4
;NN4 5
}OO 	
)OO	 

;OO
 
modelBuilderQQ 
.QQ 
EntityQQ 
<QQ 
CourseApprovalQQ *
>QQ* +
(QQ+ ,
entityQQ, 2
=>QQ3 5
{RR 	
entitySS 
.SS 
HasKeySS 
(SS 
eSS 
=>SS 
eSS  
.SS  !
IdSS! #
)SS# $
.SS$ %
HasNameSS% ,
(SS, -
$strSS- 6
)SS6 7
;SS7 8
entityUU 
.UU 
ToTableUU 
(UU 
$strUU -
)UU- .
;UU. /
entityWW 
.WW 
HasIndexWW 
(WW 
eWW 
=>WW  
eWW! "
.WW" #
CourseIdWW# +
,WW+ ,
$strWW- 7
)WW7 8
;WW8 9
entityYY 
.YY 
HasIndexYY 
(YY 
eYY 
=>YY  
eYY! "
.YY" #
RequestedByYY# .
,YY. /
$strYY0 =
)YY= >
;YY> ?
entity[[ 
.[[ 
Property[[ 
([[ 
e[[ 
=>[[  
e[[! "
.[[" #
RequestedAt[[# .
)[[. /
.[[/ 0
HasColumnType[[0 =
([[= >
$str[[> H
)[[H I
;[[I J
entity\\ 
.\\ 
Property\\ 
(\\ 
e\\ 
=>\\  
e\\! "
.\\" #
RespondedAt\\# .
)\\. /
.\\/ 0
HasColumnType\\0 =
(\\= >
$str\\> H
)\\H I
;\\I J
entity]] 
.]] 
Property]] 
(]] 
e]] 
=>]]  
e]]! "
.]]" #
Status]]# )
)]]) *
.^^ 
HasDefaultValueSql^^ #
(^^# $
$str^^$ /
)^^/ 0
.__ 
HasColumnType__ 
(__ 
$str__ F
)__F G
;__G H
entityaa 
.aa 
HasOneaa 
(aa 
daa 
=>aa 
daa  
.aa  !
Courseaa! '
)aa' (
.aa( )
WithManyaa) 1
(aa1 2
paa2 3
=>aa4 6
paa7 8
.aa8 9
CourseApprovalsaa9 H
)aaH I
.bb 
HasForeignKeybb 
(bb 
dbb  
=>bb! #
dbb$ %
.bb% &
CourseIdbb& .
)bb. /
.cc 
OnDeletecc 
(cc 
DeleteBehaviorcc (
.cc( )
ClientSetNullcc) 6
)cc6 7
.dd 
HasConstraintNamedd "
(dd" #
$strdd# <
)dd< =
;dd= >
entityff 
.ff 
HasOneff 
(ff 
dff 
=>ff 
dff  
.ff  !!
RequestedByNavigationff! 6
)ff6 7
.ff7 8
WithManyff8 @
(ff@ A
pffA B
=>ffC E
pffF G
.ffG H
CourseApprovalsffH W
)ffW X
.gg 
HasForeignKeygg 
(gg 
dgg  
=>gg! #
dgg$ %
.gg% &
RequestedBygg& 1
)gg1 2
.hh 
OnDeletehh 
(hh 
DeleteBehaviorhh (
.hh( )
ClientSetNullhh) 6
)hh6 7
.ii 
HasConstraintNameii "
(ii" #
$strii# <
)ii< =
;ii= >
}jj 	
)jj	 

;jj
 
modelBuilderll 
.ll 
Entityll 
<ll !
CourseTakedownRequestll 1
>ll1 2
(ll2 3
entityll3 9
=>ll: <
{mm 	
entitynn 
.nn 
HasKeynn 
(nn 
enn 
=>nn 
enn  
.nn  !
Idnn! #
)nn# $
.nn$ %
HasNamenn% ,
(nn, -
$strnn- 6
)nn6 7
;nn7 8
entitypp 
.pp 
ToTablepp 
(pp 
$strpp 5
)pp5 6
;pp6 7
entityrr 
.rr 
HasIndexrr 
(rr 
err 
=>rr  
err! "
.rr" #
CourseIdrr# +
,rr+ ,
$strrr- 8
)rr8 9
;rr9 :
entitytt 
.tt 
HasIndextt 
(tt 
ett 
=>tt  
ett! "
.tt" #
RequestedBytt# .
,tt. /
$strtt0 >
)tt> ?
;tt? @
entityvv 
.vv 
Propertyvv 
(vv 
evv 
=>vv  
evv! "
.vv" #
Reasonvv# )
)vv) *
.vv* +
HasColumnTypevv+ 8
(vv8 9
$strvv9 ?
)vv? @
;vv@ A
entityww 
.ww 
Propertyww 
(ww 
eww 
=>ww  
eww! "
.ww" #
RequestedAtww# .
)ww. /
.ww/ 0
HasColumnTypeww0 =
(ww= >
$strww> H
)wwH I
;wwI J
entityxx 
.xx 
Propertyxx 
(xx 
exx 
=>xx  
exx! "
.xx" #
RespondedAtxx# .
)xx. /
.xx/ 0
HasColumnTypexx0 =
(xx= >
$strxx> H
)xxH I
;xxI J
entityyy 
.yy 
Propertyyy 
(yy 
eyy 
=>yy  
eyy! "
.yy" #
Statusyy# )
)yy) *
.zz 
HasDefaultValueSqlzz #
(zz# $
$strzz$ /
)zz/ 0
.{{ 
HasColumnType{{ 
({{ 
$str{{ E
){{E F
;{{F G
entity}} 
.}} 
HasOne}} 
(}} 
d}} 
=>}} 
d}}  
.}}  !
Course}}! '
)}}' (
.}}( )
WithMany}}) 1
(}}1 2
p}}2 3
=>}}4 6
p}}7 8
.}}8 9"
CourseTakedownRequests}}9 O
)}}O P
.~~ 
HasForeignKey~~ 
(~~ 
d~~  
=>~~! #
d~~$ %
.~~% &
CourseId~~& .
)~~. /
. 
OnDelete 
( 
DeleteBehavior (
.( )
ClientSetNull) 6
)6 7
.
ÄÄ 
HasConstraintName
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# D
)
ÄÄD E
;
ÄÄE F
entity
ÇÇ 
.
ÇÇ 
HasOne
ÇÇ 
(
ÇÇ 
d
ÇÇ 
=>
ÇÇ 
d
ÇÇ  
.
ÇÇ  !#
RequestedByNavigation
ÇÇ! 6
)
ÇÇ6 7
.
ÇÇ7 8
WithMany
ÇÇ8 @
(
ÇÇ@ A
p
ÇÇA B
=>
ÇÇC E
p
ÇÇF G
.
ÇÇG H$
CourseTakedownRequests
ÇÇH ^
)
ÇÇ^ _
.
ÉÉ 
HasForeignKey
ÉÉ 
(
ÉÉ 
d
ÉÉ  
=>
ÉÉ! #
d
ÉÉ$ %
.
ÉÉ% &
RequestedBy
ÉÉ& 1
)
ÉÉ1 2
.
ÑÑ 
OnDelete
ÑÑ 
(
ÑÑ 
DeleteBehavior
ÑÑ (
.
ÑÑ( )
ClientSetNull
ÑÑ) 6
)
ÑÑ6 7
.
ÖÖ 
HasConstraintName
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# D
)
ÖÖD E
;
ÖÖE F
}
ÜÜ 	
)
ÜÜ	 

;
ÜÜ
 
modelBuilder
íí 
.
íí 
Entity
íí 
<
íí 
Emailotp
íí $
>
íí$ %
(
íí% &
entity
íí& ,
=>
íí- /
{
ìì 	
entity
îî 
.
îî 
HasKey
îî 
(
îî 
e
îî 
=>
îî 
e
îî  
.
îî  !
Id
îî! #
)
îî# $
.
îî$ %
HasName
îî% ,
(
îî, -
$str
îî- 6
)
îî6 7
;
îî7 8
entity
ññ 
.
ññ 
ToTable
ññ 
(
ññ 
$str
ññ &
)
ññ& '
;
ññ' (
entity
òò 
.
òò 
HasIndex
òò 
(
òò 
e
òò 
=>
òò  
e
òò! "
.
òò" #
Email
òò# (
,
òò( )
$str
òò* >
)
òò> ?
.
òò? @
IsUnique
òò@ H
(
òòH I
)
òòI J
;
òòJ K
entity
öö 
.
öö 
Property
öö 
(
öö 
e
öö 
=>
öö  
e
öö! "
.
öö" #

ExpiryTime
öö# -
)
öö- .
.
öö. /
HasColumnType
öö/ <
(
öö< =
$str
öö= G
)
ööG H
;
ööH I
entity
õõ 
.
õõ 
Property
õõ 
(
õõ 
e
õõ 
=>
õõ  
e
õõ! "
.
õõ" #
OtpCode
õõ# *
)
õõ* +
.
õõ+ ,
HasMaxLength
õõ, 8
(
õõ8 9
$num
õõ9 ;
)
õõ; <
;
õõ< =
entity
úú 
.
úú 
Property
úú 
(
úú 
e
úú 
=>
úú  
e
úú! "
.
úú" #
SentAt
úú# )
)
úú) *
.
úú* +
HasColumnType
úú+ 8
(
úú8 9
$str
úú9 C
)
úúC D
;
úúD E
}
ùù 	
)
ùù	 

;
ùù
 
modelBuilder
üü 
.
üü 
Entity
üü 
<
üü 

Enrollment
üü &
>
üü& '
(
üü' (
entity
üü( .
=>
üü/ 1
{
†† 	
entity
°° 
.
°° 
HasKey
°° 
(
°° 
e
°° 
=>
°° 
e
°°  
.
°°  !
Id
°°! #
)
°°# $
.
°°$ %
HasName
°°% ,
(
°°, -
$str
°°- 6
)
°°6 7
;
°°7 8
entity
££ 
.
££ 
ToTable
££ 
(
££ 
$str
££ (
)
££( )
;
££) *
entity
•• 
.
•• 
HasIndex
•• 
(
•• 
e
•• 
=>
••  
e
••! "
.
••" #
CourseId
••# +
,
••+ ,
$str
••- ?
)
••? @
;
••@ A
entity
ßß 
.
ßß 
HasIndex
ßß 
(
ßß 
e
ßß 
=>
ßß  
new
ßß! $
{
ßß% &
e
ßß' (
.
ßß( )
	LearnerId
ßß) 2
,
ßß2 3
e
ßß4 5
.
ßß5 6
CourseId
ßß6 >
}
ßß? @
,
ßß@ A
$str
ßßB U
)
ßßU V
.
ßßV W
IsUnique
ßßW _
(
ßß_ `
)
ßß` a
;
ßßa b
entity
©© 
.
©© 
Property
©© 
(
©© 
e
©© 
=>
©©  
e
©©! "
.
©©" #

EnrolledAt
©©# -
)
©©- .
.
™™  
HasDefaultValueSql
™™ #
(
™™# $
$str
™™$ 7
)
™™7 8
.
´´ 
HasColumnType
´´ 
(
´´ 
$str
´´ )
)
´´) *
;
´´* +
entity
¨¨ 
.
¨¨ 
Property
¨¨ 
(
¨¨ 
e
¨¨ 
=>
¨¨  
e
¨¨! "
.
¨¨" #
Status
¨¨# )
)
¨¨) *
.
≠≠  
HasDefaultValueSql
≠≠ #
(
≠≠# $
$str
≠≠$ .
)
≠≠. /
.
ÆÆ 
HasColumnType
ÆÆ 
(
ÆÆ 
$str
ÆÆ E
)
ÆÆE F
;
ÆÆF G
entity
∞∞ 
.
∞∞ 
HasOne
∞∞ 
(
∞∞ 
d
∞∞ 
=>
∞∞ 
d
∞∞  
.
∞∞  !
Course
∞∞! '
)
∞∞' (
.
∞∞( )
WithMany
∞∞) 1
(
∞∞1 2
p
∞∞2 3
=>
∞∞4 6
p
∞∞7 8
.
∞∞8 9
Enrollments
∞∞9 D
)
∞∞D E
.
±± 
HasForeignKey
±± 
(
±± 
d
±±  
=>
±±! #
d
±±$ %
.
±±% &
CourseId
±±& .
)
±±. /
.
≤≤ 
HasConstraintName
≤≤ "
(
≤≤" #
$str
≤≤# 5
)
≤≤5 6
;
≤≤6 7
entity
¥¥ 
.
¥¥ 
HasOne
¥¥ 
(
¥¥ 
d
¥¥ 
=>
¥¥ 
d
¥¥  
.
¥¥  !
Learner
¥¥! (
)
¥¥( )
.
¥¥) *
WithMany
¥¥* 2
(
¥¥2 3
p
¥¥3 4
=>
¥¥5 7
p
¥¥8 9
.
¥¥9 :
Enrollments
¥¥: E
)
¥¥E F
.
µµ 
HasForeignKey
µµ 
(
µµ 
d
µµ  
=>
µµ! #
d
µµ$ %
.
µµ% &
	LearnerId
µµ& /
)
µµ/ 0
.
∂∂ 
HasConstraintName
∂∂ "
(
∂∂" #
$str
∂∂# 3
)
∂∂3 4
;
∂∂4 5
}
∑∑ 	
)
∑∑	 

;
∑∑
 
modelBuilder
ππ 
.
ππ 
Entity
ππ 
<
ππ 
Feedback
ππ $
>
ππ$ %
(
ππ% &
entity
ππ& ,
=>
ππ- /
{
∫∫ 	
entity
ªª 
.
ªª 
HasKey
ªª 
(
ªª 
e
ªª 
=>
ªª 
e
ªª  
.
ªª  !
Id
ªª! #
)
ªª# $
.
ªª$ %
HasName
ªª% ,
(
ªª, -
$str
ªª- 6
)
ªª6 7
;
ªª7 8
entity
ΩΩ 
.
ΩΩ 
ToTable
ΩΩ 
(
ΩΩ 
$str
ΩΩ &
)
ΩΩ& '
;
ΩΩ' (
entity
øø 
.
øø 
HasIndex
øø 
(
øø 
e
øø 
=>
øø  
e
øø! "
.
øø" #
CourseId
øø# +
,
øø+ ,
$str
øø- 8
)
øø8 9
;
øø9 :
entity
¡¡ 
.
¡¡ 
HasIndex
¡¡ 
(
¡¡ 
e
¡¡ 
=>
¡¡  
e
¡¡! "
.
¡¡" #
	LearnerId
¡¡# ,
,
¡¡, -
$str
¡¡. 9
)
¡¡9 :
;
¡¡: ;
entity
√√ 
.
√√ 
HasIndex
√√ 
(
√√ 
e
√√ 
=>
√√  
e
√√! "
.
√√" #
ModuleId
√√# +
,
√√+ ,
$str
√√- 7
)
√√7 8
;
√√8 9
entity
≈≈ 
.
≈≈ 
Property
≈≈ 
(
≈≈ 
e
≈≈ 
=>
≈≈  
e
≈≈! "
.
≈≈" #
Message
≈≈# *
)
≈≈* +
.
≈≈+ ,
HasColumnType
≈≈, 9
(
≈≈9 :
$str
≈≈: @
)
≈≈@ A
;
≈≈A B
entity
∆∆ 
.
∆∆ 
Property
∆∆ 
(
∆∆ 
e
∆∆ 
=>
∆∆  
e
∆∆! "
.
∆∆" #
SubmittedAt
∆∆# .
)
∆∆. /
.
∆∆/ 0
HasColumnType
∆∆0 =
(
∆∆= >
$str
∆∆> H
)
∆∆H I
;
∆∆I J
entity
»» 
.
»» 
HasOne
»» 
(
»» 
d
»» 
=>
»» 
d
»»  
.
»»  !
Course
»»! '
)
»»' (
.
»»( )
WithMany
»») 1
(
»»1 2
p
»»2 3
=>
»»4 6
p
»»7 8
.
»»8 9
	Feedbacks
»»9 B
)
»»B C
.
…… 
HasForeignKey
…… 
(
…… 
d
……  
=>
……! #
d
……$ %
.
……% &
CourseId
……& .
)
……. /
.
   
OnDelete
   
(
   
DeleteBehavior
   (
.
  ( )
ClientSetNull
  ) 6
)
  6 7
.
ÀÀ 
HasConstraintName
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 5
)
ÀÀ5 6
;
ÀÀ6 7
entity
ÕÕ 
.
ÕÕ 
HasOne
ÕÕ 
(
ÕÕ 
d
ÕÕ 
=>
ÕÕ 
d
ÕÕ  
.
ÕÕ  !
Learner
ÕÕ! (
)
ÕÕ( )
.
ÕÕ) *
WithMany
ÕÕ* 2
(
ÕÕ2 3
p
ÕÕ3 4
=>
ÕÕ5 7
p
ÕÕ8 9
.
ÕÕ9 :
	Feedbacks
ÕÕ: C
)
ÕÕC D
.
ŒŒ 
HasForeignKey
ŒŒ 
(
ŒŒ 
d
ŒŒ  
=>
ŒŒ! #
d
ŒŒ$ %
.
ŒŒ% &
	LearnerId
ŒŒ& /
)
ŒŒ/ 0
.
œœ 
OnDelete
œœ 
(
œœ 
DeleteBehavior
œœ (
.
œœ( )
ClientSetNull
œœ) 6
)
œœ6 7
.
–– 
HasConstraintName
–– "
(
––" #
$str
––# 5
)
––5 6
;
––6 7
entity
““ 
.
““ 
HasOne
““ 
(
““ 
d
““ 
=>
““ 
d
““  
.
““  !
Module
““! '
)
““' (
.
““( )
WithMany
““) 1
(
““1 2
p
““2 3
=>
““4 6
p
““7 8
.
““8 9
	Feedbacks
““9 B
)
““B C
.
”” 
HasForeignKey
”” 
(
”” 
d
””  
=>
””! #
d
””$ %
.
””% &
ModuleId
””& .
)
””. /
.
‘‘ 
HasConstraintName
‘‘ "
(
‘‘" #
$str
‘‘# 5
)
‘‘5 6
;
‘‘6 7
}
’’ 	
)
’’	 

;
’’
 
modelBuilder
◊◊ 
.
◊◊ 
Entity
◊◊ 
<
◊◊ 
Module
◊◊ "
>
◊◊" #
(
◊◊# $
entity
◊◊$ *
=>
◊◊+ -
{
ÿÿ 	
entity
ŸŸ 
.
ŸŸ 
HasKey
ŸŸ 
(
ŸŸ 
e
ŸŸ 
=>
ŸŸ 
e
ŸŸ  
.
ŸŸ  !
Id
ŸŸ! #
)
ŸŸ# $
.
ŸŸ$ %
HasName
ŸŸ% ,
(
ŸŸ, -
$str
ŸŸ- 6
)
ŸŸ6 7
;
ŸŸ7 8
entity
€€ 
.
€€ 
ToTable
€€ 
(
€€ 
$str
€€ $
)
€€$ %
;
€€% &
entity
›› 
.
›› 
HasIndex
›› 
(
›› 
e
›› 
=>
››  
e
››! "
.
››" #
CourseId
››# +
,
››+ ,
$str
››- 8
)
››8 9
;
››9 :
entity
ﬂﬂ 
.
ﬂﬂ 
Property
ﬂﬂ 
(
ﬂﬂ 
e
ﬂﬂ 
=>
ﬂﬂ  
e
ﬂﬂ! "
.
ﬂﬂ" #
	CreatedAt
ﬂﬂ# ,
)
ﬂﬂ, -
.
ﬂﬂ- .
HasColumnType
ﬂﬂ. ;
(
ﬂﬂ; <
$str
ﬂﬂ< F
)
ﬂﬂF G
;
ﬂﬂG H
entity
‡‡ 
.
‡‡ 
Property
‡‡ 
(
‡‡ 
e
‡‡ 
=>
‡‡  
e
‡‡! "
.
‡‡" #
Description
‡‡# .
)
‡‡. /
.
‡‡/ 0
HasColumnType
‡‡0 =
(
‡‡= >
$str
‡‡> D
)
‡‡D E
;
‡‡E F
entity
·· 
.
·· 
Property
·· 
(
·· 
e
·· 
=>
··  
e
··! "
.
··" #

Difficulty
··# -
)
··- .
.
··. /
HasMaxLength
··/ ;
(
··; <
$num
··< >
)
··> ?
;
··? @
entity
‚‚ 
.
‚‚ 
Property
‚‚ 
(
‚‚ 
e
‚‚ 
=>
‚‚  
e
‚‚! "
.
‚‚" #
FilePath
‚‚# +
)
‚‚+ ,
.
‚‚, -
HasMaxLength
‚‚- 9
(
‚‚9 :
$num
‚‚: =
)
‚‚= >
;
‚‚> ?
entity
„„ 
.
„„ 
Property
„„ 
(
„„ 
e
„„ 
=>
„„  
e
„„! "
.
„„" #
Name
„„# '
)
„„' (
.
„„( )
HasMaxLength
„„) 5
(
„„5 6
$num
„„6 9
)
„„9 :
;
„„: ;
entity
‰‰ 
.
‰‰ 
Property
‰‰ 
(
‰‰ 
e
‰‰ 
=>
‰‰  
e
‰‰! "
.
‰‰" #
	UpdatedAt
‰‰# ,
)
‰‰, -
.
‰‰- .
HasColumnType
‰‰. ;
(
‰‰; <
$str
‰‰< F
)
‰‰F G
;
‰‰G H
entity
ÊÊ 
.
ÊÊ 
HasOne
ÊÊ 
(
ÊÊ 
d
ÊÊ 
=>
ÊÊ 
d
ÊÊ  
.
ÊÊ  !
Course
ÊÊ! '
)
ÊÊ' (
.
ÊÊ( )
WithMany
ÊÊ) 1
(
ÊÊ1 2
p
ÊÊ2 3
=>
ÊÊ4 6
p
ÊÊ7 8
.
ÊÊ8 9
Modules
ÊÊ9 @
)
ÊÊ@ A
.
ÁÁ 
HasForeignKey
ÁÁ 
(
ÁÁ 
d
ÁÁ  
=>
ÁÁ! #
d
ÁÁ$ %
.
ÁÁ% &
CourseId
ÁÁ& .
)
ÁÁ. /
.
ËË 
OnDelete
ËË 
(
ËË 
DeleteBehavior
ËË (
.
ËË( )
ClientSetNull
ËË) 6
)
ËË6 7
.
ÈÈ 
HasConstraintName
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 3
)
ÈÈ3 4
;
ÈÈ4 5
}
ÍÍ 	
)
ÍÍ	 

;
ÍÍ
 
modelBuilder
ÏÏ 
.
ÏÏ 
Entity
ÏÏ 
<
ÏÏ 
Moduleprogress
ÏÏ *
>
ÏÏ* +
(
ÏÏ+ ,
entity
ÏÏ, 2
=>
ÏÏ3 5
{
ÌÌ 	
entity
ÓÓ 
.
ÓÓ 
HasKey
ÓÓ 
(
ÓÓ 
e
ÓÓ 
=>
ÓÓ 
e
ÓÓ  
.
ÓÓ  !
Id
ÓÓ! #
)
ÓÓ# $
.
ÓÓ$ %
HasName
ÓÓ% ,
(
ÓÓ, -
$str
ÓÓ- 6
)
ÓÓ6 7
;
ÓÓ7 8
entity
 
.
 
ToTable
 
(
 
$str
 +
)
+ ,
;
, -
entity
ÚÚ 
.
ÚÚ 
HasIndex
ÚÚ 
(
ÚÚ 
e
ÚÚ 
=>
ÚÚ  
e
ÚÚ! "
.
ÚÚ" #
	LearnerId
ÚÚ# ,
,
ÚÚ, -
$str
ÚÚ. I
)
ÚÚI J
;
ÚÚJ K
entity
ÙÙ 
.
ÙÙ 
HasIndex
ÙÙ 
(
ÙÙ 
e
ÙÙ 
=>
ÙÙ  
e
ÙÙ! "
.
ÙÙ" #
ModuleId
ÙÙ# +
,
ÙÙ+ ,
$str
ÙÙ- G
)
ÙÙG H
;
ÙÙH I
entity
ˆˆ 
.
ˆˆ 
Property
ˆˆ 
(
ˆˆ 
e
ˆˆ 
=>
ˆˆ  
e
ˆˆ! "
.
ˆˆ" #
IsCompleted
ˆˆ# .
)
ˆˆ. /
.
ˆˆ/ 0 
HasDefaultValueSql
ˆˆ0 B
(
ˆˆB C
$str
ˆˆC H
)
ˆˆH I
;
ˆˆI J
entity
˜˜ 
.
˜˜ 
Property
˜˜ 
(
˜˜ 
e
˜˜ 
=>
˜˜  
e
˜˜! "
.
˜˜" # 
ProgressPercentage
˜˜# 5
)
˜˜5 6
.
¯¯ 
HasPrecision
¯¯ 
(
¯¯ 
$num
¯¯ 
,
¯¯  
$num
¯¯! "
)
¯¯" #
.
˘˘  
HasDefaultValueSql
˘˘ #
(
˘˘# $
$str
˘˘$ ,
)
˘˘, -
;
˘˘- .
entity
˙˙ 
.
˙˙ 
Property
˙˙ 
(
˙˙ 
e
˙˙ 
=>
˙˙  
e
˙˙! "
.
˙˙" #
	UpdatedAt
˙˙# ,
)
˙˙, -
.
˚˚ )
ValueGeneratedOnAddOrUpdate
˚˚ ,
(
˚˚, -
)
˚˚- .
.
¸¸  
HasDefaultValueSql
¸¸ #
(
¸¸# $
$str
¸¸$ 7
)
¸¸7 8
.
˝˝ 
HasColumnType
˝˝ 
(
˝˝ 
$str
˝˝ )
)
˝˝) *
;
˝˝* +
entity
ˇˇ 
.
ˇˇ 
HasOne
ˇˇ 
(
ˇˇ 
d
ˇˇ 
=>
ˇˇ 
d
ˇˇ  
.
ˇˇ  !
Learner
ˇˇ! (
)
ˇˇ( )
.
ˇˇ) *
WithMany
ˇˇ* 2
(
ˇˇ2 3
p
ˇˇ3 4
=>
ˇˇ5 7
p
ˇˇ8 9
.
ˇˇ9 :
Moduleprogresses
ˇˇ: J
)
ˇˇJ K
.
ÄÄ 
HasForeignKey
ÄÄ 
(
ÄÄ 
d
ÄÄ  
=>
ÄÄ! #
d
ÄÄ$ %
.
ÄÄ% &
	LearnerId
ÄÄ& /
)
ÄÄ/ 0
.
ÅÅ 
HasConstraintName
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# >
)
ÅÅ> ?
;
ÅÅ? @
entity
ÉÉ 
.
ÉÉ 
HasOne
ÉÉ 
(
ÉÉ 
d
ÉÉ 
=>
ÉÉ 
d
ÉÉ  
.
ÉÉ  !
Module
ÉÉ! '
)
ÉÉ' (
.
ÉÉ( )
WithMany
ÉÉ) 1
(
ÉÉ1 2
p
ÉÉ2 3
=>
ÉÉ4 6
p
ÉÉ7 8
.
ÉÉ8 9
Moduleprogresses
ÉÉ9 I
)
ÉÉI J
.
ÑÑ 
HasForeignKey
ÑÑ 
(
ÑÑ 
d
ÑÑ  
=>
ÑÑ! #
d
ÑÑ$ %
.
ÑÑ% &
ModuleId
ÑÑ& .
)
ÑÑ. /
.
ÖÖ 
HasConstraintName
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# =
)
ÖÖ= >
;
ÖÖ> ?
}
ÜÜ 	
)
ÜÜ	 

;
ÜÜ
 
modelBuilder
àà 
.
àà 
Entity
àà 
<
àà 
Notification
àà (
>
àà( )
(
àà) *
entity
àà* 0
=>
àà1 3
{
ââ 	
entity
ää 
.
ää 
HasKey
ää 
(
ää 
e
ää 
=>
ää 
e
ää  
.
ää  !
Id
ää! #
)
ää# $
.
ää$ %
HasName
ää% ,
(
ää, -
$str
ää- 6
)
ää6 7
;
ää7 8
entity
åå 
.
åå 
ToTable
åå 
(
åå 
$str
åå *
)
åå* +
;
åå+ ,
entity
éé 
.
éé 
HasIndex
éé 
(
éé 
e
éé 
=>
éé  
e
éé! "
.
éé" #
UserId
éé# )
,
éé) *
$str
éé+ 3
)
éé3 4
;
éé4 5
entity
êê 
.
êê 
Property
êê 
(
êê 
e
êê 
=>
êê  
e
êê! "
.
êê" #
	CreatedAt
êê# ,
)
êê, -
.
êê- .
HasColumnType
êê. ;
(
êê; <
$str
êê< F
)
êêF G
;
êêG H
entity
ëë 
.
ëë 
Property
ëë 
(
ëë 
e
ëë 
=>
ëë  
e
ëë! "
.
ëë" #
IsRead
ëë# )
)
ëë) *
.
ëë* + 
HasDefaultValueSql
ëë+ =
(
ëë= >
$str
ëë> C
)
ëëC D
;
ëëD E
entity
íí 
.
íí 
Property
íí 
(
íí 
e
íí 
=>
íí  
e
íí! "
.
íí" #
Message
íí# *
)
íí* +
.
íí+ ,
HasColumnType
íí, 9
(
íí9 :
$str
íí: @
)
íí@ A
;
ííA B
entity
ìì 
.
ìì 
Property
ìì 
(
ìì 
e
ìì 
=>
ìì  
e
ìì! "
.
ìì" #
Type
ìì# '
)
ìì' (
.
ìì( )
HasMaxLength
ìì) 5
(
ìì5 6
$num
ìì6 9
)
ìì9 :
;
ìì: ;
entity
ïï 
.
ïï 
HasOne
ïï 
(
ïï 
d
ïï 
=>
ïï 
d
ïï  
.
ïï  !
User
ïï! %
)
ïï% &
.
ïï& '
WithMany
ïï' /
(
ïï/ 0
p
ïï0 1
=>
ïï2 4
p
ïï5 6
.
ïï6 7
Notifications
ïï7 D
)
ïïD E
.
ññ 
HasForeignKey
ññ 
(
ññ 
d
ññ  
=>
ññ! #
d
ññ$ %
.
ññ% &
UserId
ññ& ,
)
ññ, -
.
óó 
OnDelete
óó 
(
óó 
DeleteBehavior
óó (
.
óó( )
ClientSetNull
óó) 6
)
óó6 7
.
òò 
HasConstraintName
òò "
(
òò" #
$str
òò# 9
)
òò9 :
;
òò: ;
}
ôô 	
)
ôô	 

;
ôô
 
modelBuilder
õõ 
.
õõ 
Entity
õõ 
<
õõ 
Passwordreset
õõ )
>
õõ) *
(
õõ* +
entity
õõ+ 1
=>
õõ2 4
{
úú 	
entity
ùù 
.
ùù 
HasKey
ùù 
(
ùù 
e
ùù 
=>
ùù 
e
ùù  
.
ùù  !
Id
ùù! #
)
ùù# $
.
ùù$ %
HasName
ùù% ,
(
ùù, -
$str
ùù- 6
)
ùù6 7
;
ùù7 8
entity
üü 
.
üü 
ToTable
üü 
(
üü 
$str
üü +
)
üü+ ,
;
üü, -
entity
°° 
.
°° 
HasIndex
°° 
(
°° 
e
°° 
=>
°°  
e
°°! "
.
°°" #
UserId
°°# )
,
°°) *
$str
°°+ 4
)
°°4 5
;
°°5 6
entity
££ 
.
££ 
Property
££ 
(
££ 
e
££ 
=>
££  
e
££! "
.
££" #
Email
££# (
)
££( )
.
££) *
HasMaxLength
££* 6
(
££6 7
$num
££7 :
)
££: ;
;
££; <
entity
§§ 
.
§§ 
Property
§§ 
(
§§ 
e
§§ 
=>
§§  
e
§§! "
.
§§" #

ExpiryTime
§§# -
)
§§- .
.
§§. /
HasColumnType
§§/ <
(
§§< =
$str
§§= G
)
§§G H
;
§§H I
entity
•• 
.
•• 
Property
•• 
(
•• 
e
•• 
=>
••  
e
••! "
.
••" #
SentAt
••# )
)
••) *
.
••* +
HasColumnType
••+ 8
(
••8 9
$str
••9 C
)
••C D
;
••D E
entity
¶¶ 
.
¶¶ 
Property
¶¶ 
(
¶¶ 
e
¶¶ 
=>
¶¶  
e
¶¶! "
.
¶¶" #
Token
¶¶# (
)
¶¶( )
.
¶¶) *
HasMaxLength
¶¶* 6
(
¶¶6 7
$num
¶¶7 :
)
¶¶: ;
;
¶¶; <
entity
®® 
.
®® 
HasOne
®® 
(
®® 
d
®® 
=>
®® 
d
®®  
.
®®  !
User
®®! %
)
®®% &
.
®®& '
WithMany
®®' /
(
®®/ 0
p
®®0 1
=>
®®2 4
p
®®5 6
.
®®6 7
Passwordresets
®®7 E
)
®®E F
.
©© 
HasForeignKey
©© 
(
©© 
d
©©  
=>
©©! #
d
©©$ %
.
©©% &
UserId
©©& ,
)
©©, -
.
™™ 
OnDelete
™™ 
(
™™ 
DeleteBehavior
™™ (
.
™™( )
ClientSetNull
™™) 6
)
™™6 7
.
´´ 
HasConstraintName
´´ "
(
´´" #
$str
´´# :
)
´´: ;
;
´´; <
}
¨¨ 	
)
¨¨	 

;
¨¨
 
modelBuilder
ÆÆ 
.
ÆÆ 
Entity
ÆÆ 
<
ÆÆ 
Passwordtoken
ÆÆ )
>
ÆÆ) *
(
ÆÆ* +
entity
ÆÆ+ 1
=>
ÆÆ2 4
{
ØØ 	
entity
∞∞ 
.
∞∞ 
HasKey
∞∞ 
(
∞∞ 
e
∞∞ 
=>
∞∞ 
e
∞∞  
.
∞∞  !
Id
∞∞! #
)
∞∞# $
.
∞∞$ %
HasName
∞∞% ,
(
∞∞, -
$str
∞∞- 6
)
∞∞6 7
;
∞∞7 8
entity
≤≤ 
.
≤≤ 
ToTable
≤≤ 
(
≤≤ 
$str
≤≤ +
)
≤≤+ ,
;
≤≤, -
entity
¥¥ 
.
¥¥ 
HasIndex
¥¥ 
(
¥¥ 
e
¥¥ 
=>
¥¥  
e
¥¥! "
.
¥¥" #
UserId
¥¥# )
,
¥¥) *
$str
¥¥+ 4
)
¥¥4 5
;
¥¥5 6
entity
∂∂ 
.
∂∂ 
Property
∂∂ 
(
∂∂ 
e
∂∂ 
=>
∂∂  
e
∂∂! "
.
∂∂" #
Email
∂∂# (
)
∂∂( )
.
∂∂) *
HasMaxLength
∂∂* 6
(
∂∂6 7
$num
∂∂7 :
)
∂∂: ;
;
∂∂; <
entity
∑∑ 
.
∑∑ 
Property
∑∑ 
(
∑∑ 
e
∑∑ 
=>
∑∑  
e
∑∑! "
.
∑∑" #

ExpiryTime
∑∑# -
)
∑∑- .
.
∑∑. /
HasColumnType
∑∑/ <
(
∑∑< =
$str
∑∑= G
)
∑∑G H
;
∑∑H I
entity
∏∏ 
.
∏∏ 
Property
∏∏ 
(
∏∏ 
e
∏∏ 
=>
∏∏  
e
∏∏! "
.
∏∏" #
SentAt
∏∏# )
)
∏∏) *
.
∏∏* +
HasColumnType
∏∏+ 8
(
∏∏8 9
$str
∏∏9 C
)
∏∏C D
;
∏∏D E
entity
ππ 
.
ππ 
Property
ππ 
(
ππ 
e
ππ 
=>
ππ  
e
ππ! "
.
ππ" #
Token
ππ# (
)
ππ( )
.
ππ) *
HasMaxLength
ππ* 6
(
ππ6 7
$num
ππ7 :
)
ππ: ;
;
ππ; <
entity
ªª 
.
ªª 
HasOne
ªª 
(
ªª 
d
ªª 
=>
ªª 
d
ªª  
.
ªª  !
User
ªª! %
)
ªª% &
.
ªª& '
WithMany
ªª' /
(
ªª/ 0
p
ªª0 1
=>
ªª2 4
p
ªª5 6
.
ªª6 7
Passwordtokens
ªª7 E
)
ªªE F
.
ºº 
HasForeignKey
ºº 
(
ºº 
d
ºº  
=>
ºº! #
d
ºº$ %
.
ºº% &
UserId
ºº& ,
)
ºº, -
.
ΩΩ 
OnDelete
ΩΩ 
(
ΩΩ 
DeleteBehavior
ΩΩ (
.
ΩΩ( )
ClientSetNull
ΩΩ) 6
)
ΩΩ6 7
.
ææ 
HasConstraintName
ææ "
(
ææ" #
$str
ææ# :
)
ææ: ;
;
ææ; <
}
øø 	
)
øø	 

;
øø
 
modelBuilder
¡¡ 
.
¡¡ 
Entity
¡¡ 
<
¡¡ 
User
¡¡  
>
¡¡  !
(
¡¡! "
entity
¡¡" (
=>
¡¡) +
{
¬¬ 	
entity
√√ 
.
√√ 
HasKey
√√ 
(
√√ 
e
√√ 
=>
√√ 
e
√√  
.
√√  !
Id
√√! #
)
√√# $
.
√√$ %
HasName
√√% ,
(
√√, -
$str
√√- 6
)
√√6 7
;
√√7 8
entity
≈≈ 
.
≈≈ 
ToTable
≈≈ 
(
≈≈ 
$str
≈≈ "
)
≈≈" #
;
≈≈# $
entity
«« 
.
«« 
HasIndex
«« 
(
«« 
e
«« 
=>
««  
e
««! "
.
««" #
Email
««# (
,
««( )
$str
««* 1
)
««1 2
.
««2 3
IsUnique
««3 ;
(
««; <
)
««< =
;
««= >
entity
…… 
.
…… 
Property
…… 
(
…… 
e
…… 
=>
……  
e
……! "
.
……" #
Id
……# %
)
……% &
.
……& '
HasColumnName
……' 4
(
……4 5
$str
……5 9
)
……9 :
;
……: ;
entity
   
.
   
Property
   
(
   
e
   
=>
    
e
  ! "
.
  " #
	CreatedAt
  # ,
)
  , -
.
ÀÀ 
HasColumnType
ÀÀ 
(
ÀÀ 
$str
ÀÀ )
)
ÀÀ) *
.
ÃÃ 
HasColumnName
ÃÃ 
(
ÃÃ 
$str
ÃÃ +
)
ÃÃ+ ,
;
ÃÃ, -
entity
ÕÕ 
.
ÕÕ 
Property
ÕÕ 
(
ÕÕ 
e
ÕÕ 
=>
ÕÕ  
e
ÕÕ! "
.
ÕÕ" #
Email
ÕÕ# (
)
ÕÕ( )
.
ÕÕ) *
HasColumnName
ÕÕ* 7
(
ÕÕ7 8
$str
ÕÕ8 ?
)
ÕÕ? @
;
ÕÕ@ A
entity
ŒŒ 
.
ŒŒ 
Property
ŒŒ 
(
ŒŒ 
e
ŒŒ 
=>
ŒŒ  
e
ŒŒ! "
.
ŒŒ" #
IsActive
ŒŒ# +
)
ŒŒ+ ,
.
ŒŒ, -
HasColumnName
ŒŒ- :
(
ŒŒ: ;
$str
ŒŒ; F
)
ŒŒF G
;
ŒŒG H
entity
œœ 
.
œœ 
Property
œœ 
(
œœ 
e
œœ 
=>
œœ  
e
œœ! "
.
œœ" #
PasswordHash
œœ# /
)
œœ/ 0
.
–– 
HasMaxLength
–– 
(
–– 
$num
–– !
)
––! "
.
—— 
HasColumnName
—— 
(
—— 
$str
—— .
)
——. /
;
——/ 0
entity
““ 
.
““ 
Property
““ 
(
““ 
e
““ 
=>
““  
e
““! "
.
““" #
Role
““# '
)
““' (
.
”” 
HasMaxLength
”” 
(
”” 
$num
””  
)
””  !
.
‘‘ 
HasColumnName
‘‘ 
(
‘‘ 
$str
‘‘ %
)
‘‘% &
;
‘‘& '
entity
’’ 
.
’’ 
Property
’’ 
(
’’ 
e
’’ 
=>
’’  
e
’’! "
.
’’" #
	UpdatedAt
’’# ,
)
’’, -
.
÷÷ 
HasColumnType
÷÷ 
(
÷÷ 
$str
÷÷ )
)
÷÷) *
.
◊◊ 
HasColumnName
◊◊ 
(
◊◊ 
$str
◊◊ +
)
◊◊+ ,
;
◊◊, -
entity
ÿÿ 
.
ÿÿ 
Property
ÿÿ 
(
ÿÿ 
e
ÿÿ 
=>
ÿÿ  
e
ÿÿ! "
.
ÿÿ" #
Username
ÿÿ# +
)
ÿÿ+ ,
.
ŸŸ 
HasMaxLength
ŸŸ 
(
ŸŸ 
$num
ŸŸ !
)
ŸŸ! "
.
⁄⁄ 
HasColumnName
⁄⁄ 
(
⁄⁄ 
$str
⁄⁄ )
)
⁄⁄) *
;
⁄⁄* +
}
€€ 	
)
€€	 

;
€€
 $
OnModelCreatingPartial
›› 
(
›› 
modelBuilder
›› +
)
››+ ,
;
››, -
}
ﬁﬁ 
partial
‡‡ 
void
‡‡ $
OnModelCreatingPartial
‡‡ '
(
‡‡' (
ModelBuilder
‡‡( 4
modelBuilder
‡‡5 A
)
‡‡A B
;
‡‡B C
}·· ™
HD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Feedback.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
Feedback 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
	LearnerId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

int 
CourseId 
{ 
get 
; 
set "
;" #
}$ %
public 

int 
? 
ModuleId 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
Message 
{ 
get 
;  
set! $
;$ %
}& '
=( )
null* .
!. /
;/ 0
public 

DateTime 
SubmittedAt 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int 
Rating 
{ 
get 
; 
set  
;  !
}" #
public 

virtual 
Course 
Course  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
!5 6
;6 7
public 

virtual 
User 
Learner 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
public 

virtual 
Module 
? 
Module !
{" #
get$ '
;' (
set) ,
;, -
}. /
} ˇ
JD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Enrollment.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 

Enrollment 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
	LearnerId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

int 
CourseId 
{ 
get 
; 
set "
;" #
}$ %
public 

DateTime 

EnrolledAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

string 
? 
Status 
{ 
get 
;  
set! $
;$ %
}& '
public 

virtual 
Course 
Course  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
!5 6
;6 7
public 

virtual 
User 
Learner 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} í	
HD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Emailotp.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
Emailotp 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

string

 
Email

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
=

& '
null

( ,
!

, -
;

- .
public 

string 
OtpCode 
{ 
get 
;  
set! $
;$ %
}& '
=( )
null* .
!. /
;/ 0
public 

DateTime 

ExpiryTime 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

DateTime 
SentAt 
{ 
get  
;  !
set" %
;% &
}' (
} ˇ
UD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\CourseTakedownRequest.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class !
CourseTakedownRequest *
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
CourseId

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 

int 
RequestedBy 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
Reason 
{ 
get 
;  
set! $
;$ %
}& '
public 

string 
? 
Status 
{ 
get 
;  
set! $
;$ %
}& '
public 

DateTime 
RequestedAt 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
? 
RespondedAt  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

virtual 
Course 
Course  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
!5 6
;6 7
public 

virtual 
User !
RequestedByNavigation -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
=< =
null> B
!B C
;C D
} ï
ND:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\CourseProgress.cs
	namespace 	
Mini_LMS
 
. 
Models 
{ 
public 

partial 
class 
CourseProgress '
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public		 
int		 
	LearnerId		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
int

 
CourseId

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 
decimal 
ProgressPercentage )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
DateTime 
	UpdatedAt !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
virtual 
User 
Learner #
{$ %
get& )
;) *
set+ .
;. /
}0 1
=2 3
null4 8
!8 9
;9 :
public 
virtual 
Course 
Course $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
null5 9
!9 :
;: ;
} 
} »
ND:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\CourseApproval.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
CourseApproval #
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
CourseId

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
public 

int 
RequestedBy 
{ 
get  
;  !
set" %
;% &
}' (
public 

string 
? 
Status 
{ 
get 
;  
set! $
;$ %
}& '
public 

DateTime 
RequestedAt 
{  !
get" %
;% &
set' *
;* +
}, -
public 

DateTime 
? 
RespondedAt  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 

virtual 
Course 
Course  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
!5 6
;6 7
public 

virtual 
User !
RequestedByNavigation -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
=< =
null> B
!B C
;C D
} °
FD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Models\Course.cs
	namespace 	
Mini_LMS
 
. 
Models 
; 
public 
partial 
class 
Course 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public

 

int

 
	TrainerId

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
=% &
null' +
!+ ,
;, -
public 

string 
? 
Type 
{ 
get 
; 
set "
;" #
}$ %
public 

int 
? 
Duration 
{ 
get 
; 
set  #
;# $
}% &
public 

string 
? 

Visibility 
{ 
get  #
;# $
set% (
;( )
}* +
public 

bool 
? 

IsApproved 
{ 
get !
;! "
set# &
;& '
}( )
public 

DateTime 
	CreatedAt 
{ 
get  #
;# $
set% (
;( )
}* +
public 

DateTime 
? 
	UpdatedAt 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 

virtual 
ICollection 
< 
CourseApproval -
>- .
CourseApprovals/ >
{? @
getA D
;D E
setF I
;I J
}K L
=M N
newO R
ListS W
<W X
CourseApprovalX f
>f g
(g h
)h i
;i j
public 

virtual 
ICollection 
< !
CourseTakedownRequest 4
>4 5"
CourseTakedownRequests6 L
{M N
getO R
;R S
setT W
;W X
}Y Z
=[ \
new] `
Lista e
<e f!
CourseTakedownRequestf {
>{ |
(| }
)} ~
;~ 
public 

virtual 
ICollection 
< 

Enrollment )
>) *
Enrollments+ 6
{7 8
get9 <
;< =
set> A
;A B
}C D
=E F
newG J
ListK O
<O P

EnrollmentP Z
>Z [
([ \
)\ ]
;] ^
public   

virtual   
ICollection   
<   
Feedback   '
>  ' (
	Feedbacks  ) 2
{  3 4
get  5 8
;  8 9
set  : =
;  = >
}  ? @
=  A B
new  C F
List  G K
<  K L
Feedback  L T
>  T U
(  U V
)  V W
;  W X
public"" 

virtual"" 
ICollection"" 
<"" 
Module"" %
>""% &
Modules""' .
{""/ 0
get""1 4
;""4 5
set""6 9
;""9 :
}""; <
=""= >
new""? B
List""C G
<""G H
Module""H N
>""N O
(""O P
)""P Q
;""Q R
public$$ 

virtual$$ 
User$$ 
Trainer$$ 
{$$  !
get$$" %
;$$% &
set$$' *
;$$* +
}$$, -
=$$. /
null$$0 4
!$$4 5
;$$5 6
}%% «:
JD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Helpers\JwtHelper.cs
	namespace 	
Mini_LMS
 
. 
Helpers 
{		 
public

 

class

 
	JwtHelper

 
{ 
private 
readonly 
IConfiguration '
_config( /
;/ 0
public 
	JwtHelper 
( 
IConfiguration '
config( .
). /
{ 	
_config 
= 
config 
; 
} 	
public 
string 
GenerateToken #
(# $
string$ *
email+ 0
,0 1
string2 8
role9 =
,= >
int? B
userIdC I
)I J
{ 	
var 
claims 
= 
new 
List !
<! "
Claim" '
>' (
{ 
new 
Claim 
( #
JwtRegisteredClaimNames 1
.1 2
Sub2 5
,5 6
userId7 =
.= >
ToString> F
(F G
)G H
)H I
,I J
new"" 
Claim"" 
("" 

ClaimTypes"" $
.""$ %
Email""% *
,""* +
email"", 1
)""1 2
,""2 3
new## 
Claim## 
(## #
JwtRegisteredClaimNames## 1
.##1 2
Email##2 7
,##7 8
email##9 >
)##> ?
,##? @
new&& 
Claim&& 
(&& 

ClaimTypes&& $
.&&$ %
Role&&% )
,&&) *
role&&+ /
)&&/ 0
,&&0 1
new(( 
Claim(( 
((( 
$str((  
,((  !
role((" &
)((& '
,((' (
new++ 
Claim++ 
(++ 
$str++ "
,++" #
userId++$ *
.++* +
ToString+++ 3
(++3 4
)++4 5
)++5 6
,++6 7
new.. 
Claim.. 
(.. #
JwtRegisteredClaimNames.. 1
...1 2
Jti..2 5
,..5 6
Guid..7 ;
...; <
NewGuid..< C
(..C D
)..D E
...E F
ToString..F N
(..N O
)..O P
)..P Q
}// 
;// 
var11 
key11 
=11 
new11  
SymmetricSecurityKey11 .
(11. /
Encoding22 
.22 
UTF822 
.22 
GetBytes22 &
(22& '
_config22' .
[22. /
$str22/ 8
]228 9
)229 :
)33 
;33 
var55 
creds55 
=55 
new55 
SigningCredentials55 .
(55. /
key55/ 2
,552 3
SecurityAlgorithms554 F
.55F G

HmacSha25655G Q
)55Q R
;55R S
var77 
token77 
=77 
new77 
JwtSecurityToken77 ,
(77, -
issuer88 
:88 
_config88 
[88  
$str88  ,
]88, -
,88- .
audience99 
:99 
_config99 !
[99! "
$str99" 0
]990 1
,991 2
claims:: 
::: 
claims:: 
,:: 
expires;; 
:;; 
DateTime;; !
.;;! "
UtcNow;;" (
.;;( )
AddHours;;) 1
(;;1 2
$num;;2 3
);;3 4
,;;4 5
signingCredentials<< "
:<<" #
creds<<$ )
)== 
;== 
return?? 
new?? #
JwtSecurityTokenHandler?? .
(??. /
)??/ 0
.??0 1

WriteToken??1 ;
(??; <
token??< A
)??A B
;??B C
}@@ 	
publicEE 
stringEE 
GenerateTokenEE #
(EE# $
stringEE$ *
emailEE+ 0
,EE0 1
IEnumerableEE2 =
<EE= >
stringEE> D
>EED E
rolesEEF K
,EEK L
intEEM P
userIdEEQ W
)EEW X
{FF 	
varGG 
claimsGG 
=GG 
newGG 
ListGG !
<GG! "
ClaimGG" '
>GG' (
{HH 
newII 
ClaimII 
(II #
JwtRegisteredClaimNamesII 1
.II1 2
SubII2 5
,II5 6
userIdII7 =
.II= >
ToStringII> F
(IIF G
)IIG H
)IIH I
,III J
newJJ 
ClaimJJ 
(JJ 

ClaimTypesJJ $
.JJ$ %
EmailJJ% *
,JJ* +
emailJJ, 1
)JJ1 2
,JJ2 3
newKK 
ClaimKK 
(KK #
JwtRegisteredClaimNamesKK 1
.KK1 2
EmailKK2 7
,KK7 8
emailKK9 >
)KK> ?
,KK? @
newLL 
ClaimLL 
(LL 
$strLL "
,LL" #
userIdLL$ *
.LL* +
ToStringLL+ 3
(LL3 4
)LL4 5
)LL5 6
,LL6 7
newMM 
ClaimMM 
(MM #
JwtRegisteredClaimNamesMM 1
.MM1 2
JtiMM2 5
,MM5 6
GuidMM7 ;
.MM; <
NewGuidMM< C
(MMC D
)MMD E
.MME F
ToStringMMF N
(MMN O
)MMO P
)MMP Q
}NN 
;NN 
foreachQQ 
(QQ 
varQQ 
rQQ 
inQQ 
rolesQQ #
)QQ# $
{RR 
claimsSS 
.SS 
AddSS 
(SS 
newSS 
ClaimSS $
(SS$ %

ClaimTypesSS% /
.SS/ 0
RoleSS0 4
,SS4 5
rSS6 7
)SS7 8
)SS8 9
;SS9 :
}TT 
varVV 
keyVV 
=VV 
newVV  
SymmetricSecurityKeyVV .
(VV. /
EncodingWW 
.WW 
UTF8WW 
.WW 
GetBytesWW &
(WW& '
_configWW' .
[WW. /
$strWW/ 8
]WW8 9
)WW9 :
)XX 
;XX 
varZZ 
credsZZ 
=ZZ 
newZZ 
SigningCredentialsZZ .
(ZZ. /
keyZZ/ 2
,ZZ2 3
SecurityAlgorithmsZZ4 F
.ZZF G

HmacSha256ZZG Q
)ZZQ R
;ZZR S
var\\ 
token\\ 
=\\ 
new\\ 
JwtSecurityToken\\ ,
(\\, -
issuer]] 
:]] 
_config]] 
[]]  
$str]]  ,
]]], -
,]]- .
audience^^ 
:^^ 
_config^^ !
[^^! "
$str^^" 0
]^^0 1
,^^1 2
claims__ 
:__ 
claims__ 
,__ 
expires`` 
:`` 
DateTime`` !
.``! "
UtcNow``" (
.``( )
AddHours``) 1
(``1 2
$num``2 3
)``3 4
,``4 5
signingCredentialsaa "
:aa" #
credsaa$ )
)bb 
;bb 
returndd 
newdd #
JwtSecurityTokenHandlerdd .
(dd. /
)dd/ 0
.dd0 1

WriteTokendd1 ;
(dd; <
tokendd< A
)ddA B
;ddB C
}ee 	
}ff 
}gg ˝(
BD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\DTOs\DTOs.cs
	namespace 	
Mini_LMS
 
. 
DTOs 
{ 
public 

class 
AdminLoginDto 
{ 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
public		 

class		 
RegisterDto		 
{

 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Role 
{ 
get  
;  !
set" %
;% &
}' (
} 
public 

class 
LoginDto 
{ 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
Role 
{ 
get  
;  !
set" %
;% &
}' (
} 
public 

class #
PasswordResetRequestDto (
{ 
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
} 
public 

class 
PasswordResetDto !
{ 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Token 
{ 
get !
;! "
set# &
;& '
}( )
public   
string   
NewPassword   !
{  " #
get  $ '
;  ' (
set  ) ,
;  , -
}  . /
public!! 
string!! 
ConfirmPassword!! %
{!!& '
get!!( +
;!!+ ,
set!!- 0
;!!0 1
}!!2 3
}"" 
public$$ 

class$$ 
CourseCreateDTO$$  
{%% 
public&& 
int&& 
	TrainerId&& 
{&& 
get&& "
;&&" #
set&&$ '
;&&' (
}&&) *
public'' 
string'' 
Name'' 
{'' 
get''  
;''  !
set''" %
;''% &
}''' (
public(( 
string(( 
?(( 
Type(( 
{(( 
get(( !
;((! "
set((# &
;((& '
}((( )
public)) 
int)) 
?)) 
Duration)) 
{)) 
get)) "
;))" #
set))$ '
;))' (
}))) *
public** 
string** 
?** 

Visibility** !
{**" #
get**$ '
;**' (
set**) ,
;**, -
}**. /
}++ 
public-- 
class-- 
CourseAnalyticsDto-- $
{.. 
public// 
long// 
Id// 
{// 
get// 
;// 
set// !
;//! "
}//# $
public00 
string00 
Name00 
{00 
get00  
;00  !
set00" %
;00% &
}00' (
=00) *
string00+ 1
.001 2
Empty002 7
;007 8
public11 
int11 
LearnerCount11 
{11  !
get11" %
;11% &
set11' *
;11* +
}11, -
public22 
double22 
	AvgRating22 
{22  !
get22" %
;22% &
set22' *
;22* +
}22, -
public33 
double33 
AvgProgress33 !
{33" #
get33$ '
;33' (
set33) ,
;33, -
}33. /
}44 
public66 

class66 
TrainerAnalyticsDto66 $
{77 
public88 
int88 
TotalCourses88 
{88  !
get88" %
;88% &
set88' *
;88* +
}88, -
public99 
int99 
TotalLearners99  
{99! "
get99# &
;99& '
set99( +
;99+ ,
}99- .
public:: 
List:: 
<:: 
CourseAnalyticsDto:: &
>::& '
Courses::( /
{::0 1
get::2 5
;::5 6
set::7 :
;::: ;
}::< =
=::> ?
new::@ C
(::C D
)::D E
;::E F
};; 
}>> µO
SD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\UserController.cs
	namespace 	
Mini_LMS
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public		 

class		 
UsersController		  
:		! "
ControllerBase		# 1
{

 
private 
readonly 
MiniLMSContext '
_db( +
;+ ,
public 
UsersController 
( 
MiniLMSContext -
db. 0
)0 1
{ 	
_db 
= 
db 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetUsers) 1
(1 2
)2 3
{ 	
var 
users 
= 
await 
_db !
.! "
Users" '
. 
Select 
( 
u 
=> 
new  
{ 
u 
. 
Id 
, 
u 
. 
Username 
, 
u 
. 
Email 
, 
u 
. 
Role 
, 
u 
. 
IsActive 
, 
u   
.   
	CreatedAt   
}!! 
)!! 
."" 
ToListAsync"" 
("" 
)"" 
;"" 
return$$ 
Ok$$ 
($$ 
users$$ 
)$$ 
;$$ 
}%% 	
[(( 	
HttpGet((	 
((( 
$str(( 
)(( 
](( 
public)) 
async)) 
Task)) 
<)) 
IActionResult)) '
>))' (
GetUser))) 0
())0 1
int))1 4
id))5 7
)))7 8
{** 	
var++ 
user++ 
=++ 
await++ 
_db++  
.++  !
Users++! &
.,, 
Where,, 
(,, 
u,, 
=>,, 
u,, 
.,, 
Id,,  
==,,! #
id,,$ &
),,& '
.-- 
Select-- 
(-- 
u-- 
=>-- 
new--  
{.. 
u// 
.// 
Id// 
,// 
u00 
.00 
Username00 
,00 
u11 
.11 
Email11 
,11 
u22 
.22 
Role22 
,22 
u33 
.33 
IsActive33 
,33 
u44 
.44 
	CreatedAt44 
}55 
)55 
.66 
FirstOrDefaultAsync66 $
(66$ %
)66% &
;66& '
if88 
(88 
user88 
==88 
null88 
)88 
return99 
NotFound99 
(99  
new99  #
{99$ %
message99& -
=99. /
$str990 @
}99A B
)99B C
;99C D
return;; 
Ok;; 
(;; 
user;; 
);; 
;;; 
}<< 	
[?? 	
HttpPut??	 
(?? 
$str?? 
)?? 
]?? 
public@@ 
async@@ 
Task@@ 
<@@ 
IActionResult@@ '
>@@' (

UpdateUser@@) 3
(@@3 4
intAA 
idAA 
,AA 
[BB 
FromFormBB 
]BB 
stringBB 
usernameBB &
,BB& '
[CC 
FromFormCC 
]CC 
stringCC 
emailCC #
,CC# $
[DD 
FromFormDD 
]DD 
stringDD 
roleDD "
,DD" #
[EE 
FromFormEE 
]EE 
boolEE 
	is_activeEE %
)EE% &
{FF 	
varGG 
existingUserGG 
=GG 
awaitGG $
_dbGG% (
.GG( )
UsersGG) .
.GG. /
	FindAsyncGG/ 8
(GG8 9
idGG9 ;
)GG; <
;GG< =
ifHH 
(HH 
existingUserHH 
==HH 
nullHH  $
)HH$ %
returnII 
NotFoundII 
(II  
newII  #
{II$ %
messageII& -
=II. /
$strII0 @
}IIA B
)IIB C
;IIC D
existingUserKK 
.KK 
UsernameKK !
=KK" #
usernameKK$ ,
;KK, -
existingUserLL 
.LL 
EmailLL 
=LL  
emailLL! &
;LL& '
existingUserMM 
.MM 
RoleMM 
=MM 
roleMM  $
;MM$ %
existingUserNN 
.NN 
IsActiveNN !
=NN" #
	is_activeNN$ -
;NN- .
awaitPP 
_dbPP 
.PP 
SaveChangesAsyncPP &
(PP& '
)PP' (
;PP( )
returnRR 
OkRR 
(RR 
newRR 
{SS 
messageTT 
=TT 
$strTT 5
,TT5 6
userUU 
=UU 
newUU 
{VV 
existingUserWW  
.WW  !
IdWW! #
,WW# $
existingUserXX  
.XX  !
UsernameXX! )
,XX) *
existingUserYY  
.YY  !
EmailYY! &
,YY& '
existingUserZZ  
.ZZ  !
RoleZZ! %
,ZZ% &
existingUser[[  
.[[  !
IsActive[[! )
,[[) *
existingUser\\  
.\\  !
	CreatedAt\\! *
}]] 
}^^ 
)^^ 
;^^ 
}__ 	
[aa 

HttpDeleteaa 
(aa 
$straa 
)aa 
]aa 
publicbb 
asyncbb 
Taskbb 
<bb 
IActionResultbb 
>bb  

DeleteUserbb! +
(bb+ ,
intbb, /
idbb0 2
)bb2 3
{cc 
varee 
useree 
=ee 
awaitee 
_dbee 
.ee 
Usersee 
.ff 	
Includeff	 
(ff 
uff 
=>ff 
uff 
.ff 
Passwordresetsff &
)ff& '
.gg 	
FirstOrDefaultAsyncgg	 
(gg 
ugg 
=>gg !
ugg" #
.gg# $
Idgg$ &
==gg' )
idgg* ,
)gg, -
;gg- .
ifii 
(ii 
userii 
==ii 
nullii 
)ii 
returnjj 
NotFoundjj 
(jj 
newjj 
{jj 
messagejj %
=jj& '
$strjj( 8
}jj9 :
)jj: ;
;jj; <
ifmm 
(mm 
usermm 
.mm 
Passwordresetsmm 
.mm 
Anymm 
(mm  
)mm  !
)mm! "
_dbnn 
.nn 
Passwordresetsnn 
.nn 
RemoveRangenn &
(nn& '
usernn' +
.nn+ ,
Passwordresetsnn, :
)nn: ;
;nn; <
_dbqq 
.qq 
Usersqq 
.qq 
Removeqq 
(qq 
userqq 
)qq 
;qq 
awaitrr 	
_dbrr
 
.rr 
SaveChangesAsyncrr 
(rr 
)rr  
;rr  !
returntt 

Oktt 
(tt 
newtt 
{tt 
messagett 
=tt 
$strtt L
}ttM N
)ttN O
;ttO P
}uu 
[xx 	
	HttpPatchxx	 
(xx 
$strxx  
)xx  !
]xx! "
publicyy 
asyncyy 
Taskyy 
<yy 
IActionResultyy '
>yy' (

ToggleUseryy) 3
(yy3 4
intyy4 7
idyy8 :
)yy: ;
{zz 	
var{{ 
user{{ 
={{ 
await{{ 
_db{{  
.{{  !
Users{{! &
.{{& '
	FindAsync{{' 0
({{0 1
id{{1 3
){{3 4
;{{4 5
if|| 
(|| 
user|| 
==|| 
null|| 
)|| 
return}} 
NotFound}} 
(}}  
new}}  #
{}}$ %
message}}& -
=}}. /
$str}}0 @
}}}A B
)}}B C
;}}C D
user 
. 
IsActive 
= 
! 
user !
.! "
IsActive" *
;* +
await
ÄÄ 
_db
ÄÄ 
.
ÄÄ 
SaveChangesAsync
ÄÄ &
(
ÄÄ& '
)
ÄÄ' (
;
ÄÄ( )
return
ÇÇ 
Ok
ÇÇ 
(
ÇÇ 
new
ÇÇ 
{
ÉÉ 
message
ÑÑ 
=
ÑÑ 
$"
ÑÑ 
$str
ÑÑ 3
{
ÑÑ3 4
(
ÑÑ4 5
(
ÑÑ5 6
bool
ÑÑ6 :
)
ÑÑ: ;
user
ÑÑ; ?
.
ÑÑ? @
IsActive
ÑÑ@ H
?
ÑÑI J
$str
ÑÑK S
:
ÑÑT U
$str
ÑÑV `
)
ÑÑ` a
}
ÑÑa b
"
ÑÑb c
,
ÑÑc d
user
ÖÖ 
=
ÖÖ 
new
ÖÖ 
{
ÜÜ 
user
áá 
.
áá 
Id
áá 
,
áá 
user
àà 
.
àà 
Username
àà !
,
àà! "
user
ââ 
.
ââ 
Email
ââ 
,
ââ 
user
ää 
.
ää 
Role
ää 
,
ää 
user
ãã 
.
ãã 
IsActive
ãã !
,
ãã! "
user
åå 
.
åå 
	CreatedAt
åå "
}
çç 
}
éé 
)
éé 
;
éé 
}
èè 	
}
íí 
}ìì àÜ
WD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\ProgressController.cs
	namespace 	
Mini_LMS
 
. 
Controllers 
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public		 

class		 
ProgressController		 #
:		$ %
ControllerBase		& 4
{

 
private 
readonly 
MiniLMSContext '
_context( 0
;0 1
public 
ProgressController !
(! "
MiniLMSContext" 0
context1 8
)8 9
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
( 
$str $
)$ %
]% &
public 
async 
Task 
< 
IActionResult '
>' (
GetCourseProgress) :
(: ;
int; >
courseId? G
,G H
[I J

FromHeaderJ T
]T U
intV Y
	learnerIdZ c
)c d
{ 	
if 
( 
	learnerId 
<= 
$num 
) 
return  &

BadRequest' 1
(1 2
$str2 F
)F G
;G H
try 
{ 
var 
progressList  
=! "
await# (
_context) 1
.1 2
Moduleprogresses2 B
. 
Include 
( 
p 
=> !
p" #
.# $
Module$ *
)* +
. 
Where 
( 
p 
=> 
p  !
.! "
	LearnerId" +
==, .
	learnerId/ 8
&&9 ;
p< =
.= >
Module> D
.D E
CourseIdE M
==N P
courseIdQ Y
)Y Z
. 
ToListAsync  
(  !
)! "
;" #
if   
(   
!   
progressList   !
.  ! "
Any  " %
(  % &
)  & '
)  ' (
return  ) /
Ok  0 2
(  2 3
new  3 6
{  7 8
Progress  9 A
=  B C
$num  D E
}  F G
)  G H
;  H I
var## 
avgProgress## 
=##  !
progressList##" .
.##. /
Average##/ 6
(##6 7
p##7 8
=>##9 ;
(##< =
double##= C
?##C D
)##D E
p##E F
.##F G
ProgressPercentage##G Y
??##Z \
$num##] ^
)##^ _
;##_ `
return$$ 
Ok$$ 
($$ 
new$$ 
{$$ 
Progress$$  (
=$$) *
avgProgress$$+ 6
}$$7 8
)$$8 9
;$$9 :
}%% 
catch&& 
(&& 
	Exception&& 
ex&& 
)&&  
{'' 
Console(( 
.(( 
	WriteLine(( !
(((! "
ex((" $
)(($ %
;((% &
return)) 

StatusCode)) !
())! "
$num))" %
,))% &
$str))' G
)))G H
;))H I
}** 
}++ 	
[.. 	
HttpGet..	 
(.. 
$str.. %
)..% &
]..& '
public// 
async// 
Task// 
<// 
IActionResult// '
>//' (
GetModulesProgress//) ;
(//; <
int//< ?
courseId//@ H
,//H I
[//J K

FromHeader//K U
]//U V
int//W Z
	learnerId//[ d
)//d e
{00 	
if11 
(11 
	learnerId11 
<=11 
$num11 
)11 
return11  &

BadRequest11' 1
(111 2
$str112 F
)11F G
;11G H
try33 
{44 
var55 
progressList55  
=55! "
await55# (
_context55) 1
.551 2
Moduleprogresses552 B
.66 
Include66 
(66 
p66 
=>66 !
p66" #
.66# $
Module66$ *
)66* +
.77 
Where77 
(77 
p77 
=>77 
p77  !
.77! "
	LearnerId77" +
==77, .
	learnerId77/ 8
&&779 ;
p77< =
.77= >
Module77> D
.77D E
CourseId77E M
==77N P
courseId77Q Y
)77Y Z
.88 
Select88 
(88 
p88 
=>88  
new88! $
{99 
ModuleId::  
=::! "
p::# $
.::$ %
ModuleId::% -
,::- .
ProgressPercentage;; *
=;;+ ,
p;;- .
.;;. /
ProgressPercentage;;/ A
??;;B D
$num;;E F
,;;F G
IsCompleted<< #
=<<$ %
p<<& '
.<<' (
IsCompleted<<( 3
??<<4 6
false<<7 <
}== 
)== 
.>> 
ToListAsync>>  
(>>  !
)>>! "
;>>" #
return@@ 
Ok@@ 
(@@ 
progressList@@ &
)@@& '
;@@' (
}AA 
catchBB 
(BB 
	ExceptionBB 
exBB 
)BB  
{CC 
ConsoleDD 
.DD 
	WriteLineDD !
(DD! "
exDD" $
)DD$ %
;DD% &
returnEE 

StatusCodeEE !
(EE! "
$numEE" %
,EE% &
$strEE' H
)EEH I
;EEI J
}FF 
}GG 	
[JJ 
HttpPostJJ 	
(JJ	 

$strJJ
 
)JJ 
]JJ 
publicKK 
asyncKK 
TaskKK 
<KK 
IActionResultKK 
>KK   
UpdateModuleProgressKK! 5
(KK5 6
[KK6 7
FromBodyKK7 ?
]KK? @
ProgressDtoKKA L
dtoKKM P
)KKP Q
{LL 
ifMM 
(MM 
dtoMM 
.MM 
	LearnerIdMM 
<=MM 
$numMM 
||MM 
dtoMM !
.MM! "
ModuleIdMM" *
<=MM+ -
$numMM. /
||MM0 2
dtoMM3 6
.MM6 7
CourseIdMM7 ?
<=MM@ B
$numMMC D
)MMD E
returnNN 

BadRequestNN 
(NN 
$strNN U
)NNU V
;NNV W
tryPP 
{QQ 
varSS 
moduleSS 
=SS 
awaitSS 
_contextSS #
.SS# $
ModulesSS$ +
.SS+ ,
	FindAsyncSS, 5
(SS5 6
dtoSS6 9
.SS9 :
ModuleIdSS: B
)SSB C
;SSC D
ifTT 

(TT 
moduleTT 
==TT 
nullTT 
)TT 
returnUU 

BadRequestUU 
(UU 
$strUU 0
)UU0 1
;UU1 2
varXX 
courseIdToUseXX 
=XX 
dtoXX 
.XX  
CourseIdXX  (
>XX) *
$numXX+ ,
?XX- .
dtoXX/ 2
.XX2 3
CourseIdXX3 ;
:XX< =
moduleXX> D
.XXD E
CourseIdXXE M
;XXM N
var[[ 
existing[[ 
=[[ 
await[[ 
_context[[ %
.[[% &
Moduleprogresses[[& 6
.\\ 
FirstOrDefaultAsync\\  
(\\  !
p\\! "
=>\\# %
p\\& '
.\\' (
	LearnerId\\( 1
==\\2 4
dto\\5 8
.\\8 9
	LearnerId\\9 B
&&\\C E
p\\F G
.\\G H
ModuleId\\H P
==\\Q S
dto\\T W
.\\W X
ModuleId\\X `
)\\` a
;\\a b
if^^ 

(^^ 
existing^^ 
==^^ 
null^^ 
)^^ 
{__ 	
existing`` 
=`` 
new`` 
Moduleprogress`` )
{aa 
	LearnerIdbb 
=bb 
dtobb 
.bb  
	LearnerIdbb  )
,bb) *
ModuleIdcc 
=cc 
dtocc 
.cc 
ModuleIdcc '
,cc' (
CourseIddd 
=dd 
courseIdToUsedd (
,dd( )
ProgressPercentageee "
=ee# $
dtoee% (
.ee( )
ProgressPercentageee) ;
,ee; <
IsCompletedff 
=ff 
dtoff !
.ff! "
IsCompletedff" -
,ff- .
	UpdatedAtgg 
=gg 
DateTimegg $
.gg$ %
UtcNowgg% +
}hh 
;hh 
_contextii 
.ii 
Moduleprogressesii %
.ii% &
Addii& )
(ii) *
existingii* 2
)ii2 3
;ii3 4
Consolejj 
.jj 
	WriteLinejj 
(jj 
$"jj  
$strjj  ?
{jj? @
dtojj@ C
.jjC D
	LearnerIdjjD M
}jjM N
$strjjN W
{jjW X
dtojjX [
.jj[ \
ModuleIdjj\ d
}jjd e
$strjje n
{jjn o
courseIdToUsejjo |
}jj| }
$str	jj} à
{
jjà â
dto
jjâ å
.
jjå ç 
ProgressPercentage
jjç ü
}
jjü †
$str
jj† °
"
jj° ¢
)
jj¢ £
;
jj£ §
}kk 	
elsell 
{mm 	
existingnn 
.nn 
ProgressPercentagenn '
=nn( )
dtonn* -
.nn- .
ProgressPercentagenn. @
;nn@ A
existingoo 
.oo 
IsCompletedoo  
=oo! "
dtooo# &
.oo& '
IsCompletedoo' 2
;oo2 3
existingpp 
.pp 
CourseIdpp 
=pp 
courseIdToUsepp  -
;pp- .
existingqq 
.qq 
	UpdatedAtqq 
=qq  
DateTimeqq! )
.qq) *
UtcNowqq* 0
;qq0 1
_contextrr 
.rr 
Moduleprogressesrr %
.rr% &
Updaterr& ,
(rr, -
existingrr- 5
)rr5 6
;rr6 7
Consoless 
.ss 
	WriteLiness 
(ss 
$"ss  
$strss  ;
{ss; <
dtoss< ?
.ss? @
	LearnerIdss@ I
}ssI J
$strssJ S
{ssS T
dtossT W
.ssW X
ModuleIdssX `
}ss` a
$strssa j
{ssj k
courseIdToUsessk x
}ssx y
$str	ssy Ñ
{
ssÑ Ö
dto
ssÖ à
.
ssà â 
ProgressPercentage
ssâ õ
}
ssõ ú
$str
ssú ù
"
ssù û
)
ssû ü
;
ssü †
}tt 	
awaitvv 
_contextvv 
.vv 
SaveChangesAsyncvv '
(vv' (
)vv( )
;vv) *
returnww 
Okww 
(ww 
existingww 
)ww 
;ww 
}xx 
catchyy 	
(yy
 
	Exceptionyy 
exyy 
)yy 
{zz 
Console{{ 
.{{ 
	WriteLine{{ 
({{ 
$str{{ 5
+{{6 7
ex{{8 :
){{: ;
;{{; <
return|| 

StatusCode|| 
(|| 
$num|| 
,|| 
$str|| 8
)||8 9
;||9 :
}}} 
}~~ 
[
ÑÑ 	
HttpPost
ÑÑ	 
(
ÑÑ 
$str
ÑÑ 
)
ÑÑ 
]
ÑÑ 
public
ÖÖ 
async
ÖÖ 
Task
ÖÖ 
<
ÖÖ 
IActionResult
ÖÖ '
>
ÖÖ' (
CompleteModule
ÖÖ) 7
(
ÖÖ7 8
[
ÖÖ8 9
FromBody
ÖÖ9 A
]
ÖÖA B
ProgressDto
ÖÖC N
dto
ÖÖO R
)
ÖÖR S
{
ÜÜ 	
if
áá 
(
áá 
dto
áá 
.
áá 
	LearnerId
áá 
<=
áá  
$num
áá! "
||
áá# %
dto
áá& )
.
áá) *
ModuleId
áá* 2
<=
áá3 5
$num
áá6 7
)
áá7 8
return
àà 

BadRequest
àà !
(
àà! "
$str
àà" 0
)
àà0 1
;
àà1 2
try
ää 
{
ãã 
var
åå 
module
åå 
=
åå 
await
åå "
_context
åå# +
.
åå+ ,
Modules
åå, 3
.
åå3 4
	FindAsync
åå4 =
(
åå= >
dto
åå> A
.
ååA B
ModuleId
ååB J
)
ååJ K
;
ååK L
if
çç 
(
çç 
module
çç 
==
çç 
null
çç "
)
çç" #
return
çç$ *

BadRequest
çç+ 5
(
çç5 6
$str
çç6 H
)
ççH I
;
ççI J
var
èè 
existing
èè 
=
èè 
await
èè $
_context
èè% -
.
èè- .
Moduleprogresses
èè. >
.
êê !
FirstOrDefaultAsync
êê (
(
êê( )
p
êê) *
=>
êê+ -
p
êê. /
.
êê/ 0
	LearnerId
êê0 9
==
êê: <
dto
êê= @
.
êê@ A
	LearnerId
êêA J
&&
êêK M
p
êêN O
.
êêO P
ModuleId
êêP X
==
êêY [
dto
êê\ _
.
êê_ `
ModuleId
êê` h
)
êêh i
;
êêi j
if
íí 
(
íí 
existing
íí 
==
íí 
null
íí  $
)
íí$ %
{
ìì 
existing
îî 
=
îî 
new
îî "
Moduleprogress
îî# 1
{
ïï 
	LearnerId
ññ !
=
ññ" #
dto
ññ$ '
.
ññ' (
	LearnerId
ññ( 1
,
ññ1 2
ModuleId
óó  
=
óó! "
dto
óó# &
.
óó& '
ModuleId
óó' /
,
óó/ 0
CourseId
òò  
=
òò! "
module
òò# )
.
òò) *
CourseId
òò* 2
,
òò2 3 
ProgressPercentage
ôô *
=
ôô+ ,
$num
ôô- 0
,
ôô0 1
IsCompleted
öö #
=
öö$ %
true
öö& *
,
öö* +
	UpdatedAt
õõ !
=
õõ" #
DateTime
õõ$ ,
.
õõ, -
UtcNow
õõ- 3
}
úú 
;
úú 
_context
ùù 
.
ùù 
Moduleprogresses
ùù -
.
ùù- .
Add
ùù. 1
(
ùù1 2
existing
ùù2 :
)
ùù: ;
;
ùù; <
}
ûû 
else
üü 
{
†† 
existing
°° 
.
°°  
ProgressPercentage
°° /
=
°°0 1
$num
°°2 5
;
°°5 6
existing
¢¢ 
.
¢¢ 
IsCompleted
¢¢ (
=
¢¢) *
true
¢¢+ /
;
¢¢/ 0
existing
££ 
.
££ 
	UpdatedAt
££ &
=
££' (
DateTime
££) 1
.
££1 2
UtcNow
££2 8
;
££8 9
_context
§§ 
.
§§ 
Moduleprogresses
§§ -
.
§§- .
Update
§§. 4
(
§§4 5
existing
§§5 =
)
§§= >
;
§§> ?
}
•• 
await
ßß 
_context
ßß 
.
ßß 
SaveChangesAsync
ßß /
(
ßß/ 0
)
ßß0 1
;
ßß1 2
return
®® 
Ok
®® 
(
®® 
existing
®® "
)
®®" #
;
®®# $
}
©© 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
´´ 
Console
¨¨ 
.
¨¨ 
	WriteLine
¨¨ !
(
¨¨! "
ex
¨¨" $
)
¨¨$ %
;
¨¨% &
return
≠≠ 

StatusCode
≠≠ !
(
≠≠! "
$num
≠≠" %
,
≠≠% &
$str
≠≠' @
)
≠≠@ A
;
≠≠A B
}
ÆÆ 
}
ØØ 	
}
∞∞ 
public
≤≤ 

class
≤≤ 
ProgressDto
≤≤ 
{
≥≥ 
public
¥¥ 
int
¥¥ 
	LearnerId
¥¥ 
{
¥¥ 
get
¥¥ "
;
¥¥" #
set
¥¥$ '
;
¥¥' (
}
¥¥) *
public
µµ 
int
µµ 
ModuleId
µµ 
{
µµ 
get
µµ !
;
µµ! "
set
µµ# &
;
µµ& '
}
µµ( )
public
∑∑
 
int
∑∑ 
CourseId
∑∑ 
{
∑∑ 
get
∑∑  #
;
∑∑# $
set
∑∑% (
;
∑∑( )
}
∑∑* +
public
∏∏ 
int
∏∏  
ProgressPercentage
∏∏ %
{
∏∏& '
get
∏∏( +
;
∏∏+ ,
set
∏∏- 0
;
∏∏0 1
}
∏∏2 3
public
ππ 
bool
ππ 
IsCompleted
ππ 
{
ππ  !
get
ππ" %
;
ππ% &
set
ππ' *
;
ππ* +
}
ππ, -
}
∫∫ 
}ªª «(
\D:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\NotificationsController.cs
	namespace		 	
Mini_LMS		
 
.		 
Controllers		 
{

 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class #
NotificationsController (
:) *
ControllerBase+ 9
{ 
private 
readonly 
MiniLMSContext '
_db( +
;+ ,
public #
NotificationsController &
(& '
MiniLMSContext' 5
db6 8
)8 9
{ 	
_db 
= 
db 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAll) /
(/ 0
)0 1
{ 	
var 
list 
= 
await 
_db  
.  !
Notifications! .
. 
OrderByDescending "
(" #
n# $
=>% '
n( )
.) *
	CreatedAt* 3
)3 4
. 
ToListAsync 
( 
) 
; 
return 
Ok 
( 
list 
) 
; 
} 	
["" 	
	Authorize""	 
("" 
Roles"" 
="" 
$str"" "
)""" #
]""# $
[## 	
HttpGet##	 
(## 
$str## 
)## 
]## 
public$$ 
async$$ 
Task$$ 
<$$ 
IActionResult$$ '
>$$' (
GetTakedowns$$) 5
($$5 6
)$$6 7
{%% 	
var&& 
list&& 
=&& 
await&& 
_db&&  
.&&  !
Notifications&&! .
.'' 
Where'' 
('' 
n'' 
=>'' 
n'' 
.'' 
Type'' "
==''# %
$str''& 9
)''9 :
.(( 
OrderByDescending(( "
(((" #
n((# $
=>((% '
n((( )
.(() *
	CreatedAt((* 3
)((3 4
.)) 
Select)) 
()) 
n)) 
=>)) 
new))  
{))! "
n** 
.** 
Id** 
,** 
n++ 
.++ 
UserId++ 
,++ 
n,, 
.,, 
Message,, 
,,, 
n-- 
.-- 
	CreatedAt-- 
}.. 
).. 
.// 
ToListAsync// 
(// 
)// 
;// 
return00 
Ok00 
(00 
list00 
)00 
;00 
}11 	
[44 	
	Authorize44	 
(44 
Roles44 
=44 
$str44 "
)44" #
]44# $
[55 	
HttpGet55	 
(55 
$str55 "
)55" #
]55# $
public66 
async66 
Task66 
<66 
IActionResult66 '
>66' (
GetTakedownCount66) 9
(669 :
)66: ;
{77 	
var88 
count88 
=88 
await88 
_db88 !
.88! "
Notifications88" /
.99 

CountAsync99 
(99 
n99 
=>99  
n99! "
.99" #
Type99# '
==99( *
$str99+ >
)99> ?
;99? @
return:: 
Ok:: 
(:: 
new:: 
{:: 
count:: !
}::" #
)::# $
;::$ %
};; 	
[>> 	
	Authorize>>	 
(>> 
Roles>> 
=>> 
$str>> "
)>>" #
]>># $
[?? 	

HttpDelete??	 
(?? 
$str?? 
)?? 
]?? 
public@@ 
async@@ 
Task@@ 
<@@ 
IActionResult@@ '
>@@' (
DeleteNotification@@) ;
(@@; <
int@@< ?
id@@@ B
)@@B C
{AA 	
varBB 
noteBB 
=BB 
awaitBB 
_dbBB  
.BB  !
NotificationsBB! .
.BB. /
	FindAsyncBB/ 8
(BB8 9
idBB9 ;
)BB; <
;BB< =
ifCC 
(CC 
noteCC 
==CC 
nullCC 
)CC 
returnCC $
NotFoundCC% -
(CC- .
)CC. /
;CC/ 0
_dbDD 
.DD 
NotificationsDD 
.DD 
RemoveDD $
(DD$ %
noteDD% )
)DD) *
;DD* +
awaitEE 
_dbEE 
.EE 
SaveChangesAsyncEE &
(EE& '
)EE' (
;EE( )
returnFF 
	NoContentFF 
(FF 
)FF 
;FF 
}GG 	
}HH 
}II ∏∑
UD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\ModuleController.cs
	namespace 	
Mini_LMS
 
. 
Controllers 
{		 
[

 
ApiController

 
]

 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
ModuleController !
:" #
ControllerBase$ 2
{ 
private 
readonly 
MiniLMSContext '
_db( +
;+ ,
private 
readonly 
EmailService %
_email& ,
;, -
private 
readonly 
BlobService $
_blob% *
;* +
public 
ModuleController 
(  
MiniLMSContext  .
db/ 1
,1 2
EmailService3 ?
email@ E
,E F
BlobServiceG R
blobS W
)W X
{ 	
_db 
= 
db 
; 
_email 
= 
email 
; 
_blob 
= 
blob 
; 
} 	
public 
class 
ModuleCreateDto $
{ 	
public 
int 
CourseId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Title 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
public 
string 
? 
Content "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
	IFormFile 
? 
File "
{# $
get% (
;( )
set* -
;- .
}/ 0
}   	
public"" 
class"" 
ModuleUpdateDto"" $
{## 	
public$$ 
string$$ 
Title$$ 
{$$  !
get$$" %
;$$% &
set$$' *
;$$* +
}$$, -
=$$. /
null$$0 4
!$$4 5
;$$5 6
public%% 
string%% 
?%% 
Content%% "
{%%# $
get%%% (
;%%( )
set%%* -
;%%- .
}%%/ 0
public&& 
	IFormFile&& 
?&& 
File&& "
{&&# $
get&&% (
;&&( )
set&&* -
;&&- .
}&&/ 0
}'' 	
private** 
async** 
Task** 
<** 
User** 
?**  
>**  !
GetTrainerAsync**" 1
(**1 2
)**2 3
{++ 	
var,, 
email,, 
=,, 
User,, 
.,, 
Claims,, #
.,,# $
FirstOrDefault,,$ 2
(,,2 3
c,,3 4
=>,,5 7
c,,8 9
.,,9 :
Type,,: >
==,,? A

ClaimTypes,,B L
.,,L M
Email,,M R
),,R S
?,,S T
.,,T U
Value,,U Z
;,,Z [
if-- 
(-- 
email-- 
==-- 
null-- 
)-- 
return-- %
null--& *
;--* +
return.. 
await.. 
_db.. 
... 
Users.. "
..." # 
SingleOrDefaultAsync..# 7
(..7 8
u..8 9
=>..: <
u..= >
...> ?
Email..? D
==..E G
email..H M
&&..N P
u..Q R
...R S
Role..S W
==..X Z
$str..[ d
)..d e
;..e f
}// 	
[22 	
	Authorize22	 
(22 
Roles22 
=22 
$str22 $
)22$ %
]22% &
[33 	
HttpPost33	 
(33 
$str33 
)33 
]33 
public44 
async44 
Task44 
<44 
IActionResult44 '
>44' (
CreateModule44) 5
(445 6
[446 7
FromForm447 ?
]44? @
ModuleCreateDto44A P
dto44Q T
)44T U
{55 	
var66 
trainer66 
=66 
await66 
GetTrainerAsync66  /
(66/ 0
)660 1
;661 2
if77 
(77 
trainer77 
==77 
null77 
)77  
return77! '
Unauthorized77( 4
(774 5
$str775 M
)77M N
;77N O
var99 
course99 
=99 
await99 
_db99 "
.99" #
Courses99# *
.99* +
	FindAsync99+ 4
(994 5
dto995 8
.998 9
CourseId999 A
)99A B
;99B C
if:: 
(:: 
course:: 
==:: 
null:: 
):: 
return::  &
NotFound::' /
(::/ 0
$str::0 B
)::B C
;::C D
if;; 
(;; 
course;; 
.;; 
	TrainerId;;  
!=;;! #
trainer;;$ +
.;;+ ,
Id;;, .
);;. /
return<< 
Unauthorized<< #
(<<# $
$str<<$ R
)<<R S
;<<S T
string>> 
?>> 
fileUrl>> 
=>> 
null>> "
;>>" #
if?? 
(?? 
dto?? 
.?? 
File?? 
!=?? 
null??  
)??  !
{@@ 
fileUrlAA 
=AA 
awaitAA 
_blobAA  %
.AA% &
UploadAsyncAA& 1
(AA1 2
dtoAA2 5
.AA5 6
FileAA6 :
)AA: ;
;AA; <
}BB 
varDD 
moduleDD 
=DD 
newDD 
ModuleDD #
{EE 
CourseIdFF 
=FF 
dtoFF 
.FF 
CourseIdFF '
,FF' (
NameGG 
=GG 
dtoGG 
.GG 
TitleGG  
,GG  !
DescriptionHH 
=HH 
dtoHH !
.HH! "
ContentHH" )
,HH) *
FilePathII 
=II 
fileUrlII "
,II" #
	CreatedAtJJ 
=JJ 
DateTimeJJ $
.JJ$ %
UtcNowJJ% +
,JJ+ ,
	UpdatedAtKK 
=KK 
DateTimeKK $
.KK$ %
UtcNowKK% +
}LL 
;LL 
_dbNN 
.NN 
ModulesNN 
.NN 
AddNN 
(NN 
moduleNN "
)NN" #
;NN# $
awaitOO 
_dbOO 
.OO 
SaveChangesAsyncOO &
(OO& '
)OO' (
;OO( )
varRR 
enrolledLearnersRR  
=RR! "
awaitRR# (
_dbRR) ,
.RR, -
EnrollmentsRR- 8
.SS 
WhereSS 
(SS 
eSS 
=>SS 
eSS 
.SS 
CourseIdSS &
==SS' )
dtoSS* -
.SS- .
CourseIdSS. 6
)SS6 7
.TT 
SelectTT 
(TT 
eTT 
=>TT 
eTT 
.TT 
	LearnerIdTT (
)TT( )
.UU 
ToListAsyncUU 
(UU 
)UU 
;UU 
foreachWW 
(WW 
varWW 
	learnerIdWW "
inWW# %
enrolledLearnersWW& 6
)WW6 7
{XX 
_dbYY 
.YY 
ModuleprogressesYY $
.YY$ %
AddYY% (
(YY( )
newYY) ,
ModuleprogressYY- ;
{ZZ 
	LearnerId[[ 
=[[ 
	learnerId[[  )
,[[) *
ModuleId\\ 
=\\ 
module\\ %
.\\% &
Id\\& (
,\\( )
ProgressPercentage]] &
=]]' (
$num]]) *
,]]* +
IsCompleted^^ 
=^^  !
false^^" '
,^^' (
	UpdatedAt__ 
=__ 
DateTime__  (
.__( )
UtcNow__) /
}`` 
)`` 
;`` 
}aa 
awaitbb 
_dbbb 
.bb 
SaveChangesAsyncbb &
(bb& '
)bb' (
;bb( )
awaitdd 
NotifyTrainerAsyncdd $
(dd$ %
trainerdd% ,
,dd, -
$"dd. 0
$strdd0 8
{dd8 9
moduledd9 ?
.dd? @
Namedd@ D
}ddD E
$strddE X
{ddX Y
courseddY _
.dd_ `
Namedd` d
}ddd e
$strdde g
"ddg h
)ddh i
;ddi j
returnff 
CreatedAtActionff "
(ff" #
nameofff# )
(ff) *
	GetModuleff* 3
)ff3 4
,ff4 5
newff6 9
{ff: ;
idff< >
=ff? @
moduleffA G
.ffG H
IdffH J
}ffK L
,ffL M
moduleffN T
)ffT U
;ffU V
}gg 	
[jj 	
	Authorizejj	 
(jj 
Rolesjj 
=jj 
$strjj $
)jj$ %
]jj% &
[kk 	
HttpPutkk	 
(kk 
$strkk 
)kk 
]kk 
publicll 
asyncll 
Taskll 
<ll 
IActionResultll '
>ll' (
UpdateModulell) 5
(ll5 6
intll6 9
idll: <
,ll< =
[ll> ?
FromFormll? G
]llG H
ModuleUpdateDtollI X
dtollY \
)ll\ ]
{mm 	
varnn 
trainernn 
=nn 
awaitnn 
GetTrainerAsyncnn  /
(nn/ 0
)nn0 1
;nn1 2
ifoo 
(oo 
traineroo 
==oo 
nulloo 
)oo  
returnoo! '
Unauthorizedoo( 4
(oo4 5
$stroo5 M
)ooM N
;ooN O
varqq 
moduleqq 
=qq 
awaitqq 
_dbqq "
.qq" #
Modulesqq# *
.qq* +
	FindAsyncqq+ 4
(qq4 5
idqq5 7
)qq7 8
;qq8 9
ifrr 
(rr 
modulerr 
==rr 
nullrr 
)rr 
returnrr  &
NotFoundrr' /
(rr/ 0
$strrr0 B
)rrB C
;rrC D
vartt 
coursett 
=tt 
awaittt 
_dbtt "
.tt" #
Coursestt# *
.tt* +
	FindAsynctt+ 4
(tt4 5
modulett5 ;
.tt; <
CourseIdtt< D
)ttD E
;ttE F
ifuu 
(uu 
courseuu 
==uu 
nulluu 
||uu !
courseuu" (
.uu( )
	TrainerIduu) 2
!=uu3 5
traineruu6 =
.uu= >
Iduu> @
)uu@ A
returnvv 
Unauthorizedvv #
(vv# $
$strvv$ U
)vvU V
;vvV W
modulexx 
.xx 
Namexx 
=xx 
dtoxx 
.xx 
Titlexx #
;xx# $
moduleyy 
.yy 
Descriptionyy 
=yy  
dtoyy! $
.yy$ %
Contentyy% ,
;yy, -
if{{ 
({{ 
dto{{ 
.{{ 
File{{ 
!={{ 
null{{  
){{  !
{|| 
module}} 
.}} 
FilePath}} 
=}}  !
await}}" '
_blob}}( -
.}}- .
UploadAsync}}. 9
(}}9 :
dto}}: =
.}}= >
File}}> B
)}}B C
;}}C D
}~~ 
module
ÄÄ 
.
ÄÄ 
	UpdatedAt
ÄÄ 
=
ÄÄ 
DateTime
ÄÄ '
.
ÄÄ' (
UtcNow
ÄÄ( .
;
ÄÄ. /
await
ÅÅ 
_db
ÅÅ 
.
ÅÅ 
SaveChangesAsync
ÅÅ &
(
ÅÅ& '
)
ÅÅ' (
;
ÅÅ( )
var
ÑÑ 
moduleProgresses
ÑÑ  
=
ÑÑ! "
await
ÑÑ# (
_db
ÑÑ) ,
.
ÑÑ, -
Moduleprogresses
ÑÑ- =
.
ÑÑ= >
Where
ÑÑ> C
(
ÑÑC D
p
ÑÑD E
=>
ÑÑF H
p
ÑÑI J
.
ÑÑJ K
ModuleId
ÑÑK S
==
ÑÑT V
module
ÑÑW ]
.
ÑÑ] ^
Id
ÑÑ^ `
)
ÑÑ` a
.
ÑÑa b
ToListAsync
ÑÑb m
(
ÑÑm n
)
ÑÑn o
;
ÑÑo p
foreach
ÖÖ 
(
ÖÖ 
var
ÖÖ 
mp
ÖÖ 
in
ÖÖ 
moduleProgresses
ÖÖ /
)
ÖÖ/ 0
{
ÜÜ 
mp
áá 
.
áá  
ProgressPercentage
áá %
=
áá& '
$num
áá( )
;
áá) *
mp
àà 
.
àà 
IsCompleted
àà 
=
àà  
false
àà! &
;
àà& '
mp
ââ 
.
ââ 
	UpdatedAt
ââ 
=
ââ 
DateTime
ââ '
.
ââ' (
UtcNow
ââ( .
;
ââ. /
}
ää 
await
ãã 
_db
ãã 
.
ãã 
SaveChangesAsync
ãã &
(
ãã& '
)
ãã' (
;
ãã( )
await
çç  
NotifyTrainerAsync
çç $
(
çç$ %
trainer
çç% ,
,
çç, -
$"
çç. 0
$str
çç0 8
{
çç8 9
module
çç9 ?
.
çç? @
Name
çç@ D
}
ççD E
$str
ççE Z
{
ççZ [
course
çç[ a
.
çça b
Name
ççb f
}
ççf g
$str
ççg i
"
ççi j
)
ççj k
;
ççk l
return
èè 
Ok
èè 
(
èè 
module
èè 
)
èè 
;
èè 
}
êê 	
[
ìì 	
	Authorize
ìì	 
(
ìì 
Roles
ìì 
=
ìì 
$str
ìì $
)
ìì$ %
]
ìì% &
[
îî 	

HttpDelete
îî	 
(
îî 
$str
îî 
)
îî 
]
îî 
public
ïï 
async
ïï 
Task
ïï 
<
ïï 
IActionResult
ïï '
>
ïï' (
DeleteModule
ïï) 5
(
ïï5 6
int
ïï6 9
id
ïï: <
)
ïï< =
{
ññ 	
var
óó 
trainer
óó 
=
óó 
await
óó 
GetTrainerAsync
óó  /
(
óó/ 0
)
óó0 1
;
óó1 2
if
òò 
(
òò 
trainer
òò 
==
òò 
null
òò 
)
òò  
return
òò! '
Unauthorized
òò( 4
(
òò4 5
$str
òò5 M
)
òòM N
;
òòN O
var
öö 
module
öö 
=
öö 
await
öö 
_db
öö "
.
öö" #
Modules
öö# *
.
öö* +
	FindAsync
öö+ 4
(
öö4 5
id
öö5 7
)
öö7 8
;
öö8 9
if
õõ 
(
õõ 
module
õõ 
==
õõ 
null
õõ 
)
õõ 
return
õõ  &
NotFound
õõ' /
(
õõ/ 0
$str
õõ0 B
)
õõB C
;
õõC D
var
ùù 
course
ùù 
=
ùù 
await
ùù 
_db
ùù "
.
ùù" #
Courses
ùù# *
.
ùù* +
	FindAsync
ùù+ 4
(
ùù4 5
module
ùù5 ;
.
ùù; <
CourseId
ùù< D
)
ùùD E
;
ùùE F
if
ûû 
(
ûû 
course
ûû 
==
ûû 
null
ûû 
||
ûû !
course
ûû" (
.
ûû( )
	TrainerId
ûû) 2
!=
ûû3 5
trainer
ûû6 =
.
ûû= >
Id
ûû> @
)
ûû@ A
return
üü 
Unauthorized
üü #
(
üü# $
$str
üü$ U
)
üüU V
;
üüV W
var
¢¢ 

progresses
¢¢ 
=
¢¢ 
await
¢¢ "
_db
¢¢# &
.
¢¢& '
Moduleprogresses
¢¢' 7
.
¢¢7 8
Where
¢¢8 =
(
¢¢= >
p
¢¢> ?
=>
¢¢@ B
p
¢¢C D
.
¢¢D E
ModuleId
¢¢E M
==
¢¢N P
module
¢¢Q W
.
¢¢W X
Id
¢¢X Z
)
¢¢Z [
.
¢¢[ \
ToListAsync
¢¢\ g
(
¢¢g h
)
¢¢h i
;
¢¢i j
_db
££ 
.
££ 
Moduleprogresses
££  
.
££  !
RemoveRange
££! ,
(
££, -

progresses
££- 7
)
££7 8
;
££8 9
_db
•• 
.
•• 
Modules
•• 
.
•• 
Remove
•• 
(
•• 
module
•• %
)
••% &
;
••& '
await
¶¶ 
_db
¶¶ 
.
¶¶ 
SaveChangesAsync
¶¶ &
(
¶¶& '
)
¶¶' (
;
¶¶( )
await
®®  
NotifyTrainerAsync
®® $
(
®®$ %
trainer
®®% ,
,
®®, -
$"
®®. 0
$str
®®0 8
{
®®8 9
module
®®9 ?
.
®®? @
Name
®®@ D
}
®®D E
$str
®®E \
{
®®\ ]
course
®®] c
.
®®c d
Name
®®d h
}
®®h i
$str
®®i k
"
®®k l
)
®®l m
;
®®m n
return
™™ 
	NoContent
™™ 
(
™™ 
)
™™ 
;
™™ 
}
´´ 	
[
ÆÆ 	
	Authorize
ÆÆ	 
]
ÆÆ 
[
ØØ 	
HttpGet
ØØ	 
(
ØØ 
$str
ØØ 
)
ØØ 
]
ØØ 
public
∞∞ 
async
∞∞ 
Task
∞∞ 
<
∞∞ 
IActionResult
∞∞ '
>
∞∞' (
	GetModule
∞∞) 2
(
∞∞2 3
int
∞∞3 6
id
∞∞7 9
)
∞∞9 :
{
±± 	
var
≤≤ 
module
≤≤ 
=
≤≤ 
await
≤≤ 
_db
≤≤ "
.
≤≤" #
Modules
≤≤# *
.
≥≥ 
Include
≥≥ 
(
≥≥ 
m
≥≥ 
=>
≥≥ 
m
≥≥ 
.
≥≥  
Course
≥≥  &
)
≥≥& '
.
¥¥ !
FirstOrDefaultAsync
¥¥ $
(
¥¥$ %
m
¥¥% &
=>
¥¥' )
m
¥¥* +
.
¥¥+ ,
Id
¥¥, .
==
¥¥/ 1
id
¥¥2 4
)
¥¥4 5
;
¥¥5 6
if
µµ 
(
µµ 
module
µµ 
==
µµ 
null
µµ 
)
µµ 
return
µµ  &
NotFound
µµ' /
(
µµ/ 0
)
µµ0 1
;
µµ1 2
return
∂∂ 
Ok
∂∂ 
(
∂∂ 
module
∂∂ 
)
∂∂ 
;
∂∂ 
}
∑∑ 	
[
∫∫ 	
	Authorize
∫∫	 
]
∫∫ 
[
ªª 	
HttpGet
ªª	 
(
ªª 
$str
ªª $
)
ªª$ %
]
ªª% &
public
ºº 
async
ºº 
Task
ºº 
<
ºº 
IActionResult
ºº '
>
ºº' ( 
GetModulesByCourse
ºº) ;
(
ºº; <
int
ºº< ?
courseId
ºº@ H
,
ººH I
[
ººJ K

FromHeader
ººK U
]
ººU V
int
ººW Z
	learnerId
ºº[ d
)
ººd e
{
ΩΩ 	
var
ææ 
modules
ææ 
=
ææ 
await
ææ 
_db
ææ  #
.
ææ# $
Modules
ææ$ +
.
øø 
Where
øø 
(
øø 
m
øø 
=>
øø 
m
øø 
.
øø 
CourseId
øø &
==
øø' )
courseId
øø* 2
)
øø2 3
.
¿¿ 
ToListAsync
¿¿ 
(
¿¿ 
)
¿¿ 
;
¿¿ 
var
√√ 

progresses
√√ 
=
√√ 
await
√√ "
_db
√√# &
.
√√& '
Moduleprogresses
√√' 7
.
ƒƒ 
Where
ƒƒ 
(
ƒƒ 
p
ƒƒ 
=>
ƒƒ 
p
ƒƒ 
.
ƒƒ 
	LearnerId
ƒƒ '
==
ƒƒ( *
	learnerId
ƒƒ+ 4
&&
ƒƒ5 7
modules
ƒƒ8 ?
.
ƒƒ? @
Select
ƒƒ@ F
(
ƒƒF G
m
ƒƒG H
=>
ƒƒI K
m
ƒƒL M
.
ƒƒM N
Id
ƒƒN P
)
ƒƒP Q
.
ƒƒQ R
Contains
ƒƒR Z
(
ƒƒZ [
p
ƒƒ[ \
.
ƒƒ\ ]
ModuleId
ƒƒ] e
)
ƒƒe f
)
ƒƒf g
.
≈≈ 
ToListAsync
≈≈ 
(
≈≈ 
)
≈≈ 
;
≈≈ 
var
«« 
result
«« 
=
«« 
modules
««  
.
««  !
Select
««! '
(
««' (
m
««( )
=>
««* ,
{
»» 
var
…… 
p
…… 
=
…… 

progresses
…… "
.
……" #
FirstOrDefault
……# 1
(
……1 2
x
……2 3
=>
……4 6
x
……7 8
.
……8 9
ModuleId
……9 A
==
……B D
m
……E F
.
……F G
Id
……G I
)
……I J
;
……J K
return
   
new
   
{
ÀÀ 
m
ÃÃ 
.
ÃÃ 
Id
ÃÃ 
,
ÃÃ 
m
ÕÕ 
.
ÕÕ 
CourseId
ÕÕ 
,
ÕÕ 
m
ŒŒ 
.
ŒŒ 
Name
ŒŒ 
,
ŒŒ 
m
œœ 
.
œœ 
Description
œœ !
,
œœ! "
m
–– 
.
–– 
FilePath
–– 
,
––  
ProgressPercentage
—— &
=
——' (
p
——) *
?
——* +
.
——+ , 
ProgressPercentage
——, >
??
——? A
$num
——B C
,
——C D
IsCompleted
““ 
=
““  !
p
““" #
?
““# $
.
““$ %
IsCompleted
““% 0
??
““1 3
false
““4 9
}
”” 
;
”” 
}
‘‘ 
)
‘‘ 
;
‘‘ 
return
÷÷ 
Ok
÷÷ 
(
÷÷ 
result
÷÷ 
)
÷÷ 
;
÷÷ 
}
◊◊ 	
private
⁄⁄ 
async
⁄⁄ 
Task
⁄⁄  
NotifyTrainerAsync
⁄⁄ -
(
⁄⁄- .
User
⁄⁄. 2
trainer
⁄⁄3 :
,
⁄⁄: ;
string
⁄⁄< B
message
⁄⁄C J
)
⁄⁄J K
{
€€ 	
_db
‹‹ 
.
‹‹ 
Notifications
‹‹ 
.
‹‹ 
Add
‹‹ !
(
‹‹! "
new
‹‹" %
Notification
‹‹& 2
{
›› 
UserId
ﬁﬁ 
=
ﬁﬁ 
trainer
ﬁﬁ  
.
ﬁﬁ  !
Id
ﬁﬁ! #
,
ﬁﬁ# $
Type
ﬂﬂ 
=
ﬂﬂ 
$str
ﬂﬂ %
,
ﬂﬂ% &
Message
‡‡ 
=
‡‡ 
message
‡‡ !
,
‡‡! "
IsRead
·· 
=
·· 
false
·· 
,
·· 
	CreatedAt
‚‚ 
=
‚‚ 
DateTime
‚‚ $
.
‚‚$ %
UtcNow
‚‚% +
}
„„ 
)
„„ 
;
„„ 
await
ÂÂ 
_email
ÂÂ 
.
ÂÂ (
SendCourseUpdateEmailAsync
ÂÂ 3
(
ÂÂ3 4
trainer
ÂÂ4 ;
.
ÂÂ; <
Email
ÂÂ< A
,
ÂÂA B
message
ÂÂC J
)
ÂÂJ K
;
ÂÂK L
await
ÊÊ 
_db
ÊÊ 
.
ÊÊ 
SaveChangesAsync
ÊÊ &
(
ÊÊ& '
)
ÊÊ' (
;
ÊÊ( )
}
ÁÁ 	
}
ËË 
}ÈÈ Ù,
TD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\LoginController.cs
[ 
ApiController 
] 
[		 
Route		 
(		 
$str		 
)		 
]		 
public

 
class

 
AuthController

 
:

 
ControllerBase

 ,
{ 
private 
readonly 
IConfiguration #
_config$ +
;+ ,
private 
readonly 
MiniLMSContext #
_db$ '
;' (
public 

AuthController 
( 
IConfiguration (
config) /
,/ 0
MiniLMSContext1 ?
db@ B
)B C
{ 
_config 
= 
config 
; 
_db 
= 
db 
; 
} 
[ 
HttpPost 
( 
$str 
) 
] 
public 

IActionResult 
Login 
( 
[ 	
FromForm	 
] 
string 
email 
,  
[ 	
FromForm	 
] 
string 
password "
," #
[ 	
FromForm	 
] 
string 
role 
) 
{ 
var 
user 
= 
_db 
. 
Users 
. 
FirstOrDefault 
( 
u 
=>  
u! "
." #
Email# (
==) +
email, 1
&&2 4
u5 6
.6 7
Role7 ;
==< >
role? C
)C D
;D E
if 

( 
user 
== 
null 
|| 
! 
BCrypt #
.# $
Net$ '
.' (
BCrypt( .
.. /
Verify/ 5
(5 6
password6 >
,> ?
user@ D
.D E
PasswordHashE Q
)Q R
)R S
return   
Unauthorized   
(    
new    #
{  $ %
message  & -
=  . /
$str  0 E
}  F G
)  G H
;  H I
var## 

jwtSection## 
=## 
_config##  
.##  !

GetSection##! +
(##+ ,
$str##, 1
)##1 2
;##2 3
var$$ 
issuer$$ 
=$$ 

jwtSection$$ 
[$$  
$str$$  (
]$$( )
;$$) *
var%% 
audience%% 
=%% 

jwtSection%% !
[%%! "
$str%%" ,
]%%, -
;%%- .
var&& 
secret&& 
=&& 

jwtSection&& 
[&&  
$str&&  %
]&&% &
;&&& '
var)) 
keyBytes)) 
=)) 
Encoding)) 
.))  
UTF8))  $
.))$ %
GetBytes))% -
())- .
secret)). 4
)))4 5
;))5 6
var,, 
creds,, 
=,, 
new,, 
SigningCredentials,, *
(,,* +
new--  
SymmetricSecurityKey-- $
(--$ %
keyBytes--% -
)--- .
,--. /
SecurityAlgorithms.. 
... 
HmacSha256Signature.. 2
)// 	
;//	 

var22 
token22 
=22 
new22 
JwtSecurityToken22 (
(22( )
issuer33 
:33 
issuer33 
,33 
audience44 
:44 
audience44 
,44 
claims55 
:55 
new55 
[55 
]55 
{66 
new77 
Claim77 
(77 
$str77 %
,77% &
user77' +
.77+ ,
Username77, 4
)774 5
,775 6
new88 
Claim88 
(88 

ClaimTypes88 
.88 
Name88 !
,88! "
user88# '
.88' (
Username88( 0
)880 1
,881 2
new99 
Claim99 
(99 

ClaimTypes99 
.99 
Role99 !
,99! "
user99# '
.99' (
Role99( ,
)99, -
,99- .
new:: 
Claim:: 
(:: 
$str:: 
,:: 
user:: 
.::  
Email::  %
)::% &
,::& '
new;; 
Claim;; 
(;; 
$str;; 
,;; 
user;;  
.;;  !
Id;;! #
.;;# $
ToString;;$ ,
(;;, -
);;- .
);;. /
}<< 
,<< 
expires== 
:== 
DateTime== 
.== 
UtcNow== $
.==$ %
AddHours==% -
(==- .
$num==. /
)==/ 0
,==0 1
signingCredentials>> 
:>> 
creds>>  %
)?? 	
;??	 

varBB 
tokenStringBB 
=BB 
newBB #
JwtSecurityTokenHandlerBB 5
(BB5 6
)BB6 7
.BB7 8

WriteTokenBB8 B
(BBB C
tokenBBC H
)BBH I
;BBI J
returnCC 
OkCC 
(CC 
newCC 
{CC 
tokenCC 
=CC 
tokenStringCC  +
,CC+ ,
roleCC- 1
=CC2 3
userCC4 8
.CC8 9
RoleCC9 =
}CC> ?
)CC? @
;CC@ A
}DD 
}EE X
VD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\LearnerController.cs®
SD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\HomeController.cs
	namespace 	
Mini_LMS
 
. 
Controllers 
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
HomeController 
:  !
ControllerBase" 0
{ 
[

 	
HttpGet

	 
]

 
public 
IActionResult 
Get  
(  !
)! "
{ 	
var 
response 
= 
new 
{ 
message 
= 
$str G
} 
; 
return 
Ok 
( 
response 
) 
;  
} 	
} 
} ˘_
WD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\FeedbackController.cs
	namespace		 	
Mini_LMS		
 
.		 
Controllers		 
{

 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
FeedbacksController $
:% &
ControllerBase' 5
{ 
private 
readonly 
MiniLMSContext '
_db( +
;+ ,
private 
readonly 
EmailService %
_email& ,
;, -
public 
FeedbacksController "
(" #
MiniLMSContext# 1
db2 4
,4 5
EmailService6 B
emailC H
)H I
{ 	
_db 
= 
db 
; 
_email 
= 
email 
; 
} 	
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
Create) /
(/ 0
[0 1
FromForm1 9
]9 :!
FeedbackCreateRequest; P
reqQ T
)T U
{ 	
if 
( 
! 
await 
_db 
. 
Users  
.  !
AnyAsync! )
() *
u* +
=>, .
u/ 0
.0 1
Id1 3
==4 6
req7 :
.: ;
	LearnerId; D
&&E G
uH I
.I J
RoleJ N
==O Q
$strR [
)[ \
)\ ]
return 

BadRequest !
(! "
new" %
{& '
message( /
=0 1
$str2 E
}F G
)G H
;H I
var 
course 
= 
await 
_db "
." #
Courses# *
.* +
	FindAsync+ 4
(4 5
req5 8
.8 9
CourseId9 A
)A B
;B C
if   
(   
course   
==   
null   
)   
return!! 

BadRequest!! !
(!!! "
new!!" %
{!!& '
message!!( /
=!!0 1
$str!!2 D
}!!E F
)!!F G
;!!G H
var## 
feedback## 
=## 
new## 
Feedback## '
{$$ 
	LearnerId%% 
=%% 
(%% 
int%%  
)%%  !
req%%! $
.%%$ %
	LearnerId%%% .
,%%. /
CourseId&& 
=&& 
req&& 
.&& 
CourseId&& '
,&&' (
Message'' 
='' 
req'' 
.'' 
Message'' %
,''% &
Rating(( 
=(( 
req(( 
.(( 
Rating(( #
??(($ &
$num((' (
,((( )
SubmittedAt)) 
=)) 
DateTime)) &
.))& '
UtcNow))' -
}** 
;** 
_db,, 
.,, 
	Feedbacks,, 
.,, 
Add,, 
(,, 
feedback,, &
),,& '
;,,' (
await-- 
_db-- 
.-- 
SaveChangesAsync-- &
(--& '
)--' (
;--( )
var00 
trainer00 
=00 
await00 
_db00  #
.00# $
Users00$ )
.00) *
	FindAsync00* 3
(003 4
course004 :
.00: ;
	TrainerId00; D
)00D E
;00E F
if11 
(11 
trainer11 
!=11 
null11 
)11  
{22 
_db33 
.33 
Notifications33 !
.33! "
Add33" %
(33% &
new33& )
Notification33* 6
{44 
UserId55 
=55 
trainer55 $
.55$ %
Id55% '
,55' (
Type66 
=66 
$str66 -
,66- .
Message77 
=77 
$"77  
$str77  1
{771 2
course772 8
.778 9
Name779 =
}77= >
$str77> C
{77C D
feedback77D L
.77L M
Message77M T
}77T U
$str77U a
{77a b
feedback77b j
.77j k
Rating77k q
}77q r
$str77r s
"77s t
,77t u
IsRead88 
=88 
false88 "
,88" #
	CreatedAt99 
=99 
DateTime99  (
.99( )
UtcNow99) /
}:: 
):: 
;:: 
await<< 
_db<< 
.<< 
SaveChangesAsync<< *
(<<* +
)<<+ ,
;<<, -
await>> 
_email>> 
.>> .
"SendFeedbackNotificationEmailAsync>> ?
(>>? @
trainer?? 
.?? 
Email?? !
,??! "
learnerName@@ 
:@@  
(@@! "
await@@" '
_db@@( +
.@@+ ,
Users@@, 1
.@@1 2
	FindAsync@@2 ;
(@@; <
req@@< ?
.@@? @
	LearnerId@@@ I
)@@I J
)@@J K
!@@K L
.@@L M
Email@@M R
,@@R S

courseNameAA 
:AA 
courseAA  &
.AA& '
NameAA' +
)BB 
;BB 
}CC 
returnEE 
CreatedAtActionEE "
(EE" #
nameofEE# )
(EE) *
GetByCourseEE* 5
)EE5 6
,EE6 7
newEE8 ;
{EE< =
courseIdEE> F
=EEG H
reqEEI L
.EEL M
CourseIdEEM U
}EEV W
,EEW X
feedbackEEY a
)EEa b
;EEb c
}FF 	
[II 	
HttpGetII	 
(II 
$strII $
)II$ %
]II% &
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ '
>JJ' (
GetByCourseJJ) 4
(JJ4 5
intJJ5 8
courseIdJJ9 A
)JJA B
{KK 	
varLL 
listLL 
=LL 
awaitLL 
_dbLL  
.LL  !
	FeedbacksLL! *
.MM 
WhereMM 
(MM 
fMM 
=>MM 
fMM 
.MM 
CourseIdMM &
==MM' )
courseIdMM* 2
)MM2 3
.NN 
IncludeNN 
(NN 
fNN 
=>NN 
fNN 
.NN  
LearnerNN  '
)NN' (
.OO 
ToListAsyncOO 
(OO 
)OO 
;OO 
returnPP 
OkPP 
(PP 
listPP 
)PP 
;PP 
}QQ 	
[TT 	
HttpGetTT	 
(TT 
$strTT 
)TT 
]TT 
publicUU 
asyncUU 
TaskUU 
<UU 
IActionResultUU '
>UU' (
GetByIdUU) 0
(UU0 1
intUU1 4
idUU5 7
)UU7 8
{VV 	
varWW 
feedbackWW 
=WW 
awaitWW  
_dbWW! $
.WW$ %
	FeedbacksWW% .
.XX 
IncludeXX 
(XX 
fXX 
=>XX 
fXX 
.XX  
LearnerXX  '
)XX' (
.YY 
IncludeYY 
(YY 
fYY 
=>YY 
fYY 
.YY  
CourseYY  &
)YY& '
.ZZ 
FirstOrDefaultAsyncZZ $
(ZZ$ %
fZZ% &
=>ZZ' )
fZZ* +
.ZZ+ ,
IdZZ, .
==ZZ/ 1
idZZ2 4
)ZZ4 5
;ZZ5 6
if\\ 
(\\ 
feedback\\ 
==\\ 
null\\  
)\\  !
return\\" (
NotFound\\) 1
(\\1 2
)\\2 3
;\\3 4
return]] 
Ok]] 
(]] 
feedback]] 
)]] 
;]]  
}^^ 	
[aa 	
HttpPutaa	 
(aa 
$straa 
)aa 
]aa 
publicbb 
asyncbb 
Taskbb 
<bb 
IActionResultbb '
>bb' (
Updatebb) /
(bb/ 0
intbb0 3
idbb4 6
,bb6 7
[bb8 9
FromFormbb9 A
]bbA B!
FeedbackUpdateRequestbbC X
reqbbY \
)bb\ ]
{cc 	
vardd 
feedbackdd 
=dd 
awaitdd  
_dbdd! $
.dd$ %
	Feedbacksdd% .
.dd. /
	FindAsyncdd/ 8
(dd8 9
iddd9 ;
)dd; <
;dd< =
ifee 
(ee 
feedbackee 
==ee 
nullee  
)ee  !
returnee" (
NotFoundee) 1
(ee1 2
)ee2 3
;ee3 4
feedbackgg 
.gg 
Messagegg 
=gg 
reqgg "
.gg" #
Messagegg# *
??gg+ -
feedbackgg. 6
.gg6 7
Messagegg7 >
;gg> ?
feedbackhh 
.hh 
Ratinghh 
=hh 
reqhh !
.hh! "
Ratinghh" (
??hh) +
feedbackhh, 4
.hh4 5
Ratinghh5 ;
;hh; <
awaitjj 
_dbjj 
.jj 
SaveChangesAsyncjj &
(jj& '
)jj' (
;jj( )
returnkk 
Okkk 
(kk 
feedbackkk 
)kk 
;kk  
}ll 	
[oo 	

HttpDeleteoo	 
(oo 
$stroo 
)oo 
]oo 
publicpp 
asyncpp 
Taskpp 
<pp 
IActionResultpp '
>pp' (
Deletepp) /
(pp/ 0
intpp0 3
idpp4 6
)pp6 7
{qq 	
varrr 
feedbackrr 
=rr 
awaitrr  
_dbrr! $
.rr$ %
	Feedbacksrr% .
.rr. /
	FindAsyncrr/ 8
(rr8 9
idrr9 ;
)rr; <
;rr< =
ifss 
(ss 
feedbackss 
==ss 
nullss  
)ss  !
returnss" (
NotFoundss) 1
(ss1 2
)ss2 3
;ss3 4
_dbuu 
.uu 
	Feedbacksuu 
.uu 
Removeuu  
(uu  !
feedbackuu! )
)uu) *
;uu* +
awaitvv 
_dbvv 
.vv 
SaveChangesAsyncvv &
(vv& '
)vv' (
;vv( )
returnxx 
	NoContentxx 
(xx 
)xx 
;xx 
}yy 	
}zz 
public}} 

class}} !
FeedbackCreateRequest}} &
{~~ 
public 
int 
	LearnerId 
{ 
get "
;" #
set$ '
;' (
}) *
public
ÄÄ 
int
ÄÄ 
CourseId
ÄÄ 
{
ÄÄ 
get
ÄÄ !
;
ÄÄ! "
set
ÄÄ# &
;
ÄÄ& '
}
ÄÄ( )
public
ÅÅ 
string
ÅÅ 
Message
ÅÅ 
{
ÅÅ 
get
ÅÅ  #
;
ÅÅ# $
set
ÅÅ% (
;
ÅÅ( )
}
ÅÅ* +
=
ÅÅ, -
null
ÅÅ. 2
!
ÅÅ2 3
;
ÅÅ3 4
public
ÇÇ 
int
ÇÇ 
?
ÇÇ 
Rating
ÇÇ 
{
ÇÇ 
get
ÇÇ  
;
ÇÇ  !
set
ÇÇ" %
;
ÇÇ% &
}
ÇÇ' (
}
ÉÉ 
public
ÖÖ 

class
ÖÖ #
FeedbackUpdateRequest
ÖÖ &
{
ÜÜ 
public
áá 
string
áá 
?
áá 
Message
áá 
{
áá  
get
áá! $
;
áá$ %
set
áá& )
;
áá) *
}
áá+ ,
public
àà 
int
àà 
?
àà 
Rating
àà 
{
àà 
get
àà  
;
àà  !
set
àà" %
;
àà% &
}
àà' (
}
ââ 
}ää ∞`
YD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\EnrollmentController.cs
	namespace 	
MiniLMS
 
. 
Controllers 
{ 
[		 
ApiController		 
]		 
[

 
Route

 

(


 
$str

 
)

 
]

 
public 

class  
EnrollmentController %
:& '
ControllerBase( 6
{ 
private 
readonly 
MiniLMSContext '
_db( +
;+ ,
public  
EnrollmentController #
(# $
MiniLMSContext$ 2
db3 5
)5 6
{ 	
_db 
= 
db 
; 
} 	
[ 	
HttpPost	 
( 
$str %
)% &
]& '
[ 	
	Authorize	 
( 
Roles 
= 
$str $
)$ %
]% &
public 
async 
Task 
< 
IActionResult '
>' (
EnrollInCourse) 7
(7 8
int8 ;
courseId< D
)D E
{ 	
var 
idClaim 
= 
User 
. 
FindFirstValue -
(- .

ClaimTypes. 8
.8 9
NameIdentifier9 G
)G H
;H I
if 
( 
! 
int 
. 
TryParse 
( 
idClaim %
,% &
out' *
var+ .
	learnerId/ 8
)8 9
)9 :
return 
Unauthorized #
(# $
new$ '
{( )
error* /
=0 1
$str2 V
}W X
)X Y
;Y Z
if 
( 
await 
_db 
. 
Enrollments %
.% &
AnyAsync& .
(. /
e/ 0
=>1 3
e4 5
.5 6
	LearnerId6 ?
==@ B
	learnerIdC L
&&M O
eP Q
.Q R
CourseIdR Z
==[ ]
courseId^ f
)f g
)g h
return   

BadRequest   !
(  ! "
$str  " L
)  L M
;  M N
var"" 

enrollment"" 
="" 
new""  

Enrollment""! +
{## 
	LearnerId$$ 
=$$ 
	learnerId$$ %
,$$% &
CourseId%% 
=%% 
courseId%% %
,%%% &

EnrolledAt&& 
=&& 
DateTime&& %
.&&% &
UtcNow&&& ,
,&&, -
Status'' 
='' 
$str'' %
}(( 
;(( 
_db** 
.** 
Enrollments** 
.** 
Add** 
(**  

enrollment**  *
)*** +
;**+ ,
await++ 
_db++ 
.++ 
SaveChangesAsync++ &
(++& '
)++' (
;++( )
return-- 
Ok-- 
(-- 
new-- 
{-- 
message-- #
=--$ %
$str--& =
,--= >

enrollment--? I
}--J K
)--K L
;--L M
}.. 	
[11 	
HttpGet11	 
(11 
$str11 
)11 
]11 
[22 	
	Authorize22	 
(22 
Roles22 
=22 
$str22 $
)22$ %
]22% &
public33 
async33 
Task33 
<33 
IActionResult33 '
>33' (
GetMyCourses33) 5
(335 6
)336 7
{44 	
var55 
idClaim55 
=55 
User55 
.55 
FindFirstValue55 -
(55- .

ClaimTypes55. 8
.558 9
NameIdentifier559 G
)55G H
;55H I
if66 
(66 
!66 
int66 
.66 
TryParse66 
(66 
idClaim66 %
,66% &
out66' *
var66+ .
	learnerId66/ 8
)668 9
)669 :
return77 
Unauthorized77 #
(77# $
new77$ '
{77( )
error77* /
=770 1
$str772 V
}77W X
)77X Y
;77Y Z
var99 
courses99 
=99 
await99 
_db99  #
.99# $
Enrollments99$ /
.:: 
Where:: 
(:: 
e:: 
=>:: 
e:: 
.:: 
	LearnerId:: '
==::( *
	learnerId::+ 4
)::4 5
.;; 
Include;; 
(;; 
e;; 
=>;; 
e;; 
.;;  
Course;;  &
);;& '
.<< 
ThenInclude<< 
(<< 
c<< 
=><< !
c<<" #
.<<# $
Trainer<<$ +
)<<+ ,
.== 
Select== 
(== 
e== 
=>== 
new==  
{>> 
e?? 
.?? 
Course?? 
.?? 
Id?? 
,??  
e@@ 
.@@ 
Course@@ 
.@@ 
Name@@ !
,@@! "
eAA 
.AA 
CourseAA 
.AA 
DurationAA %
,AA% &
TrainerBB 
=BB! "
eBB# $
.BB$ %
CourseBB% +
.BB+ ,
TrainerBB, 3
.BB3 4
UsernameBB4 <
,BB< =
eCC 
.CC 
StatusCC 
,CC 
eDD 
.DD 

EnrolledAtDD  
,DD  !
EnrollmentIdEE  
=EE! "
eEE# $
.EE$ %
IdEE% '
}FF 
)FF 
.GG 
ToListAsyncGG 
(GG 
)GG 
;GG 
returnII 
OkII 
(II 
coursesII 
)II 
;II 
}JJ 	
[MM 	
HttpGetMM	 
(MM 
$strMM $
)MM$ %
]MM% &
[NN 	
	AuthorizeNN	 
(NN 
RolesNN 
=NN 
$strNN *
)NN* +
]NN+ ,
publicOO 
asyncOO 
TaskOO 
<OO 
IActionResultOO '
>OO' ( 
GetLearnersForCourseOO) =
(OO= >
intOO> A
courseIdOOB J
)OOJ K
{PP 	
varQQ 
learnersQQ 
=QQ 
awaitQQ  
_dbQQ! $
.QQ$ %
EnrollmentsQQ% 0
.RR 
WhereRR 
(RR 
eRR 
=>RR 
eRR 
.RR 
CourseIdRR &
==RR' )
courseIdRR* 2
)RR2 3
.SS 
IncludeSS 
(SS 
eSS 
=>SS 
eSS 
.SS  
LearnerSS  '
)SS' (
.TT 
SelectTT 
(TT 
eTT 
=>TT 
newTT  
{UU 
eVV 
.VV 
LearnerVV 
.VV 
IdVV  
,VV  !
eWW 
.WW 
LearnerWW 
.WW 
UsernameWW &
,WW& '
eXX 
.XX 
LearnerXX 
.XX 
EmailXX #
,XX# $
eYY 
.YY 
StatusYY 
,YY 
eZZ 
.ZZ 

EnrolledAtZZ  
}[[ 
)[[ 
.\\ 
ToListAsync\\ 
(\\ 
)\\ 
;\\ 
return^^ 
Ok^^ 
(^^ 
learners^^ 
)^^ 
;^^  
}__ 	
[bb 	

HttpDeletebb	 
(bb 
$strbb $
)bb$ %
]bb% &
[cc 	
	Authorizecc	 
(cc 
Rolescc 
=cc 
$strcc *
)cc* +
]cc+ ,
publicdd 
asyncdd 
Taskdd 
<dd 
IActionResultdd '
>dd' (
DropEnrollmentdd) 7
(dd7 8
intdd8 ;
enrollmentIddd< H
)ddH I
{ee 	
varff 

enrollmentff 
=ff 
awaitff "
_dbff# &
.ff& '
Enrollmentsff' 2
.gg 
Includegg 
(gg 
egg 
=>gg 
egg 
.gg  
Coursegg  &
)gg& '
.hh 
FirstOrDefaultAsynchh $
(hh$ %
ehh% &
=>hh' )
ehh* +
.hh+ ,
Idhh, .
==hh/ 1
enrollmentIdhh2 >
)hh> ?
;hh? @
ifjj 
(jj 

enrollmentjj 
==jj 
nulljj "
)jj" #
returnkk 
NotFoundkk 
(kk  
)kk  !
;kk! "
varmm 
idClaimmm 
=mm 
Usermm 
.mm 
FindFirstValuemm -
(mm- .

ClaimTypesmm. 8
.mm8 9
NameIdentifiermm9 G
)mmG H
;mmH I
ifnn 
(nn 
!nn 
intnn 
.nn 
TryParsenn 
(nn 
idClaimnn %
,nn% &
outnn' *
varnn+ .
	learnerIdnn/ 8
)nn8 9
)nn9 :
returnoo 
Unauthorizedoo #
(oo# $
newoo$ '
{oo( )
erroroo* /
=oo0 1
$stroo2 V
}ooW X
)ooX Y
;ooY Z
ifrr 
(rr 
Userrr 
.rr 
IsInRolerr 
(rr 
$strrr '
)rr' (
&&rr) +

enrollmentrr, 6
.rr6 7
	LearnerIdrr7 @
!=rrA C
	learnerIdrrD M
)rrM N
returnss 
Forbidss 
(ss 
)ss 
;ss  
varvv 
moduleProgressesvv  
=vv! "
awaitvv# (
_dbvv) ,
.vv, -
Moduleprogressesvv- =
.ww 
Includeww 
(ww 
mpww 
=>ww 
mpww !
.ww! "
Moduleww" (
)ww( )
.xx 
Wherexx 
(xx 
mpxx 
=>xx 
mpyy 
.yy 
	LearnerIdyy  
==yy! #

enrollmentyy$ .
.yy. /
	LearnerIdyy/ 8
&&yy9 ;
mpzz 
.zz 
Modulezz 
.zz 
CourseIdzz &
==zz' )

enrollmentzz* 4
.zz4 5
CourseIdzz5 =
)zz= >
.{{ 
ToListAsync{{ 
({{ 
){{ 
;{{ 
_db|| 
.|| 
Moduleprogresses||  
.||  !
RemoveRange||! ,
(||, -
moduleProgresses||- =
)||= >
;||> ?
var 
	feedbacks 
= 
await !
_db" %
.% &
	Feedbacks& /
.
ÄÄ 
Where
ÄÄ 
(
ÄÄ 
f
ÄÄ 
=>
ÄÄ 
f
ÅÅ 
.
ÅÅ 
	LearnerId
ÅÅ 
==
ÅÅ  "

enrollment
ÅÅ# -
.
ÅÅ- .
	LearnerId
ÅÅ. 7
&&
ÅÅ8 :
f
ÇÇ 
.
ÇÇ 
CourseId
ÇÇ 
==
ÇÇ !

enrollment
ÇÇ" ,
.
ÇÇ, -
CourseId
ÇÇ- 5
)
ÇÇ5 6
.
ÉÉ 
ToListAsync
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
_db
ÑÑ 
.
ÑÑ 
	Feedbacks
ÑÑ 
.
ÑÑ 
RemoveRange
ÑÑ %
(
ÑÑ% &
	feedbacks
ÑÑ& /
)
ÑÑ/ 0
;
ÑÑ0 1
_db
áá 
.
áá 
Enrollments
áá 
.
áá 
Remove
áá "
(
áá" #

enrollment
áá# -
)
áá- .
;
áá. /
await
ââ 
_db
ââ 
.
ââ 
SaveChangesAsync
ââ &
(
ââ& '
)
ââ' (
;
ââ( )
return
ãã 
Ok
ãã 
(
ãã 
new
ãã 
{
ãã 
message
ãã #
=
ãã$ %
$str
ãã& f
}
ããg h
)
ããh i
;
ããi j
}
åå 	
}
çç 
}éé ∫¥
UD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\CourseController.cs
	namespace 	
Mini_LMS
 
. 
Controllers 
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
CourseController !
:" #
ControllerBase$ 2
{ 
private 
readonly 
MiniLMSContext '
_db( +
;+ ,
private 
readonly 
EmailService %
_email& ,
;, -
private 
readonly 
ILogger  
<  !
CourseController! 1
>1 2
_logger3 :
;: ;
public 
CourseController 
(  
MiniLMSContext 
db 
, 
EmailService 
email 
, 
ILogger 
< 
CourseController $
>$ %
logger& ,
), -
{ 	
_db 
= 
db 
; 
_email 
= 
email 
; 
_logger 
= 
logger 
; 
} 	
public## 
class## 
CourseCreateDTO## $
{$$ 	
public%% 
string%% 
Name%% 
{%%  
get%%! $
;%%$ %
set%%& )
;%%) *
}%%+ ,
=%%- .
null%%/ 3
!%%3 4
;%%4 5
public&& 
string&& 
?&& 
Type&& 
{&&  !
get&&" %
;&&% &
set&&' *
;&&* +
}&&, -
public'' 
int'' 
?'' 
Duration''  
{''! "
get''# &
;''& '
set''( +
;''+ ,
}''- .
public(( 
string(( 
?(( 

Visibility(( %
{((& '
get((( +
;((+ ,
set((- 0
;((0 1
}((2 3
})) 	
public++ 
class++ 
TakedownRequestDTO++ '
{,, 	
public-- 
int-- 
CourseId-- 
{--  !
get--" %
;--% &
set--' *
;--* +
}--, -
public.. 
string.. 
Reason..  
{..! "
get..# &
;..& '
set..( +
;..+ ,
}..- .
=../ 0
null..1 5
!..5 6
;..6 7
}// 	
[33 	
	Authorize33	 
(33 
Roles33 
=33 
$str33 $
)33$ %
]33% &
[44 	
HttpPost44	 
(44 
$str44 
)44 
]44 
public55 
async55 
Task55 
<55 
IActionResult55 '
>55' (
Create55) /
(55/ 0
[550 1
FromBody551 9
]559 :
CourseCreateDTO55; J
dto55K N
)55N O
{66 	
var88 
trainerEmail88 
=88 
User88 #
.88# $
	FindFirst88$ -
(88- .

ClaimTypes88. 8
.888 9
Email889 >
)88> ?
?88? @
.88@ A
Value88A F
??99 
User99  $
.99$ %
	FindFirst99% .
(99. /
$str99/ 6
)996 7
?997 8
.998 9
Value999 >
;99> ?
if:: 
(:: 
string:: 
.:: 
IsNullOrEmpty:: $
(::$ %
trainerEmail::% 1
)::1 2
)::2 3
return;; 
Unauthorized;; #
(;;# $
new;;$ '
{;;( )
message;;* 1
=;;2 3
$str;;4 M
};;N O
);;O P
;;;P Q
var>> 
trainer>> 
=>> 
await>> 
_db>>  #
.>># $
Users>>$ )
.??  
SingleOrDefaultAsync?? %
(??% &
u??& '
=>??( *
u??+ ,
.??, -
Email??- 2
==??3 5
trainerEmail??6 B
&&??C E
u??F G
.??G H
Role??H L
==??M O
$str??P Y
)??Y Z
;??Z [
if@@ 
(@@ 
trainer@@ 
==@@ 
null@@ 
)@@  
returnAA 
UnauthorizedAA #
(AA# $
newAA$ '
{AA( )
messageAA* 1
=AA2 3
$strAA4 H
}AAI J
)AAJ K
;AAK L
varDD 
courseDD 
=DD 
newDD 
CourseDD #
{EE 
	TrainerIdFF 
=FF 
trainerFF #
.FF# $
IdFF$ &
,FF& '
NameGG 
=GG 
dtoGG 
.GG 
NameGG 
,GG  
TypeHH 
=HH 
dtoHH 
.HH 
TypeHH 
,HH  
DurationII 
=II 
dtoII 
.II 
DurationII '
,II' (

VisibilityJJ 
=JJ 
dtoJJ  
.JJ  !

VisibilityJJ! +
??JJ, .
$strJJ/ 7
,JJ7 8

IsApprovedKK 
=KK 
falseKK "
,KK" #
	CreatedAtLL 
=LL 
DateTimeLL $
.LL$ %
UtcNowLL% +
,LL+ ,
	UpdatedAtMM 
=MM 
DateTimeMM $
.MM$ %
UtcNowMM% +
}NN 
;NN 
_dbPP 
.PP 
CoursesPP 
.PP 
AddPP 
(PP 
coursePP "
)PP" #
;PP# $
awaitQQ 
_dbQQ 
.QQ 
SaveChangesAsyncQQ &
(QQ& '
)QQ' (
;QQ( )
varTT 
learnersTT 
=TT 
awaitTT  
_dbTT! $
.TT$ %
UsersTT% *
.UU 
WhereUU 
(UU 
uUU 
=>UU 
uUU 
.UU 
RoleUU "
==UU# %
$strUU& /
&&UU0 2
uUU3 4
.UU4 5
IsActiveUU5 =
==UU> @
trueUUA E
)UUE F
.VV 
ToListAsyncVV 
(VV 
)VV 
;VV 
foreachXX 
(XX 
varXX 
learnerXX  
inXX! #
learnersXX$ ,
)XX, -
{YY 
_db[[ 
.[[ 
Notifications[[ !
.[[! "
Add[[" %
([[% &
new[[& )
Notification[[* 6
{\\ 
UserId]] 
=]] 
learner]] $
.]]$ %
Id]]% '
,]]' (
Type^^ 
=^^ 
$str^^ *
,^^* +
Message__ 
=__ 
$"__  
$str__  ,
{__, -
course__- 3
.__3 4
Name__4 8
}__8 9
$str__9 L
"__L M
,__M N
IsRead`` 
=`` 
false`` "
,``" #
	CreatedAtaa 
=aa 
DateTimeaa  (
.aa( )
UtcNowaa) /
}bb 
)bb 
;bb 
trydd 
{ee 
awaitff 
_emailff  
.ff  !,
 SendNewCourseAvailableEmailAsyncff! A
(ffA B
learnerffB I
.ffI J
EmailffJ O
,ffO P
courseffQ W
.ffW X
NameffX \
)ff\ ]
;ff] ^
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
_loggerjj 
.jj 
LogErrorjj $
(jj$ %
exjj% '
,jj' (
$strjj) Y
,jjY Z
learnerjj[ b
.jjb c
Emailjjc h
)jjh i
;jji j
}kk 
}ll 
trynn 
{oo 
awaitpp 
_dbpp 
.pp 
SaveChangesAsyncpp *
(pp* +
)pp+ ,
;pp, -
}qq 
catchrr 
(rr 
DbUpdateExceptionrr $
exrr% '
)rr' (
{ss 
_loggertt 
.tt 

LogWarningtt "
(tt" #
extt# %
,tt% &
$strtt' m
)ttm n
;ttn o
}uu 
returnww 
Okww 
(ww 
courseww 
)ww 
;ww 
}xx 	
[|| 	
	Authorize||	 
]|| 
[}} 	
HttpGet}}	 
(}} 
$str}} 
)}} 
]}} 
public~~ 
async~~ 
Task~~ 
<~~ 
IActionResult~~ '
>~~' (
GetAll~~) /
(~~/ 0
)~~0 1
{ 	
var
ÄÄ 
courses
ÄÄ 
=
ÄÄ 
await
ÄÄ 
_db
ÄÄ  #
.
ÄÄ# $
Courses
ÄÄ$ +
.
ÅÅ 
Include
ÅÅ 
(
ÅÅ 
c
ÅÅ 
=>
ÅÅ 
c
ÅÅ 
.
ÅÅ  
Trainer
ÅÅ  '
)
ÅÅ' (
.
ÇÇ 
ToListAsync
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
return
ÉÉ 
Ok
ÉÉ 
(
ÉÉ 
courses
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÑÑ 	
[
àà 	
	Authorize
àà	 
(
àà 
Roles
àà 
=
àà 
$str
àà $
)
àà$ %
]
àà% &
[
ââ 	
HttpPost
ââ	 
(
ââ 
$str
ââ $
)
ââ$ %
]
ââ% &
public
ää 
async
ää 
Task
ää 
<
ää 
IActionResult
ää '
>
ää' (
RequestTakedown
ää) 8
(
ää8 9
[
ää9 :
FromBody
ää: B
]
ääB C 
TakedownRequestDTO
ääD V
dto
ääW Z
)
ääZ [
{
ãã 	
var
çç 
trainerEmail
çç 
=
çç 
User
çç #
.
çç# $
	FindFirst
çç$ -
(
çç- .

ClaimTypes
çç. 8
.
çç8 9
Email
çç9 >
)
çç> ?
?
çç? @
.
çç@ A
Value
ççA F
??
éé 
User
éé  $
.
éé$ %
	FindFirst
éé% .
(
éé. /
$str
éé/ 6
)
éé6 7
?
éé7 8
.
éé8 9
Value
éé9 >
;
éé> ?
if
èè 
(
èè 
string
èè 
.
èè 
IsNullOrEmpty
èè $
(
èè$ %
trainerEmail
èè% 1
)
èè1 2
)
èè2 3
return
êê 
Unauthorized
êê #
(
êê# $
new
êê$ '
{
êê( )
message
êê* 1
=
êê2 3
$str
êê4 E
}
êêF G
)
êêG H
;
êêH I
var
ìì 
course
ìì 
=
ìì 
await
ìì 
_db
ìì "
.
ìì" #
Courses
ìì# *
.
ìì* +
	FindAsync
ìì+ 4
(
ìì4 5
dto
ìì5 8
.
ìì8 9
CourseId
ìì9 A
)
ììA B
;
ììB C
if
îî 
(
îî 
course
îî 
==
îî 
null
îî 
)
îî 
return
ïï 
NotFound
ïï 
(
ïï  
new
ïï  #
{
ïï$ %
message
ïï& -
=
ïï. /
$str
ïï0 C
}
ïïD E
)
ïïE F
;
ïïF G
var
òò 
trainerUser
òò 
=
òò 
await
òò #
_db
òò$ '
.
òò' (
Users
òò( -
.
ôô "
SingleOrDefaultAsync
ôô %
(
ôô% &
u
ôô& '
=>
ôô( *
u
ôô+ ,
.
ôô, -
Email
ôô- 2
==
ôô3 5
trainerEmail
ôô6 B
&&
ôôC E
u
ôôF G
.
ôôG H
Role
ôôH L
==
ôôM O
$str
ôôP Y
)
ôôY Z
;
ôôZ [
if
öö 
(
öö 
trainerUser
öö 
==
öö 
null
öö #
)
öö# $
return
õõ 
Unauthorized
õõ #
(
õõ# $
new
õõ$ '
{
õõ( )
message
õõ* 1
=
õõ2 3
$str
õõ4 P
}
õõQ R
)
õõR S
;
õõS T
_db
ûû 
.
ûû 
Notifications
ûû 
.
ûû 
Add
ûû !
(
ûû! "
new
ûû" %
Notification
ûû& 2
{
üü 
UserId
†† 
=
†† 
trainerUser
†† $
.
††$ %
Id
††% '
,
††' (
Type
°° 
=
°° 
$str
°° *
,
°°* +
Message
¢¢ 
=
¢¢ 
$"
¢¢ 
$str
¢¢ %
{
¢¢% &
trainerEmail
¢¢& 2
}
¢¢2 3
$str
¢¢3 L
{
¢¢L M
course
¢¢M S
.
¢¢S T
Name
¢¢T X
}
¢¢X Y
$str
¢¢Y d
{
¢¢d e
dto
¢¢e h
.
¢¢h i
Reason
¢¢i o
}
¢¢o p
"
¢¢p q
,
¢¢q r
IsRead
££ 
=
££ 
false
££ 
,
££ 
	CreatedAt
§§ 
=
§§ 
DateTime
§§ $
.
§§$ %
UtcNow
§§% +
}
•• 
)
•• 
;
•• 
await
¶¶ 
_db
¶¶ 
.
¶¶ 
SaveChangesAsync
¶¶ &
(
¶¶& '
)
¶¶' (
;
¶¶( )
const
©© 
string
©© 

adminEmail
©© #
=
©©$ %
$str
©©& B
;
©©B C
await
™™ 
_email
™™ 
.
™™ +
SendTakedownRequestEmailAsync
™™ 6
(
™™6 7

adminEmail
´´ 
,
´´ 
course
¨¨ 
.
¨¨ 
Name
¨¨ 
,
¨¨ 
trainerEmail
≠≠ 
)
ÆÆ 
;
ÆÆ 
return
∞∞ 
Ok
∞∞ 
(
∞∞ 
new
∞∞ 
{
∞∞ 
message
∞∞ #
=
∞∞$ %
$str
∞∞& N
}
∞∞O P
)
∞∞P Q
;
∞∞Q R
}
±± 	
[
µµ 	
	Authorize
µµ	 
]
µµ 
[
∂∂ 	
HttpGet
∂∂	 
(
∂∂ 
$str
∂∂ 
)
∂∂ 
]
∂∂ 
public
∑∑ 
async
∑∑ 
Task
∑∑ 
<
∑∑ 
IActionResult
∑∑ '
>
∑∑' (
Get
∑∑) ,
(
∑∑, -
int
∑∑- 0
id
∑∑1 3
)
∑∑3 4
{
∏∏ 	
var
ππ 
course
ππ 
=
ππ 
await
ππ 
_db
ππ "
.
ππ" #
Courses
ππ# *
.
∫∫ 
Include
∫∫ 
(
∫∫ 
c
∫∫ 
=>
∫∫ 
c
∫∫ 
.
∫∫  
Trainer
∫∫  '
)
∫∫' (
.
ªª !
FirstOrDefaultAsync
ªª $
(
ªª$ %
c
ªª% &
=>
ªª' )
c
ªª* +
.
ªª+ ,
Id
ªª, .
==
ªª/ 1
id
ªª2 4
)
ªª4 5
;
ªª5 6
if
ºº 
(
ºº 
course
ºº 
==
ºº 
null
ºº 
)
ºº 
return
ºº  &
NotFound
ºº' /
(
ºº/ 0
)
ºº0 1
;
ºº1 2
return
ΩΩ 
Ok
ΩΩ 
(
ΩΩ 
course
ΩΩ 
)
ΩΩ 
;
ΩΩ 
}
ææ 	
[
¡¡ 
	Authorize
¡¡ 
(
¡¡ 
Roles
¡¡ 
=
¡¡ 
$str
¡¡ !
)
¡¡! "
]
¡¡" #
[¬¬ 

HttpDelete
¬¬ 
(
¬¬ 
$str
¬¬ 
)
¬¬ 
]
¬¬ 
public√√ 
async
√√ 
Task
√√ 
<
√√ 
IActionResult
√√ 
>
√√  
Delete
√√! '
(
√√' (
int
√√( +
id
√√, .
)
√√. /
{ƒƒ 
var
∆∆ 
course
∆∆ 
=
∆∆ 
await
∆∆ 
_db
∆∆ 
.
∆∆ 
Courses
∆∆ "
.
«« 	
Include
««	 
(
«« 
c
«« 
=>
«« 
c
«« 
.
«« 
Modules
«« 
)
««  
.
»» 	!
FirstOrDefaultAsync
»»	 
(
»» 
c
»» 
=>
»» !
c
»»" #
.
»»# $
Id
»»$ &
==
»»' )
id
»»* ,
)
»», -
;
»»- .
if
   
(
   
course
   
==
   
null
   
)
   
return
ÀÀ 
NotFound
ÀÀ 
(
ÀÀ 
new
ÀÀ 
{
ÀÀ 
message
ÀÀ %
=
ÀÀ& '
$str
ÀÀ( ;
}
ÀÀ< =
)
ÀÀ= >
;
ÀÀ> ?
if
ŒŒ 
(
ŒŒ 
course
ŒŒ 
.
ŒŒ 
Modules
ŒŒ 
.
ŒŒ 
Any
ŒŒ 
(
ŒŒ 
)
ŒŒ 
)
ŒŒ 
_db
œœ 
.
œœ 
Modules
œœ 
.
œœ 
RemoveRange
œœ 
(
œœ  
course
œœ  &
.
œœ& '
Modules
œœ' .
)
œœ. /
;
œœ/ 0
var
““ 
	feedbacks
““ 
=
““ 
await
““ 
_db
““ 
.
““ 
	Feedbacks
““ '
.
”” 	
Where
””	 
(
”” 
f
”” 
=>
”” 
f
”” 
.
”” 
CourseId
”” 
==
”” !
course
””" (
.
””( )
Id
””) +
)
””+ ,
.
‘‘ 	
ToListAsync
‘‘	 
(
‘‘ 
)
‘‘ 
;
‘‘ 
if
’’ 
(
’’ 
	feedbacks
’’ 
.
’’ 
Any
’’ 
(
’’ 
)
’’ 
)
’’ 
_db
÷÷ 
.
÷÷ 
	Feedbacks
÷÷ 
.
÷÷ 
RemoveRange
÷÷ !
(
÷÷! "
	feedbacks
÷÷" +
)
÷÷+ ,
;
÷÷, -
var
ŸŸ 
notes
ŸŸ 
=
ŸŸ 
await
ŸŸ 
_db
ŸŸ 
.
ŸŸ 
Notifications
ŸŸ '
.
⁄⁄ 	
Where
⁄⁄	 
(
⁄⁄ 
n
⁄⁄ 
=>
⁄⁄ 
n
⁄⁄ 
.
⁄⁄ 
Type
⁄⁄ 
==
⁄⁄ 
$str
⁄⁄ 1
&&
⁄⁄2 4
n
⁄⁄5 6
.
⁄⁄6 7
Message
⁄⁄7 >
.
⁄⁄> ?
Contains
⁄⁄? G
(
⁄⁄G H
$"
⁄⁄H J
$str
⁄⁄J K
{
⁄⁄K L
course
⁄⁄L R
.
⁄⁄R S
Name
⁄⁄S W
}
⁄⁄W X
$str
⁄⁄X Y
"
⁄⁄Y Z
)
⁄⁄Z [
)
⁄⁄[ \
.
€€ 	
ToListAsync
€€	 
(
€€ 
)
€€ 
;
€€ 
if
‹‹ 
(
‹‹ 
notes
‹‹ 
.
‹‹ 
Any
‹‹ 
(
‹‹ 
)
‹‹ 
)
‹‹ 
_db
›› 
.
›› 
Notifications
›› 
.
›› 
RemoveRange
›› %
(
››% &
notes
››& +
)
››+ ,
;
››, -
_db
‡‡ 
.
‡‡ 
Courses
‡‡ 
.
‡‡ 
Remove
‡‡ 
(
‡‡ 
course
‡‡ 
)
‡‡ 
;
‡‡ 
await
„„ 	
_db
„„
 
.
„„ 
SaveChangesAsync
„„ 
(
„„ 
)
„„  
;
„„  !
return
ÂÂ 

	NoContent
ÂÂ 
(
ÂÂ 
)
ÂÂ 
;
ÂÂ 
}ÊÊ 
[
ÈÈ 	
	Authorize
ÈÈ	 
(
ÈÈ 
Roles
ÈÈ 
=
ÈÈ 
$str
ÈÈ $
)
ÈÈ$ %
]
ÈÈ% &
[
ÍÍ 	
HttpPut
ÍÍ	 
(
ÍÍ 
$str
ÍÍ 
)
ÍÍ 
]
ÍÍ 
public
ÎÎ 
async
ÎÎ 
Task
ÎÎ 
<
ÎÎ 
IActionResult
ÎÎ '
>
ÎÎ' (
Update
ÎÎ) /
(
ÎÎ/ 0
int
ÎÎ0 3
id
ÎÎ4 6
,
ÎÎ6 7
[
ÎÎ8 9
FromBody
ÎÎ9 A
]
ÎÎA B
CourseCreateDTO
ÎÎC R
dto
ÎÎS V
)
ÎÎV W
{
ÏÏ 	
var
ÓÓ 
trainerEmail
ÓÓ 
=
ÓÓ 
User
ÓÓ #
.
ÓÓ# $
	FindFirst
ÓÓ$ -
(
ÓÓ- .

ClaimTypes
ÓÓ. 8
.
ÓÓ8 9
Email
ÓÓ9 >
)
ÓÓ> ?
?
ÓÓ? @
.
ÓÓ@ A
Value
ÓÓA F
??
ÔÔ 
User
ÔÔ  $
.
ÔÔ$ %
	FindFirst
ÔÔ% .
(
ÔÔ. /
$str
ÔÔ/ 6
)
ÔÔ6 7
?
ÔÔ7 8
.
ÔÔ8 9
Value
ÔÔ9 >
;
ÔÔ> ?
if
 
(
 
string
 
.
 
IsNullOrEmpty
 $
(
$ %
trainerEmail
% 1
)
1 2
)
2 3
return
ÒÒ 
Unauthorized
ÒÒ #
(
ÒÒ# $
new
ÒÒ$ '
{
ÒÒ( )
message
ÒÒ* 1
=
ÒÒ2 3
$str
ÒÒ4 E
}
ÒÒF G
)
ÒÒG H
;
ÒÒH I
var
ÙÙ 
course
ÙÙ 
=
ÙÙ 
await
ÙÙ 
_db
ÙÙ "
.
ÙÙ" #
Courses
ÙÙ# *
.
ıı 
Include
ıı 
(
ıı 
c
ıı 
=>
ıı 
c
ıı 
.
ıı  
Trainer
ıı  '
)
ıı' (
.
ˆˆ "
SingleOrDefaultAsync
ˆˆ %
(
ˆˆ% &
c
ˆˆ& '
=>
ˆˆ( *
c
ˆˆ+ ,
.
ˆˆ, -
Id
ˆˆ- /
==
ˆˆ0 2
id
ˆˆ3 5
&&
ˆˆ6 8
c
ˆˆ9 :
.
ˆˆ: ;
Trainer
ˆˆ; B
.
ˆˆB C
Email
ˆˆC H
==
ˆˆI K
trainerEmail
ˆˆL X
)
ˆˆX Y
;
ˆˆY Z
if
˜˜ 
(
˜˜ 
course
˜˜ 
==
˜˜ 
null
˜˜ 
)
˜˜ 
return
¯¯ 
NotFound
¯¯ 
(
¯¯  
new
¯¯  #
{
¯¯$ %
message
¯¯& -
=
¯¯. /
$str
¯¯0 S
}
¯¯T U
)
¯¯U V
;
¯¯V W
course
˚˚ 
.
˚˚ 
Name
˚˚ 
=
˚˚ 
dto
˚˚ 
.
˚˚ 
Name
˚˚ "
;
˚˚" #
course
¸¸ 
.
¸¸ 
Type
¸¸ 
=
¸¸ 
dto
¸¸ 
.
¸¸ 
Type
¸¸ "
;
¸¸" #
course
˝˝ 
.
˝˝ 
Duration
˝˝ 
=
˝˝ 
dto
˝˝ !
.
˝˝! "
Duration
˝˝" *
;
˝˝* +
course
˛˛ 
.
˛˛ 

Visibility
˛˛ 
=
˛˛ 
dto
˛˛  #
.
˛˛# $

Visibility
˛˛$ .
??
˛˛/ 1
course
˛˛2 8
.
˛˛8 9

Visibility
˛˛9 C
;
˛˛C D
course
ˇˇ 
.
ˇˇ 
	UpdatedAt
ˇˇ 
=
ˇˇ 
DateTime
ˇˇ '
.
ˇˇ' (
UtcNow
ˇˇ( .
;
ˇˇ. /
await
ÅÅ 
_db
ÅÅ 
.
ÅÅ 
SaveChangesAsync
ÅÅ &
(
ÅÅ& '
)
ÅÅ' (
;
ÅÅ( )
return
ÇÇ 
Ok
ÇÇ 
(
ÇÇ 
course
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 	
}
ÑÑ 
}áá Í©
SD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\AuthController.cs
	namespace 	
Mini_LMS
 
. 
Controllers 
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
AuthController 
:  !
ControllerBase" 0
{ 
private 
const 
string 

AdminEmail '
=( )
$str* F
;F G
private 
const 
string 
AdminPassword *
=+ ,
$str- 8
;8 9
private 
static 
readonly 

Dictionary  *
<* +
string+ 1
,1 2
string3 9
>9 :
	AdminOtps; D
=E F
newG J
(J K
)K L
;L M
private 
readonly 
MiniLMSContext '
_db( +
;+ ,
private 
readonly 
EmailService %
_emailService& 3
;3 4
private 
readonly 
	JwtHelper "

_jwtHelper# -
;- .
public 
AuthController 
( 
MiniLMSContext ,
db- /
,/ 0
EmailService1 =
emailService> J
,J K
	JwtHelperL U
	jwtHelperV _
)_ `
{ 	
_db 
= 
db 
; 
_emailService 
= 
emailService (
;( )

_jwtHelper   
=   
	jwtHelper   "
;  " #
}!! 	
[$$ 	
HttpPost$$	 
($$ 
$str$$ 
)$$  
]$$  !
[%% 	
AllowAnonymous%%	 
]%% 
public&& 
async&& 
Task&& 
<&& 
IActionResult&& '
>&&' (

AdminLogin&&) 3
(&&3 4
[&&4 5
FromForm&&5 =
]&&= >
string&&? E
email&&F K
,&&K L
[&&M N
FromForm&&N V
]&&V W
string&&X ^
password&&_ g
)&&g h
{'' 	
if(( 
((( 
email(( 
!=(( 

AdminEmail(( #
||(($ &
password((' /
!=((0 2
AdminPassword((3 @
)((@ A
return)) 
Unauthorized)) #
())# $
new))$ '
{))( )
message))* 1
=))2 3
$str))4 P
}))Q R
)))R S
;))S T
var++ 
otp++ 
=++ 
new++ 
Random++  
(++  !
)++! "
.++" #
Next++# '
(++' (
$num++( .
,++. /
$num++0 6
)++6 7
.++7 8
ToString++8 @
(++@ A
)++A B
;++B C
	AdminOtps,, 
[,, 
email,, 
],, 
=,, 
otp,, "
;,," #
await.. 
_emailService.. 
...  
SendOtpEmailAsync..  1
(..1 2
email..2 7
,..7 8
otp..9 <
)..< =
;..= >
return// 
Ok// 
(// 
new// 
{// 
message// #
=//$ %
$str//& @
}//A B
)//B C
;//C D
}00 	
[33 	
HttpPost33	 
(33 
$str33 $
)33$ %
]33% &
[44 	
AllowAnonymous44	 
]44 
public55 
IActionResult55 
VerifyAdminOtp55 +
(55+ ,
[55, -
FromForm55- 5
]555 6
string557 =
email55> C
,55C D
[55E F
FromForm55F N
]55N O
string55P V
otp55W Z
)55Z [
{66 	
if77 
(77 
!77 
	AdminOtps77 
.77 
ContainsKey77 &
(77& '
email77' ,
)77, -
||77. 0
	AdminOtps771 :
[77: ;
email77; @
]77@ A
!=77B D
otp77E H
)77H I
return88 
Unauthorized88 #
(88# $
new88$ '
{88( )
message88* 1
=882 3
$str884 M
}88N O
)88O P
;88P Q
	AdminOtps:: 
.:: 
Remove:: 
(:: 
email:: "
)::" #
;::# $
var;; 
token;; 
=;; 

_jwtHelper;; "
.;;" #
GenerateToken;;# 0
(;;0 1
email;;1 6
,;;6 7
$str;;8 ?
,;;? @
$num;;A B
);;B C
;;;C D
return<< 
Ok<< 
(<< 
new<< 
{<< 
message<< #
=<<$ %
$str<<& M
,<<M N
token<<O T
}<<U V
)<<V W
;<<W X
}== 	
[@@ 	
HttpPost@@	 
(@@ 
$str@@ 
)@@ 
]@@  
[AA 	
AllowAnonymousAA	 
]AA 
publicBB 
asyncBB 
TaskBB 
<BB 
IActionResultBB '
>BB' (
	UserLoginBB) 2
(BB2 3
[BB3 4
FromFormBB4 <
]BB< =
stringBB> D
emailBBE J
,BBJ K
[BBL M
FromFormBBM U
]BBU V
stringBBW ]
passwordBB^ f
,BBf g
[BBh i
FromFormBBi q
]BBq r
stringBBs y
roleBBz ~
)BB~ 
{CC 	
varDD 
userDD 
=DD 
awaitDD 
_dbDD  
.DD  !
UsersDD! &
.EE  
SingleOrDefaultAsyncEE %
(EE% &
uEE& '
=>EE( *
uEE+ ,
.EE, -
EmailEE- 2
==EE3 5
emailEE6 ;
&&EE< >
uEE? @
.EE@ A
RoleEEA E
==EEF H
roleEEI M
)EEM N
;EEN O
ifGG 
(GG 
userGG 
==GG 
nullGG 
||GG 
!GG  !
userGG! %
.GG% &
IsActiveGG& .
.GG. /
GetValueOrDefaultGG/ @
(GG@ A
)GGA B
||GGC E
!GGF G
BCryptGGG M
.GGM N
NetGGN Q
.GGQ R
BCryptGGR X
.GGX Y
VerifyGGY _
(GG_ `
passwordGG` h
,GGh i
userGGj n
.GGn o
PasswordHashGGo {
)GG{ |
)GG| }
returnHH 
UnauthorizedHH #
(HH# $
newHH$ '
{HH( )
messageHH* 1
=HH2 3
$"HH4 6
$strHH6 >
{HH> ?
roleHH? C
}HHC D
$strHHD Q
"HHQ R
}HHS T
)HHT U
;HHU V
varJJ 
tokenJJ 
=JJ 

_jwtHelperJJ "
.JJ" #
GenerateTokenJJ# 0
(JJ0 1
userJJ1 5
.JJ5 6
EmailJJ6 ;
,JJ; <
userJJ= A
.JJA B
RoleJJB F
,JJF G
(JJH I
intJJI L
)JJL M
userJJM Q
.JJQ R
IdJJR T
)JJT U
;JJU V
returnKK 
OkKK 
(KK 
newKK 
{KK 
messageKK #
=KK$ %
$"KK& (
{KK( )
roleKK) -
}KK- .
$strKK. @
"KK@ A
,KKA B
tokenKKC H
}KKI J
)KKJ K
;KKK L
}LL 	
[PP 	
HttpPostPP	 
(PP 
$strPP 
)PP 
]PP 
[QQ 	
AllowAnonymousQQ	 
]QQ 
publicRR 
asyncRR 
TaskRR 
<RR 
IActionResultRR '
>RR' (
RegisterRR) 1
(RR1 2
[SS 
FromFormSS 
]SS 
stringSS 
usernameSS &
,SS& '
[TT 
FromFormTT 
]TT 
stringTT 
emailTT #
,TT# $
[UU 
FromFormUU 
]UU 
stringUU 
passwordUU &
,UU& '
[VV 
FromFormVV 
]VV 
stringVV 
roleVV "
)VV" #
{WW 	
ifXX 
(XX 
stringXX 
.XX 
IsNullOrWhiteSpaceXX )
(XX) *
usernameXX* 2
)XX2 3
)XX3 4
returnYY 

BadRequestYY !
(YY! "
newYY" %
{YY& '
messageYY( /
=YY0 1
$strYY2 I
}YYJ K
)YYK L
;YYL M
if[[ 
([[ 
await[[ 
_db[[ 
.[[ 
Users[[ 
.[[  
AnyAsync[[  (
([[( )
u[[) *
=>[[+ -
u[[. /
.[[/ 0
Email[[0 5
==[[6 8
email[[9 >
)[[> ?
)[[? @
return\\ 
Conflict\\ 
(\\  
new\\  #
{\\$ %
message\\& -
=\\. /
$str\\0 K
}\\L M
)\\M N
;\\N O
if^^ 
(^^ 
role^^ 
!=^^ 
$str^^ !
&&^^" $
role^^% )
!=^^* ,
$str^^- 6
)^^6 7
return__ 

BadRequest__ !
(__! "
new__" %
{__& '
message__( /
=__0 1
$str__2 a
}__b c
)__c d
;__d e
varaa 
useraa 
=aa 
newaa 
Useraa 
{bb 
Usernamecc 
=cc 
usernamecc #
,cc# $
Emaildd 
=dd 
emaildd 
,dd 
PasswordHashee 
=ee 
BCryptee %
.ee% &
Netee& )
.ee) *
BCryptee* 0
.ee0 1
HashPasswordee1 =
(ee= >
passwordee> F
)eeF G
,eeG H
Roleff 
=ff 
roleff 
,ff 
IsActivegg 
=gg 
truegg 
,gg  
	CreatedAthh 
=hh 
DateTimehh $
.hh$ %
UtcNowhh% +
}ii 
;ii 
_dbkk 
.kk 
Userskk 
.kk 
Addkk 
(kk 
userkk 
)kk 
;kk  
awaitll 
_dbll 
.ll 
SaveChangesAsyncll &
(ll& '
)ll' (
;ll( )
returnnn 
Oknn 
(nn 
newnn 
{nn 
messagenn #
=nn$ %
$"nn& (
{nn( )
rolenn) -
}nn- .
$strnn. 0
{nn0 1
usernamenn1 9
}nn9 :
$strnn: T
"nnT U
}nnV W
)nnW X
;nnX Y
}oo 	
[ss 	
HttpPostss	 
(ss 
$strss *
)ss* +
]ss+ ,
[tt 	
AllowAnonymoustt	 
]tt 
publicuu 
asyncuu 
Taskuu 
<uu 
IActionResultuu '
>uu' ( 
RequestPasswordResetuu) =
(uu= >
[uu> ?
FromFormuu? G
]uuG H
intuuI L
userIduuM S
)uuS T
{vv 	
varww 
userww 
=ww 
awaitww 
_dbww  
.ww  !
Usersww! &
.ww& '
	FindAsyncww' 0
(ww0 1
userIdww1 7
)ww7 8
;ww8 9
ifxx 
(xx 
userxx 
==xx 
nullxx 
||xx 
!xx  !
userxx! %
.xx% &
IsActivexx& .
.xx. /
GetValueOrDefaultxx/ @
(xx@ A
)xxA B
)xxB C
returnyy 
NotFoundyy 
(yy  
newyy  #
{yy$ %
messageyy& -
=yy. /
$stryy0 M
}yyN O
)yyO P
;yyP Q
var{{ 
token{{ 
={{ 
Guid{{ 
.{{ 
NewGuid{{ $
({{$ %
){{% &
.{{& '
ToString{{' /
({{/ 0
){{0 1
;{{1 2
var|| 
now|| 
=|| 
DateTime|| 
.|| 
UtcNow|| %
;||% &
_db~~ 
.~~ 
Passwordresets~~ 
.~~ 
Add~~ "
(~~" #
new~~# &
Passwordreset~~' 4
{ 
UserId
ÄÄ 
=
ÄÄ 
userId
ÄÄ 
,
ÄÄ  
Email
ÅÅ 
=
ÅÅ 
user
ÅÅ 
.
ÅÅ 
Email
ÅÅ "
,
ÅÅ" #
Token
ÇÇ 
=
ÇÇ 
token
ÇÇ 
,
ÇÇ 
SentAt
ÉÉ 
=
ÉÉ 
now
ÉÉ 
,
ÉÉ 

ExpiryTime
ÑÑ 
=
ÑÑ 
now
ÑÑ  
.
ÑÑ  !

AddMinutes
ÑÑ! +
(
ÑÑ+ ,
$num
ÑÑ, .
)
ÑÑ. /
}
ÖÖ 
)
ÖÖ 
;
ÖÖ 
await
áá 
_db
áá 
.
áá 
SaveChangesAsync
áá &
(
áá& '
)
áá' (
;
áá( )
string
ââ 
link
ââ 
=
ââ 
string
ââ  
.
ââ  !
IsNullOrEmpty
ââ! .
(
ââ. /
user
ââ/ 3
.
ââ3 4
PasswordHash
ââ4 @
)
ââ@ A
?
ää 
$"
ää 
$str
ää @
{
ää@ A
userId
ääA G
}
ääG H
$str
ääH O
{
ääO P
token
ääP U
}
ääU V
"
ääV W
:
ãã 
$"
ãã 
$str
ãã @
{
ãã@ A
userId
ããA G
}
ããG H
$str
ããH O
{
ããO P
token
ããP U
}
ããU V
"
ããV W
;
ããW X
await
çç 
_emailService
çç 
.
çç  )
SendPasswordResetEmailAsync
çç  ;
(
çç; <
user
çç< @
.
çç@ A
Email
ççA F
,
ççF G
link
ççH L
)
ççL M
;
ççM N
return
éé 
Ok
éé 
(
éé 
new
éé 
{
éé 
message
éé #
=
éé$ %
$str
éé& U
}
ééV W
)
ééW X
;
ééX Y
}
èè 	
[
íí 	
HttpPost
íí	 
(
íí 
$str
íí (
)
íí( )
]
íí) *
[
ìì 	
AllowAnonymous
ìì	 
]
ìì 
public
îî 
async
îî 
Task
îî 
<
îî 
IActionResult
îî '
>
îî' (
ResetPassword
îî) 6
(
îî6 7
[
ïï 
FromForm
ïï 
]
ïï 
string
ïï 
email
ïï #
,
ïï# $
[
ññ 
FromForm
ññ 
]
ññ 
string
ññ 
token
ññ #
,
ññ# $
[
óó 
FromForm
óó 
]
óó 
string
óó 
newPassword
óó )
,
óó) *
[
òò 
FromForm
òò 
]
òò 
string
òò 
confirmPassword
òò -
)
òò- .
{
ôô 	
if
öö 
(
öö 
newPassword
öö 
!=
öö 
confirmPassword
öö .
)
öö. /
return
õõ 

BadRequest
õõ !
(
õõ! "
new
õõ" %
{
õõ& '
message
õõ( /
=
õõ0 1
$str
õõ2 K
}
õõL M
)
õõM N
;
õõN O
var
ùù 
reset
ùù 
=
ùù 
await
ùù 
_db
ùù !
.
ùù! "
Passwordresets
ùù" 0
.
ûû 
Where
ûû 
(
ûû 
x
ûû 
=>
ûû 
x
ûû 
.
ûû 
Email
ûû #
==
ûû$ &
email
ûû' ,
&&
ûû- /
x
ûû0 1
.
ûû1 2
Token
ûû2 7
==
ûû8 :
token
ûû; @
)
ûû@ A
.
üü 
OrderByDescending
üü "
(
üü" #
x
üü# $
=>
üü% '
x
üü( )
.
üü) *
SentAt
üü* 0
)
üü0 1
.
†† !
FirstOrDefaultAsync
†† $
(
††$ %
)
††% &
;
††& '
if
¢¢ 
(
¢¢ 
reset
¢¢ 
==
¢¢ 
null
¢¢ 
||
¢¢  
reset
¢¢! &
.
¢¢& '

ExpiryTime
¢¢' 1
<
¢¢2 3
DateTime
¢¢4 <
.
¢¢< =
UtcNow
¢¢= C
)
¢¢C D
return
££ 
Unauthorized
££ #
(
££# $
new
££$ '
{
££( )
message
££* 1
=
££2 3
$str
££4 O
}
££P Q
)
££Q R
;
££R S
var
•• 
user
•• 
=
•• 
await
•• 
_db
••  
.
••  !
Users
••! &
.
••& '"
SingleOrDefaultAsync
••' ;
(
••; <
u
••< =
=>
••> @
u
••A B
.
••B C
Email
••C H
==
••I K
email
••L Q
)
••Q R
;
••R S
if
¶¶ 
(
¶¶ 
user
¶¶ 
==
¶¶ 
null
¶¶ 
)
¶¶ 
return
ßß 
NotFound
ßß 
(
ßß  
new
ßß  #
{
ßß$ %
message
ßß& -
=
ßß. /
$str
ßß0 A
}
ßßB C
)
ßßC D
;
ßßD E
user
©© 
.
©© 
PasswordHash
©© 
=
©© 
BCrypt
©©  &
.
©©& '
Net
©©' *
.
©©* +
BCrypt
©©+ 1
.
©©1 2
HashPassword
©©2 >
(
©©> ?
newPassword
©©? J
)
©©J K
;
©©K L
await
™™ 
_db
™™ 
.
™™ 
SaveChangesAsync
™™ &
(
™™& '
)
™™' (
;
™™( )
return
¨¨ 
Ok
¨¨ 
(
¨¨ 
new
¨¨ 
{
¨¨ 
message
¨¨ #
=
¨¨$ %
$str
¨¨& B
}
¨¨C D
)
¨¨D E
;
¨¨E F
}
≠≠ 	
[
∞∞ 	
	Authorize
∞∞	 
(
∞∞ 
Roles
∞∞ 
=
∞∞ 
$str
∞∞ "
)
∞∞" #
]
∞∞# $
[
±± 	
HttpGet
±±	 
(
±± 
$str
±± 
)
±± 
]
±± 
public
≤≤ 
async
≤≤ 
Task
≤≤ 
<
≤≤ 
IActionResult
≤≤ '
>
≤≤' (
GetStats
≤≤) 1
(
≤≤1 2
)
≤≤2 3
{
≥≥ 	
var
¥¥ 
totalCourses
¥¥ 
=
¥¥ 
await
¥¥ $
_db
¥¥% (
.
¥¥( )
Courses
¥¥) 0
.
¥¥0 1

CountAsync
¥¥1 ;
(
¥¥; <
)
¥¥< =
;
¥¥= >
var
µµ 

totalUsers
µµ 
=
µµ 
await
µµ "
_db
µµ# &
.
µµ& '
Users
µµ' ,
.
µµ, -

CountAsync
µµ- 7
(
µµ7 8
)
µµ8 9
;
µµ9 :
var
∂∂ 
activeUsers
∂∂ 
=
∂∂ 
await
∂∂ #
_db
∂∂$ '
.
∂∂' (
Users
∂∂( -
.
∂∂- .

CountAsync
∂∂. 8
(
∂∂8 9
u
∂∂9 :
=>
∂∂; =
u
∂∂> ?
.
∂∂? @
IsActive
∂∂@ H
==
∂∂I K
true
∂∂L P
)
∂∂P Q
;
∂∂Q R
var
∑∑ 
totalTrainers
∑∑ 
=
∑∑ 
await
∑∑  %
_db
∑∑& )
.
∑∑) *
Users
∑∑* /
.
∑∑/ 0

CountAsync
∑∑0 :
(
∑∑: ;
u
∑∑; <
=>
∑∑= ?
u
∑∑@ A
.
∑∑A B
Role
∑∑B F
==
∑∑G I
$str
∑∑J S
)
∑∑S T
;
∑∑T U
var
∏∏ 
totalLearners
∏∏ 
=
∏∏ 
await
∏∏  %
_db
∏∏& )
.
∏∏) *
Users
∏∏* /
.
∏∏/ 0

CountAsync
∏∏0 :
(
∏∏: ;
u
∏∏; <
=>
∏∏= ?
u
∏∏@ A
.
∏∏A B
Role
∏∏B F
==
∏∏G I
$str
∏∏J S
)
∏∏S T
;
∏∏T U
var
ªª 
takedownRequests
ªª  
=
ªª! "
await
ªª# (
_db
ªª) ,
.
ªª, -$
CourseTakedownRequests
ªª- C
.
ªªC D

CountAsync
ªªD N
(
ªªN O
)
ªªO P
;
ªªP Q
return
ΩΩ 
Ok
ΩΩ 
(
ΩΩ 
new
ΩΩ 
{
ææ 
totalCourses
øø 
,
øø 

totalUsers
¿¿ 
,
¿¿ 
activeUsers
¡¡ 
,
¡¡ 
totalTrainers
¬¬ 
,
¬¬ 
totalLearners
√√ 
,
√√ 
takedownRequests
ƒƒ  
}
≈≈ 
)
≈≈ 
;
≈≈ 
}
∆∆ 	
[
   	
	Authorize
  	 
(
   
Roles
   
=
   
$str
   "
)
  " #
]
  # $
[
ÀÀ 	
HttpGet
ÀÀ	 
(
ÀÀ 
$str
ÀÀ 
)
ÀÀ 
]
ÀÀ 
public
ÃÃ 
IActionResult
ÃÃ 
GetAdminHome
ÃÃ )
(
ÃÃ) *
)
ÃÃ* +
{
ÕÕ 	
return
ŒŒ 
Ok
ŒŒ 
(
ŒŒ 
new
ŒŒ 
{
œœ 
message
–– 
=
–– 
$str
–– :
,
––: ;
user
—— 
=
—— 
User
—— 
.
—— 
Identity
—— $
?
——$ %
.
——% &
Name
——& *
}
““ 
)
““ 
;
““ 
}
”” 	
}
◊◊ 
}ÿÿ “A
XD:\RIX_2024\Micro Project\MP_Copy_1\Mini_LMS\Mini_LMS\Controllers\AnalyticsController.cs
	namespace 	
Mini_LMS
 
. 
Controllers 
{ 
[ 
ApiController 
] 
[		 
Route		 

(		
 
$str		 
)		 
]		 
public

 

class

 
AnalyticsController

 $
:

% &
ControllerBase

' 5
{ 
private 
readonly 
MiniLMSContext '
_db( +
;+ ,
public 
AnalyticsController "
(" #
MiniLMSContext# 1
db2 4
)4 5
{ 	
_db 
= 
db 
; 
} 	
[ 	
HttpGet	 
( 
$str +
)+ ,
], -
public 
async 
Task 
< 
IActionResult '
>' (
GetTrainerAnalytics) <
(< =
long= A
	trainerIdB K
)K L
{ 	
var 
courses 
= 
await 
_db  #
.# $
Courses$ +
. 
Where 
( 
c 
=> 
c 
. 
	TrainerId '
==( *
	trainerId+ 4
)4 5
. 
Select 
( 
c 
=> 
new  
CourseAnalyticsDto! 3
{ 
Id 
= 
c 
. 
Id 
, 
Name 
= 
c 
. 
Name !
,! "
LearnerCount!!  
=!!! "
_db!!# &
.!!& '
Enrollments!!' 2
."" 
Count"" 
("" 
e""  
=>""! #
e""$ %
.""% &
CourseId""& .
==""/ 1
c""2 3
.""3 4
Id""4 6
)""6 7
,""7 8
	AvgRating$$ 
=$$ 
_db$$  #
.$$# $
	Feedbacks$$$ -
.%% 
Where%% 
(%% 
f%%  
=>%%! #
f%%$ %
.%%% &
CourseId%%& .
==%%/ 1
c%%2 3
.%%3 4
Id%%4 6
)%%6 7
.&& 
Select&& 
(&&  
f&&  !
=>&&" $
(&&% &
double&&& ,
?&&, -
)&&- .
f&&. /
.&&/ 0
Rating&&0 6
)&&6 7
.'' 
Average''  
(''  !
)''! "
??''# %
$num''& '
,''' (
AvgProgress)) 
=))  !
())" #
from))# '
mp))( *
in))+ -
_db)). 1
.))1 2
Moduleprogresses))2 B
join**# '
m**( )
in*** ,
_db**- 0
.**0 1
Modules**1 8
on**9 ;
mp**< >
.**> ?
ModuleId**? G
equals**H N
m**O P
.**P Q
Id**Q S
where++# (
m++) *
.++* +
CourseId+++ 3
==++4 6
c++7 8
.++8 9
Id++9 ;
select,,# )
(,,* +
double,,+ 1
?,,1 2
),,2 3
mp,,3 5
.,,5 6
ProgressPercentage,,6 H
),,H I
.--# $
Average--$ +
(--+ ,
)--, -
??--. 0
$num--1 2
}.. 
).. 
.// 
ToListAsync// 
(// 
)// 
;// 
var11 
response11 
=11 
new11 
TrainerAnalyticsDto11 2
{22 
TotalCourses33 
=33 
courses33 &
.33& '
Count33' ,
,33, -
TotalLearners44 
=44 
courses44  '
.44' (
Sum44( +
(44+ ,
c44, -
=>44. 0
c441 2
.442 3
LearnerCount443 ?
)44? @
,44@ A
Courses55 
=55 
courses55 !
}66 
;66 
return88 
Ok88 
(88 
response88 
)88 
;88  
}99 	
[<< 
HttpGet<< 
(<< 	
$str<<	 '
)<<' (
]<<( )
public== 
async== 
Task== 
<== 
IActionResult== 
>==  
GetTrainerLearners==! 3
(==3 4
long==4 8
	trainerId==9 B
)==B C
{>> 
var?? 
learners?? 
=?? 
await?? 
(?? 
from?? 
e??  
in??! #
_db??$ '
.??' (
Enrollments??( 3
join@@ 
u@@  
in@@! #
_db@@$ '
.@@' (
Users@@( -
on@@. 0
e@@1 2
.@@2 3
	LearnerId@@3 <
equals@@= C
u@@D E
.@@E F
Id@@F H
joinAA 
cAA  
inAA! #
_dbAA$ '
.AA' (
CoursesAA( /
onAA0 2
eAA3 4
.AA4 5
CourseIdAA5 =
equalsAA> D
cAAE F
.AAF G
IdAAG I
whereBB 
cBB  !
.BB! "
	TrainerIdBB" +
==BB, .
	trainerIdBB/ 8
&&BB9 ;
uBB< =
.BB= >
RoleBB> B
==BBC E
$strBBF O
selectCC  
newCC! $
{DD 
	LearnerIdEE '
=EE( )
uEE* +
.EE+ ,
IdEE, .
,EE. /
LearnerNameFF )
=FF* +
uFF, -
.FF- .
UsernameFF. 6
,FF6 7
LearnerEmailGG *
=GG+ ,
uGG- .
.GG. /
EmailGG/ 4
,GG4 5

CourseNameHH (
=HH) *
cHH+ ,
.HH, -
NameHH- 1
,HH1 2
ProgressII &
=II' (
(II) *
fromII* .
mpII/ 1
inII2 4
_dbII5 8
.II8 9
ModuleprogressesII9 I
joinJJ* .
mJJ/ 0
inJJ1 3
_dbJJ4 7
.JJ7 8
ModulesJJ8 ?
onJJ@ B
mpJJC E
.JJE F
ModuleIdJJF N
equalsJJO U
mJJV W
.JJW X
IdJJX Z
whereKK* /
mKK0 1
.KK1 2
CourseIdKK2 :
==KK; =
cKK> ?
.KK? @
IdKK@ B
&&KKC E
mpKKF H
.KKH I
	LearnerIdKKI R
==KKS U
uKKV W
.KKW X
IdKKX Z
selectLL* 0
(LL1 2
doubleLL2 8
?LL8 9
)LL9 :
mpLL: <
.LL< =
ProgressPercentageLL= O
)LLO P
.LLP Q
AverageLLQ X
(LLX Y
)LLY Z
??LL[ ]
$numLL^ _
}MM 
)MM 
.MM 
ToListAsyncMM (
(MM( )
)MM) *
;MM* +
varPP 
resultPP 
=PP 
learnersPP 
.QQ 	
GroupByQQ	 
(QQ 
lQQ 
=>QQ 
newQQ 
{QQ 
lQQ 
.QQ 
	LearnerIdQQ '
,QQ' (
lQQ) *
.QQ* +
LearnerNameQQ+ 6
,QQ6 7
lQQ8 9
.QQ9 :
LearnerEmailQQ: F
}QQG H
)QQH I
.RR 	
SelectRR	 
(RR 
gRR 
=>RR 
newRR 
{SS 	
gTT 
.TT 
KeyTT 
.TT 
	LearnerIdTT 
,TT 
gUU 
.UU 
KeyUU 
.UU 
LearnerNameUU 
,UU 
gVV 
.VV 
KeyVV 
.VV 
LearnerEmailVV 
,VV 
CoursesWW 
=WW 
gWW 
.WW 
SelectWW 
(WW 
xWW  
=>WW! #
newWW$ '
{WW( )
xWW* +
.WW+ ,

CourseNameWW, 6
,WW6 7
xWW8 9
.WW9 :
ProgressWW: B
}WWC D
)WWD E
.WWE F
ToListWWF L
(WWL M
)WWM N
}XX 	
)XX	 

;XX
 
returnZZ 

OkZZ 
(ZZ 
resultZZ 
)ZZ 
;ZZ 
}[[ 
}]] 
}^^ 